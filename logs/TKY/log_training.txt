2026-01-20 00:20:26 1. Parse Arguments
2026-01-20 00:20:26 Namespace(dataset='TKY', seed=2023, deviceID=0, save_dir='logs', num_epochs=30, batch_size=200, lr=0.001, decay=0.001, lr_scheduler_factor=0.1, emb_dim=128, dropout=0.4, num_mv_layers=3, num_di_layers=3, lambda_cl=0.05, temperature=0.1, focal_alpha=0.5, focal_gamma=1.5, num_neg_samples=8, adv_epsilon=1.0)
2026-01-20 00:20:26 device: cuda:0
2026-01-20 00:20:26 2. Load Dataset
2026-01-20 00:20:39 3. Construct DataLoader
2026-01-20 00:20:39 4. Load Model
2026-01-20 00:20:39 Using Negative Sampling Enhanced Loss:
2026-01-20 00:20:39   Focal Loss: alpha=0.5, gamma=1.5
2026-01-20 00:20:39 Using Adversarial Training (FGM):
2026-01-20 00:20:39   Perturbation magnitude (epsilon): 1.0
2026-01-20 00:20:39   Targeting: POI and User embeddings
2026-01-20 00:20:39 Contrastive Learning (Mixed Loss):
2026-01-20 00:20:39   Temperature: 0.1
2026-01-20 00:20:39   Weight (lambda_cl): 0.05
2026-01-20 00:20:39   Mixed Loss Weights:
2026-01-20 00:20:39 5. Start Training
2026-01-20 00:20:39 ================= Epoch 0/30 =================
2026-01-20 00:20:39 Train. Batch 0/11
2026-01-20 00:20:47 Train. Clean: 3.3413 (F: 4.3650, R: 0.9524, CL: 14.4215) | Adv: 3.4492 (F: 4.4404, R: 1.1363, CL: 20.5534)
2026-01-20 00:20:48 Train. Batch 1/11
2026-01-20 00:20:55 Train. Clean: 3.3428 (F: 4.3663, R: 0.9544, CL: 13.6954) | Adv: 3.4749 (F: 4.4655, R: 1.1636, CL: 19.4905)
2026-01-20 00:20:55 Train. Batch 2/11
2026-01-20 00:21:01 Train. Clean: 3.3373 (F: 4.3606, R: 0.9495, CL: 13.4382) | Adv: 3.4731 (F: 4.4662, R: 1.1557, CL: 18.1676)
2026-01-20 00:21:01 Train. Batch 3/11
2026-01-20 00:21:08 Train. Clean: 3.3382 (F: 4.3617, R: 0.9500, CL: 13.3401) | Adv: 3.4767 (F: 4.4686, R: 1.1624, CL: 18.1394)
2026-01-20 00:21:09 Train. Batch 4/11
2026-01-20 00:21:15 Train. Clean: 3.3475 (F: 4.3692, R: 0.9635, CL: 13.2910) | Adv: 3.4907 (F: 4.4799, R: 1.1826, CL: 18.4121)
2026-01-20 00:21:15 Train. Batch 5/11
2026-01-20 00:21:21 Train. Clean: 3.3298 (F: 4.3555, R: 0.9364, CL: 12.7772) | Adv: 3.4978 (F: 4.4843, R: 1.1960, CL: 17.4999)
2026-01-20 00:21:21 Train. Batch 6/11
2026-01-20 00:21:28 Train. Clean: 3.3258 (F: 4.3511, R: 0.9334, CL: 12.5509) | Adv: 3.4818 (F: 4.4724, R: 1.1702, CL: 17.2122)
2026-01-20 00:21:28 Train. Batch 7/11
2026-01-20 00:21:35 Train. Clean: 3.3317 (F: 4.3558, R: 0.9420, CL: 12.5517) | Adv: 3.4807 (F: 4.4709, R: 1.1702, CL: 17.4812)
2026-01-20 00:21:35 Train. Batch 8/11
2026-01-20 00:21:40 Train. Clean: 3.3357 (F: 4.3589, R: 0.9480, CL: 12.5131) | Adv: 3.4987 (F: 4.4852, R: 1.1969, CL: 16.9190)
2026-01-20 00:21:41 Train. Batch 9/11
2026-01-20 00:21:45 Train. Clean: 3.3216 (F: 4.3477, R: 0.9275, CL: 12.1933) | Adv: 3.4827 (F: 4.4723, R: 1.1735, CL: 16.8541)
2026-01-20 00:21:46 Train. Batch 10/11
2026-01-20 00:21:50 Train. Clean: 3.3205 (F: 4.3469, R: 0.9256, CL: 12.0368) | Adv: 3.5046 (F: 4.4891, R: 1.2073, CL: 16.6464)
2026-01-20 00:21:50 Training finishes at this epoch. It takes 1.1729767680168153 min
2026-01-20 00:21:50 Training loss: 4.1815
2026-01-20 00:21:50 Training Epoch 0/30 results:
2026-01-20 00:21:50 Recall@1: 0.1443
2026-01-20 00:21:50 NDCG@1: 0.1443
2026-01-20 00:21:50 Recall@5: 0.2633
2026-01-20 00:21:50 NDCG@5: 0.2080
2026-01-20 00:21:50 Recall@10: 0.3099
2026-01-20 00:21:50 NDCG@10: 0.2231
2026-01-20 00:21:50 Recall@20: 0.3388
2026-01-20 00:21:50 NDCG@20: 0.2304
2026-01-20 00:21:50 

2026-01-20 00:21:50 Testing
2026-01-20 00:21:50 Test. Batch 0/11
2026-01-20 00:21:51 Test. main_loss: 3.3152 (F: 4.3362, R: 0.9329); contrastive_loss: 10.8857; total_loss: 3.8595
2026-01-20 00:21:51 Test. Batch 1/11
2026-01-20 00:21:53 Test. main_loss: 3.3008 (F: 4.3245, R: 0.9124); contrastive_loss: 10.6201; total_loss: 3.8318
2026-01-20 00:21:53 Test. Batch 2/11
2026-01-20 00:21:54 Test. main_loss: 3.3268 (F: 4.3446, R: 0.9519); contrastive_loss: 11.0057; total_loss: 3.8770
2026-01-20 00:21:54 Test. Batch 3/11
2026-01-20 00:21:55 Test. main_loss: 3.3105 (F: 4.3327, R: 0.9254); contrastive_loss: 10.7818; total_loss: 3.8496
2026-01-20 00:21:55 Test. Batch 4/11
2026-01-20 00:21:57 Test. main_loss: 3.3230 (F: 4.3431, R: 0.9428); contrastive_loss: 11.0541; total_loss: 3.8757
2026-01-20 00:21:57 Test. Batch 5/11
2026-01-20 00:21:58 Test. main_loss: 3.3129 (F: 4.3345, R: 0.9294); contrastive_loss: 10.7496; total_loss: 3.8504
2026-01-20 00:21:58 Test. Batch 6/11
2026-01-20 00:21:59 Test. main_loss: 3.3284 (F: 4.3466, R: 0.9527); contrastive_loss: 11.1366; total_loss: 3.8853
2026-01-20 00:21:59 Test. Batch 7/11
2026-01-20 00:22:01 Test. main_loss: 3.3245 (F: 4.3438, R: 0.9461); contrastive_loss: 11.0035; total_loss: 3.8747
2026-01-20 00:22:01 Test. Batch 8/11
2026-01-20 00:22:02 Test. main_loss: 3.3144 (F: 4.3368, R: 0.9287); contrastive_loss: 10.9045; total_loss: 3.8596
2026-01-20 00:22:02 Test. Batch 9/11
2026-01-20 00:22:04 Test. main_loss: 3.3166 (F: 4.3371, R: 0.9354); contrastive_loss: 10.9193; total_loss: 3.8625
2026-01-20 00:22:04 Test. Batch 10/11
2026-01-20 00:22:05 Test. main_loss: 3.3272 (F: 4.3451, R: 0.9521); contrastive_loss: 10.8820; total_loss: 3.8713
2026-01-20 00:22:05 Testing finishes
2026-01-20 00:22:05 Testing loss: 3.863411144776778
2026-01-20 00:22:05 Testing results:
2026-01-20 00:22:05 Recall@1: 0.1351
2026-01-20 00:22:05 NDCG@1: 0.1351
2026-01-20 00:22:05 Recall@5: 0.3017
2026-01-20 00:22:05 NDCG@5: 0.2249
2026-01-20 00:22:05 Recall@10: 0.3540
2026-01-20 00:22:05 NDCG@10: 0.2420
2026-01-20 00:22:05 Recall@20: 0.3826
2026-01-20 00:22:05 NDCG@20: 0.2494
2026-01-20 00:22:05 Update test results and save model at epoch0
2026-01-20 00:22:05 ==================================


2026-01-20 00:22:05 ================= Epoch 1/30 =================
2026-01-20 00:22:05 Train. Batch 0/11
2026-01-20 00:22:10 Train. Clean: 3.2325 (F: 4.2792, R: 0.7902, CL: 10.1826) | Adv: 3.4035 (F: 4.4107, R: 1.0533, CL: 14.3882)
2026-01-20 00:22:10 Train. Batch 1/11
2026-01-20 00:22:15 Train. Clean: 3.2210 (F: 4.2700, R: 0.7733, CL: 9.8263) | Adv: 3.3962 (F: 4.4042, R: 1.0443, CL: 14.0484)
2026-01-20 00:22:15 Train. Batch 2/11
2026-01-20 00:22:20 Train. Clean: 3.2198 (F: 4.2677, R: 0.7747, CL: 9.8965) | Adv: 3.3944 (F: 4.4029, R: 1.0413, CL: 13.8343)
2026-01-20 00:22:20 Train. Batch 3/11
2026-01-20 00:22:24 Train. Clean: 3.2250 (F: 4.2716, R: 0.7830, CL: 9.7277) | Adv: 3.4010 (F: 4.4073, R: 1.0530, CL: 13.5140)
2026-01-20 00:22:25 Train. Batch 4/11
2026-01-20 00:22:29 Train. Clean: 3.2219 (F: 4.2689, R: 0.7789, CL: 9.7424) | Adv: 3.3983 (F: 4.4054, R: 1.0483, CL: 13.5831)
2026-01-20 00:22:29 Train. Batch 5/11
2026-01-20 00:22:34 Train. Clean: 3.2054 (F: 4.2568, R: 0.7523, CL: 9.3702) | Adv: 3.3854 (F: 4.3950, R: 1.0296, CL: 13.0688)
2026-01-20 00:22:34 Train. Batch 6/11
2026-01-20 00:22:39 Train. Clean: 3.1979 (F: 4.2504, R: 0.7423, CL: 9.2031) | Adv: 3.3763 (F: 4.3882, R: 1.0151, CL: 12.8960)
2026-01-20 00:22:39 Train. Batch 7/11
2026-01-20 00:22:44 Train. Clean: 3.1977 (F: 4.2497, R: 0.7430, CL: 9.2247) | Adv: 3.3719 (F: 4.3835, R: 1.0116, CL: 12.9213)
2026-01-20 00:22:44 Train. Batch 8/11
2026-01-20 00:22:49 Train. Clean: 3.2027 (F: 4.2536, R: 0.7507, CL: 9.3312) | Adv: 3.3808 (F: 4.3910, R: 1.0236, CL: 12.9127)
2026-01-20 00:22:49 Train. Batch 9/11
2026-01-20 00:22:54 Train. Clean: 3.1906 (F: 4.2438, R: 0.7329, CL: 9.0410) | Adv: 3.3638 (F: 4.3779, R: 0.9978, CL: 12.6345)
2026-01-20 00:22:54 Train. Batch 10/11
2026-01-20 00:22:59 Train. Clean: 3.1836 (F: 4.2384, R: 0.7222, CL: 8.8114) | Adv: 3.3702 (F: 4.3820, R: 1.0093, CL: 12.4763)
2026-01-20 00:22:59 Training finishes at this epoch. It takes 0.8964200139045715 min
2026-01-20 00:22:59 Training loss: 3.8669
2026-01-20 00:22:59 Training Epoch 1/30 results:
2026-01-20 00:22:59 Recall@1: 0.4040
2026-01-20 00:22:59 NDCG@1: 0.4040
2026-01-20 00:22:59 Recall@5: 0.6511
2026-01-20 00:22:59 NDCG@5: 0.5385
2026-01-20 00:22:59 Recall@10: 0.7231
2026-01-20 00:22:59 NDCG@10: 0.5621
2026-01-20 00:22:59 Recall@20: 0.7792
2026-01-20 00:22:59 NDCG@20: 0.5764
2026-01-20 00:22:59 

2026-01-20 00:22:59 Testing
2026-01-20 00:22:59 Test. Batch 0/11
2026-01-20 00:23:00 Test. main_loss: 3.3181 (F: 4.3354, R: 0.9444); contrastive_loss: 10.6047; total_loss: 3.8483
2026-01-20 00:23:00 Test. Batch 1/11
2026-01-20 00:23:01 Test. main_loss: 3.2720 (F: 4.3016, R: 0.8696); contrastive_loss: 9.9435; total_loss: 3.7692
2026-01-20 00:23:01 Test. Batch 2/11
2026-01-20 00:23:03 Test. main_loss: 3.2988 (F: 4.3218, R: 0.9118); contrastive_loss: 10.4465; total_loss: 3.8211
2026-01-20 00:23:03 Test. Batch 3/11
2026-01-20 00:23:05 Test. main_loss: 3.3135 (F: 4.3326, R: 0.9354); contrastive_loss: 10.5984; total_loss: 3.8434
2026-01-20 00:23:05 Test. Batch 4/11
2026-01-20 00:23:06 Test. main_loss: 3.3121 (F: 4.3324, R: 0.9313); contrastive_loss: 10.5440; total_loss: 3.8393
2026-01-20 00:23:06 Test. Batch 5/11
2026-01-20 00:23:07 Test. main_loss: 3.2793 (F: 4.3071, R: 0.8811); contrastive_loss: 10.1297; total_loss: 3.7858
2026-01-20 00:23:07 Test. Batch 6/11
2026-01-20 00:23:09 Test. main_loss: 3.2833 (F: 4.3108, R: 0.8856); contrastive_loss: 10.1443; total_loss: 3.7905
2026-01-20 00:23:09 Test. Batch 7/11
2026-01-20 00:23:10 Test. main_loss: 3.3093 (F: 4.3299, R: 0.9280); contrastive_loss: 10.4902; total_loss: 3.8338
2026-01-20 00:23:10 Test. Batch 8/11
2026-01-20 00:23:11 Test. main_loss: 3.3002 (F: 4.3231, R: 0.9134); contrastive_loss: 10.4060; total_loss: 3.8205
2026-01-20 00:23:11 Test. Batch 9/11
2026-01-20 00:23:13 Test. main_loss: 3.2711 (F: 4.2999, R: 0.8705); contrastive_loss: 9.9234; total_loss: 3.7673
2026-01-20 00:23:13 Test. Batch 10/11
2026-01-20 00:23:14 Test. main_loss: 3.3082 (F: 4.3286, R: 0.9275); contrastive_loss: 10.4687; total_loss: 3.8317
2026-01-20 00:23:14 Testing finishes
2026-01-20 00:23:14 Testing loss: 3.8137118166143242
2026-01-20 00:23:14 Testing results:
2026-01-20 00:23:14 Recall@1: 0.1579
2026-01-20 00:23:14 NDCG@1: 0.1579
2026-01-20 00:23:14 Recall@5: 0.3410
2026-01-20 00:23:14 NDCG@5: 0.2565
2026-01-20 00:23:14 Recall@10: 0.3996
2026-01-20 00:23:14 NDCG@10: 0.2758
2026-01-20 00:23:14 Recall@20: 0.4308
2026-01-20 00:23:14 NDCG@20: 0.2838
2026-01-20 00:23:14 Update test results and save model at epoch1
2026-01-20 00:23:14 ==================================


2026-01-20 00:23:14 ================= Epoch 2/30 =================
2026-01-20 00:23:14 Train. Batch 0/11
2026-01-20 00:23:18 Train. Clean: 3.1426 (F: 4.2058, R: 0.6616, CL: 8.1270) | Adv: 3.3132 (F: 4.3376, R: 0.9228, CL: 11.5021)
2026-01-20 00:23:19 Train. Batch 1/11
2026-01-20 00:23:23 Train. Clean: 3.1520 (F: 4.2126, R: 0.6772, CL: 8.2724) | Adv: 3.3219 (F: 4.3432, R: 0.9389, CL: 11.8036)
2026-01-20 00:23:23 Train. Batch 2/11
2026-01-20 00:23:28 Train. Clean: 3.1361 (F: 4.2015, R: 0.6503, CL: 7.9858) | Adv: 3.3082 (F: 4.3341, R: 0.9144, CL: 11.3277)
2026-01-20 00:23:28 Train. Batch 3/11
2026-01-20 00:23:33 Train. Clean: 3.1383 (F: 4.2024, R: 0.6553, CL: 7.9974) | Adv: 3.3052 (F: 4.3312, R: 0.9113, CL: 11.3091)
2026-01-20 00:23:34 Train. Batch 4/11
2026-01-20 00:23:39 Train. Clean: 3.1274 (F: 4.1947, R: 0.6370, CL: 7.8161) | Adv: 3.2911 (F: 4.3197, R: 0.8910, CL: 11.2490)
2026-01-20 00:23:39 Train. Batch 5/11
2026-01-20 00:23:44 Train. Clean: 3.1180 (F: 4.1861, R: 0.6256, CL: 7.5376) | Adv: 3.2793 (F: 4.3107, R: 0.8727, CL: 10.7972)
2026-01-20 00:23:44 Train. Batch 6/11
2026-01-20 00:23:49 Train. Clean: 3.1176 (F: 4.1858, R: 0.6251, CL: 7.4958) | Adv: 3.2813 (F: 4.3126, R: 0.8750, CL: 10.8804)
2026-01-20 00:23:49 Train. Batch 7/11
2026-01-20 00:23:54 Train. Clean: 3.1121 (F: 4.1825, R: 0.6146, CL: 7.3709) | Adv: 3.2786 (F: 4.3105, R: 0.8709, CL: 10.7108)
2026-01-20 00:23:54 Train. Batch 8/11
2026-01-20 00:23:59 Train. Clean: 3.1111 (F: 4.1807, R: 0.6153, CL: 7.3110) | Adv: 3.2747 (F: 4.3067, R: 0.8664, CL: 10.6149)
2026-01-20 00:23:59 Train. Batch 9/11
2026-01-20 00:24:03 Train. Clean: 3.1052 (F: 4.1757, R: 0.6074, CL: 7.1730) | Adv: 3.2664 (F: 4.2997, R: 0.8552, CL: 10.4073)
2026-01-20 00:24:03 Train. Batch 10/11
2026-01-20 00:24:08 Train. Clean: 3.0951 (F: 4.1687, R: 0.5902, CL: 6.9608) | Adv: 3.2635 (F: 4.2996, R: 0.8458, CL: 10.3561)
2026-01-20 00:24:08 Training finishes at this epoch. It takes 0.9010817011197408 min
2026-01-20 00:24:08 Training loss: 3.6722
2026-01-20 00:24:08 Training Epoch 2/30 results:
2026-01-20 00:24:08 Recall@1: 0.6508
2026-01-20 00:24:08 NDCG@1: 0.6508
2026-01-20 00:24:08 Recall@5: 0.8888
2026-01-20 00:24:08 NDCG@5: 0.7846
2026-01-20 00:24:08 Recall@10: 0.9373
2026-01-20 00:24:08 NDCG@10: 0.8006
2026-01-20 00:24:08 Recall@20: 0.9607
2026-01-20 00:24:08 NDCG@20: 0.8065
2026-01-20 00:24:08 

2026-01-20 00:24:08 Testing
2026-01-20 00:24:08 Test. Batch 0/11
2026-01-20 00:24:09 Test. main_loss: 3.2844 (F: 4.3100, R: 0.8911); contrastive_loss: 10.0420; total_loss: 3.7865
2026-01-20 00:24:09 Test. Batch 1/11
2026-01-20 00:24:11 Test. main_loss: 3.2701 (F: 4.2983, R: 0.8712); contrastive_loss: 9.6837; total_loss: 3.7543
2026-01-20 00:24:11 Test. Batch 2/11
2026-01-20 00:24:12 Test. main_loss: 3.2930 (F: 4.3156, R: 0.9070); contrastive_loss: 10.0713; total_loss: 3.7966
2026-01-20 00:24:12 Test. Batch 3/11
2026-01-20 00:24:13 Test. main_loss: 3.2887 (F: 4.3124, R: 0.9000); contrastive_loss: 9.9368; total_loss: 3.7855
2026-01-20 00:24:13 Test. Batch 4/11
2026-01-20 00:24:15 Test. main_loss: 3.2754 (F: 4.3026, R: 0.8786); contrastive_loss: 9.7638; total_loss: 3.7636
2026-01-20 00:24:15 Test. Batch 5/11
2026-01-20 00:24:16 Test. main_loss: 3.2863 (F: 4.3107, R: 0.8959); contrastive_loss: 9.8622; total_loss: 3.7794
2026-01-20 00:24:16 Test. Batch 6/11
2026-01-20 00:24:17 Test. main_loss: 3.2806 (F: 4.3069, R: 0.8860); contrastive_loss: 9.8082; total_loss: 3.7710
2026-01-20 00:24:17 Test. Batch 7/11
2026-01-20 00:24:19 Test. main_loss: 3.2810 (F: 4.3070, R: 0.8870); contrastive_loss: 9.9444; total_loss: 3.7782
2026-01-20 00:24:19 Test. Batch 8/11
2026-01-20 00:24:20 Test. main_loss: 3.2801 (F: 4.3059, R: 0.8864); contrastive_loss: 9.8365; total_loss: 3.7719
2026-01-20 00:24:20 Test. Batch 9/11
2026-01-20 00:24:21 Test. main_loss: 3.2776 (F: 4.3040, R: 0.8827); contrastive_loss: 9.8393; total_loss: 3.7696
2026-01-20 00:24:21 Test. Batch 10/11
2026-01-20 00:24:23 Test. main_loss: 3.2809 (F: 4.3068, R: 0.8870); contrastive_loss: 9.7529; total_loss: 3.7685
2026-01-20 00:24:23 Testing finishes
2026-01-20 00:24:23 Testing loss: 3.7750106941569936
2026-01-20 00:24:23 Testing results:
2026-01-20 00:24:23 Recall@1: 0.1911
2026-01-20 00:24:23 NDCG@1: 0.1911
2026-01-20 00:24:23 Recall@5: 0.3661
2026-01-20 00:24:23 NDCG@5: 0.2833
2026-01-20 00:24:23 Recall@10: 0.4096
2026-01-20 00:24:23 NDCG@10: 0.2975
2026-01-20 00:24:23 Recall@20: 0.4412
2026-01-20 00:24:23 NDCG@20: 0.3055
2026-01-20 00:24:23 Update test results and save model at epoch2
2026-01-20 00:24:23 ==================================


2026-01-20 00:24:23 ================= Epoch 3/30 =================
2026-01-20 00:24:23 Train. Batch 0/11
2026-01-20 00:24:27 Train. Clean: 3.0729 (F: 4.1516, R: 0.5560, CL: 6.4981) | Adv: 3.2246 (F: 4.2685, R: 0.7888, CL: 9.5856)
2026-01-20 00:24:27 Train. Batch 1/11
2026-01-20 00:24:33 Train. Clean: 3.0710 (F: 4.1492, R: 0.5553, CL: 6.5008) | Adv: 3.2240 (F: 4.2668, R: 0.7909, CL: 9.7368)
2026-01-20 00:24:33 Train. Batch 2/11
2026-01-20 00:24:37 Train. Clean: 3.0687 (F: 4.1471, R: 0.5524, CL: 6.3282) | Adv: 3.2196 (F: 4.2637, R: 0.7832, CL: 9.6340)
2026-01-20 00:24:37 Train. Batch 3/11
2026-01-20 00:24:42 Train. Clean: 3.0670 (F: 4.1454, R: 0.5507, CL: 6.3204) | Adv: 3.2120 (F: 4.2568, R: 0.7743, CL: 9.8130)
2026-01-20 00:24:42 Train. Batch 4/11
2026-01-20 00:24:47 Train. Clean: 3.0619 (F: 4.1421, R: 0.5413, CL: 6.0633) | Adv: 3.2065 (F: 4.2546, R: 0.7609, CL: 9.2514)
2026-01-20 00:24:47 Train. Batch 5/11
2026-01-20 00:24:52 Train. Clean: 3.0506 (F: 4.1332, R: 0.5243, CL: 5.8016) | Adv: 3.1954 (F: 4.2460, R: 0.7438, CL: 8.9648)
2026-01-20 00:24:52 Train. Batch 6/11
2026-01-20 00:24:57 Train. Clean: 3.0574 (F: 4.1381, R: 0.5356, CL: 5.8474) | Adv: 3.2018 (F: 4.2488, R: 0.7588, CL: 9.1984)
2026-01-20 00:24:57 Train. Batch 7/11
2026-01-20 00:25:02 Train. Clean: 3.0444 (F: 4.1278, R: 0.5164, CL: 5.5388) | Adv: 3.1868 (F: 4.2382, R: 0.7335, CL: 8.8657)
2026-01-20 00:25:02 Train. Batch 8/11
2026-01-20 00:25:07 Train. Clean: 3.0588 (F: 4.1384, R: 0.5396, CL: 5.7571) | Adv: 3.2027 (F: 4.2503, R: 0.7582, CL: 9.3043)
2026-01-20 00:25:07 Train. Batch 9/11
2026-01-20 00:25:12 Train. Clean: 3.0493 (F: 4.1322, R: 0.5224, CL: 5.5134) | Adv: 3.1943 (F: 4.2426, R: 0.7485, CL: 9.0262)
2026-01-20 00:25:12 Train. Batch 10/11
2026-01-20 00:25:16 Train. Clean: 3.0604 (F: 4.1402, R: 0.5408, CL: 5.5203) | Adv: 3.2205 (F: 4.2646, R: 0.7841, CL: 9.1876)
2026-01-20 00:25:16 Training finishes at this epoch. It takes 0.8932199716567993 min
2026-01-20 00:25:16 Training loss: 3.5165
2026-01-20 00:25:16 Training Epoch 3/30 results:
2026-01-20 00:25:16 Recall@1: 0.8044
2026-01-20 00:25:16 NDCG@1: 0.8044
2026-01-20 00:25:16 Recall@5: 0.9677
2026-01-20 00:25:16 NDCG@5: 0.8972
2026-01-20 00:25:16 Recall@10: 0.9839
2026-01-20 00:25:16 NDCG@10: 0.9026
2026-01-20 00:25:16 Recall@20: 0.9903
2026-01-20 00:25:16 NDCG@20: 0.9042
2026-01-20 00:25:16 

2026-01-20 00:25:16 Testing
2026-01-20 00:25:16 Test. Batch 0/11
2026-01-20 00:25:17 Test. main_loss: 3.2643 (F: 4.2926, R: 0.8648); contrastive_loss: 9.1819; total_loss: 3.7234
2026-01-20 00:25:18 Test. Batch 1/11
2026-01-20 00:25:19 Test. main_loss: 3.2673 (F: 4.2953, R: 0.8687); contrastive_loss: 9.3385; total_loss: 3.7342
2026-01-20 00:25:19 Test. Batch 2/11
2026-01-20 00:25:20 Test. main_loss: 3.2628 (F: 4.2916, R: 0.8623); contrastive_loss: 9.2912; total_loss: 3.7274
2026-01-20 00:25:20 Test. Batch 3/11
2026-01-20 00:25:21 Test. main_loss: 3.2779 (F: 4.3033, R: 0.8853); contrastive_loss: 9.6130; total_loss: 3.7586
2026-01-20 00:25:22 Test. Batch 4/11
2026-01-20 00:25:23 Test. main_loss: 3.2635 (F: 4.2924, R: 0.8628); contrastive_loss: 9.2404; total_loss: 3.7255
2026-01-20 00:25:23 Test. Batch 5/11
2026-01-20 00:25:24 Test. main_loss: 3.2785 (F: 4.3051, R: 0.8831); contrastive_loss: 9.5722; total_loss: 3.7571
2026-01-20 00:25:24 Test. Batch 6/11
2026-01-20 00:25:26 Test. main_loss: 3.2773 (F: 4.3033, R: 0.8835); contrastive_loss: 9.4234; total_loss: 3.7485
2026-01-20 00:25:26 Test. Batch 7/11
2026-01-20 00:25:27 Test. main_loss: 3.2613 (F: 4.2902, R: 0.8606); contrastive_loss: 9.2544; total_loss: 3.7240
2026-01-20 00:25:27 Test. Batch 8/11
2026-01-20 00:25:28 Test. main_loss: 3.2628 (F: 4.2912, R: 0.8632); contrastive_loss: 9.3186; total_loss: 3.7287
2026-01-20 00:25:28 Test. Batch 9/11
2026-01-20 00:25:30 Test. main_loss: 3.2636 (F: 4.2924, R: 0.8631); contrastive_loss: 9.2950; total_loss: 3.7283
2026-01-20 00:25:30 Test. Batch 10/11
2026-01-20 00:25:31 Test. main_loss: 3.2884 (F: 4.3102, R: 0.9040); contrastive_loss: 9.5871; total_loss: 3.7677
2026-01-20 00:25:31 Testing finishes
2026-01-20 00:25:31 Testing loss: 3.7385039112784644
2026-01-20 00:25:31 Testing results:
2026-01-20 00:25:31 Recall@1: 0.1964
2026-01-20 00:25:31 NDCG@1: 0.1964
2026-01-20 00:25:31 Recall@5: 0.3637
2026-01-20 00:25:31 NDCG@5: 0.2846
2026-01-20 00:25:31 Recall@10: 0.4095
2026-01-20 00:25:31 NDCG@10: 0.2997
2026-01-20 00:25:31 Recall@20: 0.4470
2026-01-20 00:25:31 NDCG@20: 0.3093
2026-01-20 00:25:31 ==================================


2026-01-20 00:25:31 ================= Epoch 4/30 =================
2026-01-20 00:25:31 Train. Batch 0/11
2026-01-20 00:25:36 Train. Clean: 3.0295 (F: 4.1165, R: 0.4933, CL: 4.9179) | Adv: 3.1686 (F: 4.2234, R: 0.7074, CL: 8.3806)
2026-01-20 00:25:36 Train. Batch 1/11
2026-01-20 00:25:41 Train. Clean: 3.0207 (F: 4.1090, R: 0.4811, CL: 4.4593) | Adv: 3.1548 (F: 4.2136, R: 0.6843, CL: 7.9972)
2026-01-20 00:25:41 Train. Batch 2/11
2026-01-20 00:25:46 Train. Clean: 3.0144 (F: 4.1036, R: 0.4728, CL: 4.3122) | Adv: 3.1456 (F: 4.2062, R: 0.6711, CL: 7.8620)
2026-01-20 00:25:47 Train. Batch 3/11
2026-01-20 00:25:51 Train. Clean: 3.0174 (F: 4.1064, R: 0.4762, CL: 4.3618) | Adv: 3.1498 (F: 4.2090, R: 0.6786, CL: 8.0931)
2026-01-20 00:25:51 Train. Batch 4/11
2026-01-20 00:25:56 Train. Clean: 3.0118 (F: 4.1021, R: 0.4676, CL: 4.1928) | Adv: 3.1425 (F: 4.2027, R: 0.6688, CL: 7.8035)
2026-01-20 00:25:56 Train. Batch 5/11
2026-01-20 00:26:01 Train. Clean: 3.0088 (F: 4.0989, R: 0.4652, CL: 3.9482) | Adv: 3.1382 (F: 4.2000, R: 0.6609, CL: 7.5269)
2026-01-20 00:26:01 Train. Batch 6/11
2026-01-20 00:26:06 Train. Clean: 3.0120 (F: 4.1022, R: 0.4682, CL: 3.9531) | Adv: 3.1466 (F: 4.2055, R: 0.6756, CL: 7.6765)
2026-01-20 00:26:06 Train. Batch 7/11
2026-01-20 00:26:11 Train. Clean: 3.0028 (F: 4.0942, R: 0.4560, CL: 3.6843) | Adv: 3.1308 (F: 4.1937, R: 0.6509, CL: 7.4867)
2026-01-20 00:26:11 Train. Batch 8/11
2026-01-20 00:26:16 Train. Clean: 3.0127 (F: 4.1027, R: 0.4691, CL: 3.9080) | Adv: 3.1425 (F: 4.2031, R: 0.6677, CL: 7.8242)
2026-01-20 00:26:16 Train. Batch 9/11
2026-01-20 00:26:21 Train. Clean: 3.0040 (F: 4.0951, R: 0.4579, CL: 3.6334) | Adv: 3.1339 (F: 4.1957, R: 0.6564, CL: 7.4511)
2026-01-20 00:26:21 Train. Batch 10/11
2026-01-20 00:26:25 Train. Clean: 3.0038 (F: 4.0952, R: 0.4572, CL: 3.5610) | Adv: 3.1417 (F: 4.2021, R: 0.6674, CL: 7.6302)
2026-01-20 00:26:25 Training finishes at this epoch. It takes 0.9007244269053142 min
2026-01-20 00:26:25 Training loss: 3.3757
2026-01-20 00:26:25 Training Epoch 4/30 results:
2026-01-20 00:26:25 Recall@1: 0.8852
2026-01-20 00:26:25 NDCG@1: 0.8852
2026-01-20 00:26:25 Recall@5: 0.9865
2026-01-20 00:26:25 NDCG@5: 0.9435
2026-01-20 00:26:25 Recall@10: 0.9922
2026-01-20 00:26:25 NDCG@10: 0.9453
2026-01-20 00:26:25 Recall@20: 0.9963
2026-01-20 00:26:25 NDCG@20: 0.9464
2026-01-20 00:26:25 

2026-01-20 00:26:25 Testing
2026-01-20 00:26:25 Test. Batch 0/11
2026-01-20 00:26:26 Test. main_loss: 3.2718 (F: 4.2972, R: 0.8792); contrastive_loss: 9.4107; total_loss: 3.7423
2026-01-20 00:26:26 Test. Batch 1/11
2026-01-20 00:26:28 Test. main_loss: 3.2528 (F: 4.2827, R: 0.8498); contrastive_loss: 9.0239; total_loss: 3.7040
2026-01-20 00:26:28 Test. Batch 2/11
2026-01-20 00:26:29 Test. main_loss: 3.2365 (F: 4.2699, R: 0.8253); contrastive_loss: 8.4781; total_loss: 3.6604
2026-01-20 00:26:29 Test. Batch 3/11
2026-01-20 00:26:30 Test. main_loss: 3.2859 (F: 4.3091, R: 0.8985); contrastive_loss: 9.7107; total_loss: 3.7714
2026-01-20 00:26:30 Test. Batch 4/11
2026-01-20 00:26:32 Test. main_loss: 3.2479 (F: 4.2792, R: 0.8415); contrastive_loss: 9.0374; total_loss: 3.6997
2026-01-20 00:26:32 Test. Batch 5/11
2026-01-20 00:26:33 Test. main_loss: 3.2549 (F: 4.2847, R: 0.8519); contrastive_loss: 9.0438; total_loss: 3.7071
2026-01-20 00:26:33 Test. Batch 6/11
2026-01-20 00:26:34 Test. main_loss: 3.2582 (F: 4.2856, R: 0.8611); contrastive_loss: 9.0746; total_loss: 3.7120
2026-01-20 00:26:34 Test. Batch 7/11
2026-01-20 00:26:36 Test. main_loss: 3.2746 (F: 4.2996, R: 0.8828); contrastive_loss: 9.3815; total_loss: 3.7436
2026-01-20 00:26:36 Test. Batch 8/11
2026-01-20 00:26:37 Test. main_loss: 3.2472 (F: 4.2782, R: 0.8417); contrastive_loss: 8.8925; total_loss: 3.6919
2026-01-20 00:26:37 Test. Batch 9/11
2026-01-20 00:26:38 Test. main_loss: 3.2812 (F: 4.3045, R: 0.8935); contrastive_loss: 9.4474; total_loss: 3.7536
2026-01-20 00:26:39 Test. Batch 10/11
2026-01-20 00:26:40 Test. main_loss: 3.2630 (F: 4.2917, R: 0.8626); contrastive_loss: 9.2898; total_loss: 3.7274
2026-01-20 00:26:40 Testing finishes
2026-01-20 00:26:40 Testing loss: 3.7194052176042036
2026-01-20 00:26:40 Testing results:
2026-01-20 00:26:40 Recall@1: 0.2002
2026-01-20 00:26:40 NDCG@1: 0.2002
2026-01-20 00:26:40 Recall@5: 0.3599
2026-01-20 00:26:40 NDCG@5: 0.2852
2026-01-20 00:26:40 Recall@10: 0.4071
2026-01-20 00:26:40 NDCG@10: 0.3009
2026-01-20 00:26:40 Recall@20: 0.4443
2026-01-20 00:26:40 NDCG@20: 0.3103
2026-01-20 00:26:40 ==================================


2026-01-20 00:26:40 ================= Epoch 5/30 =================
2026-01-20 00:26:40 Train. Batch 0/11
2026-01-20 00:26:45 Train. Clean: 2.9881 (F: 4.0817, R: 0.4362, CL: 3.1489) | Adv: 3.1100 (F: 4.1773, R: 0.6196, CL: 6.8944)
2026-01-20 00:26:45 Train. Batch 1/11
2026-01-20 00:26:50 Train. Clean: 2.9766 (F: 4.0736, R: 0.4168, CL: 2.7008) | Adv: 3.0987 (F: 4.1676, R: 0.6048, CL: 6.3226)
2026-01-20 00:26:50 Train. Batch 2/11
2026-01-20 00:26:54 Train. Clean: 2.9789 (F: 4.0750, R: 0.4214, CL: 2.6894) | Adv: 3.0986 (F: 4.1681, R: 0.6031, CL: 6.2642)
2026-01-20 00:26:54 Train. Batch 3/11
2026-01-20 00:26:59 Train. Clean: 2.9794 (F: 4.0762, R: 0.4202, CL: 2.7407) | Adv: 3.1013 (F: 4.1697, R: 0.6083, CL: 6.5229)
2026-01-20 00:26:59 Train. Batch 4/11
2026-01-20 00:27:05 Train. Clean: 2.9734 (F: 4.0715, R: 0.4112, CL: 2.5265) | Adv: 3.0946 (F: 4.1643, R: 0.5987, CL: 6.1465)
2026-01-20 00:27:05 Train. Batch 5/11
2026-01-20 00:27:10 Train. Clean: 2.9769 (F: 4.0739, R: 0.4173, CL: 2.6170) | Adv: 3.0981 (F: 4.1680, R: 0.6019, CL: 6.2928)
2026-01-20 00:27:10 Train. Batch 6/11
2026-01-20 00:27:15 Train. Clean: 2.9702 (F: 4.0681, R: 0.4084, CL: 2.3040) | Adv: 3.0875 (F: 4.1596, R: 0.5859, CL: 5.9654)
2026-01-20 00:27:15 Train. Batch 7/11
2026-01-20 00:27:20 Train. Clean: 2.9662 (F: 4.0663, R: 0.3992, CL: 2.2496) | Adv: 3.0850 (F: 4.1576, R: 0.5824, CL: 5.9555)
2026-01-20 00:27:20 Train. Batch 8/11
2026-01-20 00:27:25 Train. Clean: 2.9742 (F: 4.0711, R: 0.4146, CL: 2.5757) | Adv: 3.0955 (F: 4.1628, R: 0.6051, CL: 6.8681)
2026-01-20 00:27:25 Train. Batch 9/11
2026-01-20 00:27:30 Train. Clean: 2.9695 (F: 4.0675, R: 0.4076, CL: 2.1500) | Adv: 3.0841 (F: 4.1561, R: 0.5829, CL: 5.5971)
2026-01-20 00:27:30 Train. Batch 10/11
2026-01-20 00:27:34 Train. Clean: 2.9772 (F: 4.0738, R: 0.4186, CL: 2.4534) | Adv: 3.1117 (F: 4.1780, R: 0.6236, CL: 6.5948)
2026-01-20 00:27:34 Training finishes at this epoch. It takes 0.9119419813156128 min
2026-01-20 00:27:34 Training loss: 3.2579
2026-01-20 00:27:34 Training Epoch 5/30 results:
2026-01-20 00:27:34 Recall@1: 0.9333
2026-01-20 00:27:34 NDCG@1: 0.9333
2026-01-20 00:27:34 Recall@5: 0.9917
2026-01-20 00:27:34 NDCG@5: 0.9675
2026-01-20 00:27:34 Recall@10: 0.9973
2026-01-20 00:27:34 NDCG@10: 0.9693
2026-01-20 00:27:34 Recall@20: 0.9995
2026-01-20 00:27:34 NDCG@20: 0.9700
2026-01-20 00:27:34 

2026-01-20 00:27:34 Testing
2026-01-20 00:27:34 Test. Batch 0/11
2026-01-20 00:27:36 Test. main_loss: 3.2646 (F: 4.2913, R: 0.8689); contrastive_loss: 9.4025; total_loss: 3.7347
2026-01-20 00:27:36 Test. Batch 1/11
2026-01-20 00:27:37 Test. main_loss: 3.2441 (F: 4.2745, R: 0.8399); contrastive_loss: 8.9518; total_loss: 3.6917
2026-01-20 00:27:37 Test. Batch 2/11
2026-01-20 00:27:38 Test. main_loss: 3.2701 (F: 4.2967, R: 0.8748); contrastive_loss: 9.6647; total_loss: 3.7534
2026-01-20 00:27:38 Test. Batch 3/11
2026-01-20 00:27:40 Test. main_loss: 3.2699 (F: 4.2947, R: 0.8787); contrastive_loss: 9.5907; total_loss: 3.7494
2026-01-20 00:27:40 Test. Batch 4/11
2026-01-20 00:27:41 Test. main_loss: 3.2538 (F: 4.2828, R: 0.8528); contrastive_loss: 9.1079; total_loss: 3.7092
2026-01-20 00:27:41 Test. Batch 5/11
2026-01-20 00:27:42 Test. main_loss: 3.2464 (F: 4.2773, R: 0.8408); contrastive_loss: 9.0813; total_loss: 3.7004
2026-01-20 00:27:43 Test. Batch 6/11
2026-01-20 00:27:44 Test. main_loss: 3.2384 (F: 4.2710, R: 0.8290); contrastive_loss: 8.7390; total_loss: 3.6754
2026-01-20 00:27:44 Test. Batch 7/11
2026-01-20 00:27:45 Test. main_loss: 3.2748 (F: 4.2989, R: 0.8852); contrastive_loss: 9.6697; total_loss: 3.7583
2026-01-20 00:27:45 Test. Batch 8/11
2026-01-20 00:27:47 Test. main_loss: 3.2595 (F: 4.2872, R: 0.8616); contrastive_loss: 9.4503; total_loss: 3.7320
2026-01-20 00:27:47 Test. Batch 9/11
2026-01-20 00:27:48 Test. main_loss: 3.2496 (F: 4.2796, R: 0.8463); contrastive_loss: 9.1337; total_loss: 3.7063
2026-01-20 00:27:48 Test. Batch 10/11
2026-01-20 00:27:49 Test. main_loss: 3.2322 (F: 4.2662, R: 0.8197); contrastive_loss: 8.6884; total_loss: 3.6667
2026-01-20 00:27:49 Testing finishes
2026-01-20 00:27:49 Testing loss: 3.7161366506056352
2026-01-20 00:27:49 Testing results:
2026-01-20 00:27:49 Recall@1: 0.2037
2026-01-20 00:27:49 NDCG@1: 0.2037
2026-01-20 00:27:49 Recall@5: 0.3608
2026-01-20 00:27:49 NDCG@5: 0.2871
2026-01-20 00:27:49 Recall@10: 0.4043
2026-01-20 00:27:49 NDCG@10: 0.3014
2026-01-20 00:27:49 Recall@20: 0.4363
2026-01-20 00:27:49 NDCG@20: 0.3096
2026-01-20 00:27:49 ==================================


2026-01-20 00:27:49 ================= Epoch 6/30 =================
2026-01-20 00:27:49 Train. Batch 0/11
2026-01-20 00:27:54 Train. Clean: 2.9550 (F: 4.0563, R: 0.3854, CL: 1.9517) | Adv: 3.0693 (F: 4.1462, R: 0.5567, CL: 5.2447)
2026-01-20 00:27:54 Train. Batch 1/11
2026-01-20 00:27:59 Train. Clean: 2.9504 (F: 4.0524, R: 0.3792, CL: 1.8701) | Adv: 3.0600 (F: 4.1384, R: 0.5438, CL: 5.1102)
2026-01-20 00:27:59 Train. Batch 2/11
2026-01-20 00:28:03 Train. Clean: 2.9535 (F: 4.0552, R: 0.3827, CL: 1.8638) | Adv: 3.0698 (F: 4.1452, R: 0.5606, CL: 5.1986)
2026-01-20 00:28:03 Train. Batch 3/11
2026-01-20 00:28:08 Train. Clean: 2.9501 (F: 4.0527, R: 0.3772, CL: 1.7559) | Adv: 3.0673 (F: 4.1430, R: 0.5575, CL: 5.0199)
2026-01-20 00:28:08 Train. Batch 4/11
2026-01-20 00:28:14 Train. Clean: 2.9492 (F: 4.0515, R: 0.3772, CL: 1.7288) | Adv: 3.0668 (F: 4.1408, R: 0.5606, CL: 5.1578)
2026-01-20 00:28:14 Train. Batch 5/11
2026-01-20 00:28:19 Train. Clean: 2.9463 (F: 4.0488, R: 0.3739, CL: 1.7236) | Adv: 3.0601 (F: 4.1362, R: 0.5493, CL: 5.2335)
2026-01-20 00:28:19 Train. Batch 6/11
2026-01-20 00:28:24 Train. Clean: 2.9398 (F: 4.0449, R: 0.3613, CL: 1.5437) | Adv: 3.0530 (F: 4.1329, R: 0.5334, CL: 4.5034)
2026-01-20 00:28:24 Train. Batch 7/11
2026-01-20 00:28:29 Train. Clean: 2.9437 (F: 4.0474, R: 0.3683, CL: 1.7131) | Adv: 3.0561 (F: 4.1345, R: 0.5397, CL: 5.0521)
2026-01-20 00:28:29 Train. Batch 8/11
2026-01-20 00:28:34 Train. Clean: 2.9522 (F: 4.0535, R: 0.3825, CL: 1.8540) | Adv: 3.0647 (F: 4.1405, R: 0.5546, CL: 4.9886)
2026-01-20 00:28:35 Train. Batch 9/11
2026-01-20 00:28:39 Train. Clean: 2.9441 (F: 4.0472, R: 0.3704, CL: 1.5801) | Adv: 3.0555 (F: 4.1327, R: 0.5422, CL: 4.6514)
2026-01-20 00:28:40 Train. Batch 10/11
2026-01-20 00:28:44 Train. Clean: 2.9466 (F: 4.0496, R: 0.3729, CL: 1.6598) | Adv: 3.0738 (F: 4.1480, R: 0.5676, CL: 5.0030)
2026-01-20 00:28:44 Training finishes at this epoch. It takes 0.908830976486206 min
2026-01-20 00:28:44 Training loss: 3.1749
2026-01-20 00:28:44 Training Epoch 6/30 results:
2026-01-20 00:28:44 Recall@1: 0.9624
2026-01-20 00:28:44 NDCG@1: 0.9624
2026-01-20 00:28:44 Recall@5: 0.9977
2026-01-20 00:28:44 NDCG@5: 0.9828
2026-01-20 00:28:44 Recall@10: 0.9995
2026-01-20 00:28:44 NDCG@10: 0.9834
2026-01-20 00:28:44 Recall@20: 1.0000
2026-01-20 00:28:44 NDCG@20: 0.9835
2026-01-20 00:28:44 

2026-01-20 00:28:44 Testing
2026-01-20 00:28:44 Test. Batch 0/11
2026-01-20 00:28:45 Test. main_loss: 3.2448 (F: 4.2736, R: 0.8442); contrastive_loss: 9.6237; total_loss: 3.7259
2026-01-20 00:28:45 Test. Batch 1/11
2026-01-20 00:28:47 Test. main_loss: 3.2394 (F: 4.2718, R: 0.8303); contrastive_loss: 9.1859; total_loss: 3.6986
2026-01-20 00:28:47 Test. Batch 2/11
2026-01-20 00:28:48 Test. main_loss: 3.2467 (F: 4.2752, R: 0.8469); contrastive_loss: 9.4112; total_loss: 3.7173
2026-01-20 00:28:48 Test. Batch 3/11
2026-01-20 00:28:49 Test. main_loss: 3.2539 (F: 4.2831, R: 0.8526); contrastive_loss: 9.3259; total_loss: 3.7202
2026-01-20 00:28:49 Test. Batch 4/11
2026-01-20 00:28:51 Test. main_loss: 3.2700 (F: 4.2937, R: 0.8814); contrastive_loss: 9.9360; total_loss: 3.7668
2026-01-20 00:28:51 Test. Batch 5/11
2026-01-20 00:28:52 Test. main_loss: 3.2659 (F: 4.2923, R: 0.8709); contrastive_loss: 9.8902; total_loss: 3.7604
2026-01-20 00:28:52 Test. Batch 6/11
2026-01-20 00:28:53 Test. main_loss: 3.2362 (F: 4.2684, R: 0.8275); contrastive_loss: 9.1725; total_loss: 3.6948
2026-01-20 00:28:53 Test. Batch 7/11
2026-01-20 00:28:55 Test. main_loss: 3.2348 (F: 4.2680, R: 0.8239); contrastive_loss: 8.9696; total_loss: 3.6832
2026-01-20 00:28:55 Test. Batch 8/11
2026-01-20 00:28:56 Test. main_loss: 3.2576 (F: 4.2846, R: 0.8614); contrastive_loss: 9.5442; total_loss: 3.7349
2026-01-20 00:28:56 Test. Batch 9/11
2026-01-20 00:28:57 Test. main_loss: 3.2453 (F: 4.2750, R: 0.8427); contrastive_loss: 9.2742; total_loss: 3.7090
2026-01-20 00:28:58 Test. Batch 10/11
2026-01-20 00:28:59 Test. main_loss: 3.2598 (F: 4.2860, R: 0.8654); contrastive_loss: 9.6529; total_loss: 3.7425
2026-01-20 00:28:59 Testing finishes
2026-01-20 00:28:59 Testing loss: 3.7230590256777676
2026-01-20 00:28:59 Testing results:
2026-01-20 00:28:59 Recall@1: 0.1983
2026-01-20 00:28:59 NDCG@1: 0.1983
2026-01-20 00:28:59 Recall@5: 0.3503
2026-01-20 00:28:59 NDCG@5: 0.2797
2026-01-20 00:28:59 Recall@10: 0.3938
2026-01-20 00:28:59 NDCG@10: 0.2939
2026-01-20 00:28:59 Recall@20: 0.4294
2026-01-20 00:28:59 NDCG@20: 0.3030
2026-01-20 00:28:59 ==================================


2026-01-20 00:28:59 ================= Epoch 7/30 =================
2026-01-20 00:28:59 Train. Batch 0/11
2026-01-20 00:29:04 Train. Clean: 2.9311 (F: 4.0368, R: 0.3513, CL: 1.4059) | Adv: 3.0404 (F: 4.1194, R: 0.5229, CL: 4.4437)
2026-01-20 00:29:04 Train. Batch 1/11
2026-01-20 00:29:08 Train. Clean: 2.9350 (F: 4.0389, R: 0.3595, CL: 1.5083) | Adv: 3.0462 (F: 4.1254, R: 0.5280, CL: 4.4246)
2026-01-20 00:29:09 Train. Batch 2/11
2026-01-20 00:29:13 Train. Clean: 2.9291 (F: 4.0350, R: 0.3487, CL: 1.4735) | Adv: 3.0310 (F: 4.1141, R: 0.5038, CL: 4.1893)
2026-01-20 00:29:13 Train. Batch 3/11
2026-01-20 00:29:18 Train. Clean: 2.9256 (F: 4.0319, R: 0.3441, CL: 1.2834) | Adv: 3.0298 (F: 4.1137, R: 0.5009, CL: 3.7031)
2026-01-20 00:29:18 Train. Batch 4/11
2026-01-20 00:29:23 Train. Clean: 2.9286 (F: 4.0344, R: 0.3484, CL: 1.3964) | Adv: 3.0402 (F: 4.1207, R: 0.5191, CL: 4.0842)
2026-01-20 00:29:23 Train. Batch 5/11
2026-01-20 00:29:28 Train. Clean: 2.9292 (F: 4.0348, R: 0.3493, CL: 1.4004) | Adv: 3.0341 (F: 4.1167, R: 0.5079, CL: 3.9989)
2026-01-20 00:29:28 Train. Batch 6/11
2026-01-20 00:29:34 Train. Clean: 2.9285 (F: 4.0345, R: 0.3479, CL: 1.3825) | Adv: 3.0388 (F: 4.1212, R: 0.5131, CL: 3.9563)
2026-01-20 00:29:34 Train. Batch 7/11
2026-01-20 00:29:38 Train. Clean: 2.9219 (F: 4.0295, R: 0.3374, CL: 1.2608) | Adv: 3.0263 (F: 4.1098, R: 0.4980, CL: 3.8290)
2026-01-20 00:29:38 Train. Batch 8/11
2026-01-20 00:29:43 Train. Clean: 2.9250 (F: 4.0315, R: 0.3431, CL: 1.3044) | Adv: 3.0321 (F: 4.1150, R: 0.5052, CL: 3.7609)
2026-01-20 00:29:44 Train. Batch 9/11
2026-01-20 00:29:48 Train. Clean: 2.9327 (F: 4.0377, R: 0.3545, CL: 1.4737) | Adv: 3.0466 (F: 4.1264, R: 0.5269, CL: 4.1585)
2026-01-20 00:29:48 Train. Batch 10/11
2026-01-20 00:29:53 Train. Clean: 2.9264 (F: 4.0325, R: 0.3454, CL: 1.3420) | Adv: 3.0391 (F: 4.1206, R: 0.5156, CL: 4.0544)
2026-01-20 00:29:53 Training finishes at this epoch. It takes 0.9013165871302287 min
2026-01-20 00:29:53 Training loss: 3.1186
2026-01-20 00:29:53 Training Epoch 7/30 results:
2026-01-20 00:29:53 Recall@1: 0.9738
2026-01-20 00:29:53 NDCG@1: 0.9738
2026-01-20 00:29:53 Recall@5: 0.9991
2026-01-20 00:29:53 NDCG@5: 0.9888
2026-01-20 00:29:53 Recall@10: 0.9995
2026-01-20 00:29:53 NDCG@10: 0.9889
2026-01-20 00:29:53 Recall@20: 1.0000
2026-01-20 00:29:53 NDCG@20: 0.9890
2026-01-20 00:29:53 

2026-01-20 00:29:53 Testing
2026-01-20 00:29:53 Test. Batch 0/11
2026-01-20 00:29:54 Test. main_loss: 3.2583 (F: 4.2835, R: 0.8661); contrastive_loss: 10.0032; total_loss: 3.7584
2026-01-20 00:29:54 Test. Batch 1/11
2026-01-20 00:29:56 Test. main_loss: 3.2706 (F: 4.2944, R: 0.8818); contrastive_loss: 10.1077; total_loss: 3.7760
2026-01-20 00:29:56 Test. Batch 2/11
2026-01-20 00:29:57 Test. main_loss: 3.2603 (F: 4.2865, R: 0.8660); contrastive_loss: 10.0532; total_loss: 3.7630
2026-01-20 00:29:57 Test. Batch 3/11
2026-01-20 00:29:58 Test. main_loss: 3.2447 (F: 4.2742, R: 0.8426); contrastive_loss: 9.5282; total_loss: 3.7211
2026-01-20 00:29:58 Test. Batch 4/11
2026-01-20 00:30:00 Test. main_loss: 3.2429 (F: 4.2731, R: 0.8391); contrastive_loss: 9.4652; total_loss: 3.7162
2026-01-20 00:30:00 Test. Batch 5/11
2026-01-20 00:30:01 Test. main_loss: 3.2342 (F: 4.2663, R: 0.8258); contrastive_loss: 9.3346; total_loss: 3.7009
2026-01-20 00:30:01 Test. Batch 6/11
2026-01-20 00:30:02 Test. main_loss: 3.2133 (F: 4.2492, R: 0.7962); contrastive_loss: 8.7360; total_loss: 3.6501
2026-01-20 00:30:02 Test. Batch 7/11
2026-01-20 00:30:04 Test. main_loss: 3.2325 (F: 4.2658, R: 0.8215); contrastive_loss: 9.1479; total_loss: 3.6899
2026-01-20 00:30:04 Test. Batch 8/11
2026-01-20 00:30:05 Test. main_loss: 3.2445 (F: 4.2743, R: 0.8417); contrastive_loss: 9.5237; total_loss: 3.7207
2026-01-20 00:30:05 Test. Batch 9/11
2026-01-20 00:30:06 Test. main_loss: 3.2379 (F: 4.2683, R: 0.8338); contrastive_loss: 9.4010; total_loss: 3.7080
2026-01-20 00:30:07 Test. Batch 10/11
2026-01-20 00:30:08 Test. main_loss: 3.2823 (F: 4.3034, R: 0.8998); contrastive_loss: 10.4799; total_loss: 3.8063
2026-01-20 00:30:08 Testing finishes
2026-01-20 00:30:08 Testing loss: 3.7282315601002085
2026-01-20 00:30:08 Testing results:
2026-01-20 00:30:08 Recall@1: 0.1951
2026-01-20 00:30:08 NDCG@1: 0.1951
2026-01-20 00:30:08 Recall@5: 0.3428
2026-01-20 00:30:08 NDCG@5: 0.2739
2026-01-20 00:30:08 Recall@10: 0.3918
2026-01-20 00:30:08 NDCG@10: 0.2899
2026-01-20 00:30:08 Recall@20: 0.4227
2026-01-20 00:30:08 NDCG@20: 0.2977
2026-01-20 00:30:08 ==================================


2026-01-20 00:30:08 ================= Epoch 8/30 =================
2026-01-20 00:30:08 Train. Batch 0/11
2026-01-20 00:30:12 Train. Clean: 2.9148 (F: 4.0235, R: 0.3277, CL: 1.1979) | Adv: 3.0221 (F: 4.1071, R: 0.4903, CL: 3.6417)
2026-01-20 00:30:12 Train. Batch 1/11
2026-01-20 00:30:17 Train. Clean: 2.9145 (F: 4.0226, R: 0.3291, CL: 1.2969) | Adv: 3.0254 (F: 4.1093, R: 0.4963, CL: 3.7577)
2026-01-20 00:30:17 Train. Batch 2/11
2026-01-20 00:30:22 Train. Clean: 2.9175 (F: 4.0257, R: 0.3316, CL: 1.2792) | Adv: 3.0227 (F: 4.1080, R: 0.4905, CL: 3.6227)
2026-01-20 00:30:23 Train. Batch 3/11
2026-01-20 00:30:27 Train. Clean: 2.9101 (F: 4.0192, R: 0.3223, CL: 1.1023) | Adv: 3.0168 (F: 4.1015, R: 0.4857, CL: 3.6334)
2026-01-20 00:30:27 Train. Batch 4/11
2026-01-20 00:30:32 Train. Clean: 2.9109 (F: 4.0203, R: 0.3225, CL: 1.1599) | Adv: 3.0086 (F: 4.0954, R: 0.4727, CL: 3.2381)
2026-01-20 00:30:32 Train. Batch 5/11
2026-01-20 00:30:37 Train. Clean: 2.9119 (F: 4.0203, R: 0.3256, CL: 1.1589) | Adv: 3.0176 (F: 4.1029, R: 0.4851, CL: 3.3305)
2026-01-20 00:30:37 Train. Batch 6/11
2026-01-20 00:30:42 Train. Clean: 2.9124 (F: 4.0202, R: 0.3274, CL: 1.2298) | Adv: 3.0093 (F: 4.0949, R: 0.4765, CL: 3.6971)
2026-01-20 00:30:42 Train. Batch 7/11
2026-01-20 00:30:48 Train. Clean: 2.9090 (F: 4.0195, R: 0.3179, CL: 1.2113) | Adv: 3.0081 (F: 4.0957, R: 0.4702, CL: 3.3364)
2026-01-20 00:30:48 Train. Batch 8/11
2026-01-20 00:30:53 Train. Clean: 2.9080 (F: 4.0171, R: 0.3200, CL: 1.1336) | Adv: 3.0082 (F: 4.0934, R: 0.4760, CL: 3.4916)
2026-01-20 00:30:53 Train. Batch 9/11
2026-01-20 00:30:58 Train. Clean: 2.9141 (F: 4.0201, R: 0.3334, CL: 1.3373) | Adv: 3.0116 (F: 4.0963, R: 0.4807, CL: 3.7355)
2026-01-20 00:30:58 Train. Batch 10/11
2026-01-20 00:31:02 Train. Clean: 2.9127 (F: 4.0209, R: 0.3269, CL: 1.1775) | Adv: 3.0248 (F: 4.1085, R: 0.4961, CL: 3.7327)
2026-01-20 00:31:02 Training finishes at this epoch. It takes 0.9078194459279378 min
2026-01-20 00:31:02 Training loss: 3.0835
2026-01-20 00:31:02 Training Epoch 8/30 results:
2026-01-20 00:31:02 Recall@1: 0.9858
2026-01-20 00:31:02 NDCG@1: 0.9858
2026-01-20 00:31:02 Recall@5: 0.9995
2026-01-20 00:31:02 NDCG@5: 0.9941
2026-01-20 00:31:02 Recall@10: 1.0000
2026-01-20 00:31:02 NDCG@10: 0.9943
2026-01-20 00:31:02 Recall@20: 1.0000
2026-01-20 00:31:02 NDCG@20: 0.9943
2026-01-20 00:31:02 

2026-01-20 00:31:02 Testing
2026-01-20 00:31:02 Test. Batch 0/11
2026-01-20 00:31:03 Test. main_loss: 3.2575 (F: 4.2832, R: 0.8642); contrastive_loss: 10.0654; total_loss: 3.7608
2026-01-20 00:31:04 Test. Batch 1/11
2026-01-20 00:31:05 Test. main_loss: 3.2515 (F: 4.2794, R: 0.8530); contrastive_loss: 10.0003; total_loss: 3.7515
2026-01-20 00:31:05 Test. Batch 2/11
2026-01-20 00:31:06 Test. main_loss: 3.2474 (F: 4.2752, R: 0.8491); contrastive_loss: 9.8340; total_loss: 3.7391
2026-01-20 00:31:06 Test. Batch 3/11
2026-01-20 00:31:07 Test. main_loss: 3.2431 (F: 4.2720, R: 0.8425); contrastive_loss: 9.7663; total_loss: 3.7314
2026-01-20 00:31:08 Test. Batch 4/11
2026-01-20 00:31:09 Test. main_loss: 3.2335 (F: 4.2643, R: 0.8285); contrastive_loss: 9.5517; total_loss: 3.7111
2026-01-20 00:31:09 Test. Batch 5/11
2026-01-20 00:31:10 Test. main_loss: 3.2186 (F: 4.2541, R: 0.8024); contrastive_loss: 9.1822; total_loss: 3.6777
2026-01-20 00:31:10 Test. Batch 6/11
2026-01-20 00:31:12 Test. main_loss: 3.2331 (F: 4.2647, R: 0.8260); contrastive_loss: 9.5589; total_loss: 3.7110
2026-01-20 00:31:12 Test. Batch 7/11
2026-01-20 00:31:13 Test. main_loss: 3.2185 (F: 4.2536, R: 0.8033); contrastive_loss: 9.0611; total_loss: 3.6716
2026-01-20 00:31:13 Test. Batch 8/11
2026-01-20 00:31:14 Test. main_loss: 3.2488 (F: 4.2771, R: 0.8494); contrastive_loss: 9.7165; total_loss: 3.7346
2026-01-20 00:31:14 Test. Batch 9/11
2026-01-20 00:31:16 Test. main_loss: 3.2575 (F: 4.2830, R: 0.8647); contrastive_loss: 9.8637; total_loss: 3.7507
2026-01-20 00:31:16 Test. Batch 10/11
2026-01-20 00:31:17 Test. main_loss: 3.2507 (F: 4.2772, R: 0.8557); contrastive_loss: 9.7636; total_loss: 3.7389
2026-01-20 00:31:17 Testing finishes
2026-01-20 00:31:17 Testing loss: 3.725312818180431
2026-01-20 00:31:17 Testing results:
2026-01-20 00:31:17 Recall@1: 0.1961
2026-01-20 00:31:17 NDCG@1: 0.1961
2026-01-20 00:31:17 Recall@5: 0.3420
2026-01-20 00:31:17 NDCG@5: 0.2736
2026-01-20 00:31:17 Recall@10: 0.3882
2026-01-20 00:31:17 NDCG@10: 0.2888
2026-01-20 00:31:17 Recall@20: 0.4280
2026-01-20 00:31:17 NDCG@20: 0.2989
2026-01-20 00:31:17 ==================================


2026-01-20 00:31:17 ================= Epoch 9/30 =================
2026-01-20 00:31:17 Train. Batch 0/11
2026-01-20 00:31:22 Train. Clean: 2.9022 (F: 4.0136, R: 0.3087, CL: 1.1990) | Adv: 3.0058 (F: 4.0940, R: 0.4668, CL: 3.0950)
2026-01-20 00:31:22 Train. Batch 1/11
2026-01-20 00:31:27 Train. Clean: 2.9019 (F: 4.0132, R: 0.3090, CL: 1.0734) | Adv: 3.0067 (F: 4.0955, R: 0.4662, CL: 3.0241)
2026-01-20 00:31:27 Train. Batch 2/11
2026-01-20 00:31:32 Train. Clean: 2.9010 (F: 4.0124, R: 0.3077, CL: 1.1333) | Adv: 2.9990 (F: 4.0899, R: 0.4535, CL: 3.0264)
2026-01-20 00:31:32 Train. Batch 3/11
2026-01-20 00:31:37 Train. Clean: 2.8979 (F: 4.0079, R: 0.3080, CL: 1.0419) | Adv: 2.9946 (F: 4.0835, R: 0.4538, CL: 2.9185)
2026-01-20 00:31:37 Train. Batch 4/11
2026-01-20 00:31:42 Train. Clean: 2.8960 (F: 4.0087, R: 0.2997, CL: 1.0101) | Adv: 2.9970 (F: 4.0868, R: 0.4540, CL: 2.9891)
2026-01-20 00:31:42 Train. Batch 5/11
2026-01-20 00:31:47 Train. Clean: 2.9001 (F: 4.0100, R: 0.3101, CL: 1.1615) | Adv: 3.0040 (F: 4.0917, R: 0.4660, CL: 3.2352)
2026-01-20 00:31:47 Train. Batch 6/11
2026-01-20 00:31:52 Train. Clean: 2.8964 (F: 4.0077, R: 0.3033, CL: 1.0767) | Adv: 2.9951 (F: 4.0861, R: 0.4496, CL: 2.8232)
2026-01-20 00:31:53 Train. Batch 7/11
2026-01-20 00:31:57 Train. Clean: 2.9009 (F: 4.0094, R: 0.3143, CL: 1.2249) | Adv: 2.9996 (F: 4.0856, R: 0.4654, CL: 3.5932)
2026-01-20 00:31:57 Train. Batch 8/11
2026-01-20 00:32:02 Train. Clean: 2.8960 (F: 4.0072, R: 0.3030, CL: 1.0556) | Adv: 2.9981 (F: 4.0858, R: 0.4601, CL: 3.0106)
2026-01-20 00:32:03 Train. Batch 9/11
2026-01-20 00:32:07 Train. Clean: 2.8995 (F: 4.0109, R: 0.3062, CL: 1.0886) | Adv: 3.0060 (F: 4.0947, R: 0.4654, CL: 2.9447)
2026-01-20 00:32:07 Train. Batch 10/11
2026-01-20 00:32:11 Train. Clean: 2.8967 (F: 4.0076, R: 0.3046, CL: 0.9981) | Adv: 3.0056 (F: 4.0932, R: 0.4678, CL: 3.1303)
2026-01-20 00:32:11 Training finishes at this epoch. It takes 0.8989514072736104 min
2026-01-20 00:32:11 Training loss: 3.0542
2026-01-20 00:32:11 Training Epoch 9/30 results:
2026-01-20 00:32:11 Recall@1: 0.9922
2026-01-20 00:32:11 NDCG@1: 0.9922
2026-01-20 00:32:11 Recall@5: 1.0000
2026-01-20 00:32:11 NDCG@5: 0.9969
2026-01-20 00:32:11 Recall@10: 1.0000
2026-01-20 00:32:11 NDCG@10: 0.9969
2026-01-20 00:32:11 Recall@20: 1.0000
2026-01-20 00:32:11 NDCG@20: 0.9969
2026-01-20 00:32:11 

2026-01-20 00:32:11 Testing
2026-01-20 00:32:11 Test. Batch 0/11
2026-01-20 00:32:12 Test. main_loss: 3.2321 (F: 4.2635, R: 0.8254); contrastive_loss: 9.5262; total_loss: 3.7084
2026-01-20 00:32:12 Test. Batch 1/11
2026-01-20 00:32:13 Test. main_loss: 3.2453 (F: 4.2731, R: 0.8470); contrastive_loss: 9.6425; total_loss: 3.7274
2026-01-20 00:32:14 Test. Batch 2/11
2026-01-20 00:32:15 Test. main_loss: 3.2398 (F: 4.2699, R: 0.8364); contrastive_loss: 9.7327; total_loss: 3.7264
2026-01-20 00:32:15 Test. Batch 3/11
2026-01-20 00:32:16 Test. main_loss: 3.2494 (F: 4.2759, R: 0.8544); contrastive_loss: 10.1308; total_loss: 3.7560
2026-01-20 00:32:16 Test. Batch 4/11
2026-01-20 00:32:17 Test. main_loss: 3.2322 (F: 4.2622, R: 0.8290); contrastive_loss: 9.9620; total_loss: 3.7303
2026-01-20 00:32:17 Test. Batch 5/11
2026-01-20 00:32:19 Test. main_loss: 3.2277 (F: 4.2585, R: 0.8223); contrastive_loss: 9.4075; total_loss: 3.6980
2026-01-20 00:32:19 Test. Batch 6/11
2026-01-20 00:32:20 Test. main_loss: 3.2327 (F: 4.2628, R: 0.8291); contrastive_loss: 9.9187; total_loss: 3.7286
2026-01-20 00:32:20 Test. Batch 7/11
2026-01-20 00:32:21 Test. main_loss: 3.2559 (F: 4.2810, R: 0.8642); contrastive_loss: 10.0986; total_loss: 3.7609
2026-01-20 00:32:21 Test. Batch 8/11
2026-01-20 00:32:22 Test. main_loss: 3.2383 (F: 4.2680, R: 0.8355); contrastive_loss: 9.7153; total_loss: 3.7240
2026-01-20 00:32:23 Test. Batch 9/11
2026-01-20 00:32:24 Test. main_loss: 3.2387 (F: 4.2668, R: 0.8399); contrastive_loss: 9.7410; total_loss: 3.7258
2026-01-20 00:32:24 Test. Batch 10/11
2026-01-20 00:32:25 Test. main_loss: 3.2413 (F: 4.2689, R: 0.8435); contrastive_loss: 9.9220; total_loss: 3.7374
2026-01-20 00:32:25 Testing finishes
2026-01-20 00:32:25 Testing loss: 3.7293899059295654
2026-01-20 00:32:25 Testing results:
2026-01-20 00:32:25 Recall@1: 0.1975
2026-01-20 00:32:25 NDCG@1: 0.1975
2026-01-20 00:32:25 Recall@5: 0.3419
2026-01-20 00:32:25 NDCG@5: 0.2736
2026-01-20 00:32:25 Recall@10: 0.3869
2026-01-20 00:32:25 NDCG@10: 0.2881
2026-01-20 00:32:25 Recall@20: 0.4216
2026-01-20 00:32:25 NDCG@20: 0.2968
2026-01-20 00:32:25 ==================================


2026-01-20 00:32:25 ================= Epoch 10/30 =================
2026-01-20 00:32:25 Train. Batch 0/11
2026-01-20 00:32:31 Train. Clean: 2.8932 (F: 4.0038, R: 0.3018, CL: 1.1019) | Adv: 2.9904 (F: 4.0812, R: 0.4454, CL: 3.0662)
2026-01-20 00:32:31 Train. Batch 1/11
2026-01-20 00:32:36 Train. Clean: 2.8894 (F: 4.0017, R: 0.2940, CL: 0.9262) | Adv: 2.9897 (F: 4.0811, R: 0.4430, CL: 2.6257)
2026-01-20 00:32:36 Train. Batch 2/11
2026-01-20 00:32:40 Train. Clean: 2.8878 (F: 3.9990, R: 0.2948, CL: 1.0241) | Adv: 2.9815 (F: 4.0732, R: 0.4342, CL: 2.8035)
2026-01-20 00:32:41 Train. Batch 3/11
2026-01-20 00:32:45 Train. Clean: 2.8878 (F: 3.9997, R: 0.2934, CL: 0.9743) | Adv: 2.9810 (F: 4.0749, R: 0.4288, CL: 2.5411)
2026-01-20 00:32:45 Train. Batch 4/11
2026-01-20 00:32:50 Train. Clean: 2.8905 (F: 4.0012, R: 0.2988, CL: 1.0473) | Adv: 2.9854 (F: 4.0756, R: 0.4415, CL: 2.7119)
2026-01-20 00:32:50 Train. Batch 5/11
2026-01-20 00:32:55 Train. Clean: 2.8872 (F: 3.9997, R: 0.2914, CL: 0.9428) | Adv: 2.9846 (F: 4.0768, R: 0.4362, CL: 2.6104)
2026-01-20 00:32:55 Train. Batch 6/11
2026-01-20 00:33:00 Train. Clean: 2.8892 (F: 3.9999, R: 0.2975, CL: 1.0161) | Adv: 2.9856 (F: 4.0769, R: 0.4392, CL: 2.6871)
2026-01-20 00:33:00 Train. Batch 7/11
2026-01-20 00:33:04 Train. Clean: 2.8898 (F: 4.0017, R: 0.2952, CL: 1.0477) | Adv: 2.9931 (F: 4.0837, R: 0.4485, CL: 2.9755)
2026-01-20 00:33:04 Train. Batch 8/11
2026-01-20 00:33:09 Train. Clean: 2.8879 (F: 3.9998, R: 0.2933, CL: 0.9743) | Adv: 2.9847 (F: 4.0751, R: 0.4404, CL: 2.6554)
2026-01-20 00:33:09 Train. Batch 9/11
2026-01-20 00:33:14 Train. Clean: 2.8879 (F: 4.0004, R: 0.2921, CL: 1.0392) | Adv: 2.9849 (F: 4.0750, R: 0.4415, CL: 2.8111)
2026-01-20 00:33:14 Train. Batch 10/11
2026-01-20 00:33:19 Train. Clean: 2.8887 (F: 4.0011, R: 0.2932, CL: 1.0531) | Adv: 2.9911 (F: 4.0805, R: 0.4490, CL: 3.0274)
2026-01-20 00:33:19 Training finishes at this epoch. It takes 0.9024521032969157 min
2026-01-20 00:33:19 Training loss: 3.0325
2026-01-20 00:33:19 Training Epoch 10/30 results:
2026-01-20 00:33:19 Recall@1: 0.9948
2026-01-20 00:33:19 NDCG@1: 0.9948
2026-01-20 00:33:19 Recall@5: 1.0000
2026-01-20 00:33:19 NDCG@5: 0.9978
2026-01-20 00:33:19 Recall@10: 1.0000
2026-01-20 00:33:19 NDCG@10: 0.9978
2026-01-20 00:33:19 Recall@20: 1.0000
2026-01-20 00:33:19 NDCG@20: 0.9978
2026-01-20 00:33:19 

2026-01-20 00:33:19 Testing
2026-01-20 00:33:19 Test. Batch 0/11
2026-01-20 00:33:21 Test. main_loss: 3.2158 (F: 4.2481, R: 0.8070); contrastive_loss: 9.3906; total_loss: 3.6853
2026-01-20 00:33:21 Test. Batch 1/11
2026-01-20 00:33:23 Test. main_loss: 3.2422 (F: 4.2713, R: 0.8410); contrastive_loss: 9.9228; total_loss: 3.7384
2026-01-20 00:33:23 Test. Batch 2/11
2026-01-20 00:33:24 Test. main_loss: 3.2236 (F: 4.2555, R: 0.8158); contrastive_loss: 9.7183; total_loss: 3.7095
2026-01-20 00:33:25 Test. Batch 3/11
2026-01-20 00:33:26 Test. main_loss: 3.2490 (F: 4.2751, R: 0.8549); contrastive_loss: 9.9673; total_loss: 3.7474
2026-01-20 00:33:26 Test. Batch 4/11
2026-01-20 00:33:27 Test. main_loss: 3.2257 (F: 4.2580, R: 0.8172); contrastive_loss: 9.4729; total_loss: 3.6994
2026-01-20 00:33:28 Test. Batch 5/11
2026-01-20 00:33:29 Test. main_loss: 3.2048 (F: 4.2425, R: 0.7834); contrastive_loss: 9.0543; total_loss: 3.6575
2026-01-20 00:33:29 Test. Batch 6/11
2026-01-20 00:33:30 Test. main_loss: 3.2366 (F: 4.2663, R: 0.8341); contrastive_loss: 10.0028; total_loss: 3.7368
2026-01-20 00:33:30 Test. Batch 7/11
2026-01-20 00:33:31 Test. main_loss: 3.2382 (F: 4.2658, R: 0.8404); contrastive_loss: 9.9072; total_loss: 3.7336
2026-01-20 00:33:32 Test. Batch 8/11
2026-01-20 00:33:33 Test. main_loss: 3.2702 (F: 4.2917, R: 0.8867); contrastive_loss: 10.8815; total_loss: 3.8143
2026-01-20 00:33:33 Test. Batch 9/11
2026-01-20 00:33:34 Test. main_loss: 3.2401 (F: 4.2681, R: 0.8414); contrastive_loss: 9.9315; total_loss: 3.7367
2026-01-20 00:33:34 Test. Batch 10/11
2026-01-20 00:33:35 Test. main_loss: 3.2423 (F: 4.2707, R: 0.8427); contrastive_loss: 9.8545; total_loss: 3.7350
2026-01-20 00:33:35 Testing finishes
2026-01-20 00:33:35 Testing loss: 3.7267030585895884
2026-01-20 00:33:35 Testing results:
2026-01-20 00:33:35 Recall@1: 0.1922
2026-01-20 00:33:35 NDCG@1: 0.1922
2026-01-20 00:33:35 Recall@5: 0.3415
2026-01-20 00:33:35 NDCG@5: 0.2714
2026-01-20 00:33:35 Recall@10: 0.3835
2026-01-20 00:33:35 NDCG@10: 0.2851
2026-01-20 00:33:35 Recall@20: 0.4215
2026-01-20 00:33:35 NDCG@20: 0.2947
2026-01-20 00:33:35 ==================================


2026-01-20 00:33:35 ================= Epoch 11/30 =================
2026-01-20 00:33:35 Train. Batch 0/11
2026-01-20 00:33:40 Train. Clean: 2.8819 (F: 3.9955, R: 0.2836, CL: 0.9955) | Adv: 2.9773 (F: 4.0707, R: 0.4261, CL: 2.6036)
2026-01-20 00:33:40 Train. Batch 1/11
2026-01-20 00:33:45 Train. Clean: 2.8796 (F: 3.9920, R: 0.2840, CL: 0.9357) | Adv: 2.9678 (F: 4.0623, R: 0.4139, CL: 2.5851)
2026-01-20 00:33:46 Train. Batch 2/11
2026-01-20 00:33:50 Train. Clean: 2.8817 (F: 3.9938, R: 0.2867, CL: 0.9777) | Adv: 2.9732 (F: 4.0658, R: 0.4237, CL: 2.6054)
2026-01-20 00:33:50 Train. Batch 3/11
2026-01-20 00:33:55 Train. Clean: 2.8796 (F: 3.9929, R: 0.2818, CL: 0.9083) | Adv: 2.9761 (F: 4.0684, R: 0.4273, CL: 2.3689)
2026-01-20 00:33:55 Train. Batch 4/11
2026-01-20 00:34:00 Train. Clean: 2.8803 (F: 3.9930, R: 0.2841, CL: 0.9910) | Adv: 2.9728 (F: 4.0649, R: 0.4245, CL: 2.5387)
2026-01-20 00:34:00 Train. Batch 5/11
2026-01-20 00:34:04 Train. Clean: 2.8794 (F: 3.9906, R: 0.2864, CL: 0.9989) | Adv: 2.9626 (F: 4.0583, R: 0.4061, CL: 2.6347)
2026-01-20 00:34:05 Train. Batch 6/11
2026-01-20 00:34:09 Train. Clean: 2.8791 (F: 3.9919, R: 0.2826, CL: 0.9147) | Adv: 2.9630 (F: 4.0572, R: 0.4098, CL: 2.4326)
2026-01-20 00:34:10 Train. Batch 7/11
2026-01-20 00:34:15 Train. Clean: 2.8783 (F: 3.9916, R: 0.2806, CL: 0.9251) | Adv: 2.9684 (F: 4.0632, R: 0.4139, CL: 2.4102)
2026-01-20 00:34:15 Train. Batch 8/11
2026-01-20 00:34:19 Train. Clean: 2.8777 (F: 3.9903, R: 0.2817, CL: 0.9104) | Adv: 2.9712 (F: 4.0657, R: 0.4176, CL: 2.3783)
2026-01-20 00:34:20 Train. Batch 9/11
2026-01-20 00:34:24 Train. Clean: 2.8810 (F: 3.9932, R: 0.2858, CL: 1.0043) | Adv: 2.9728 (F: 4.0662, R: 0.4215, CL: 2.5620)
2026-01-20 00:34:24 Train. Batch 10/11
2026-01-20 00:34:28 Train. Clean: 2.8844 (F: 3.9944, R: 0.2942, CL: 1.0722) | Adv: 2.9856 (F: 4.0763, R: 0.4407, CL: 2.9098)
2026-01-20 00:34:28 Training finishes at this epoch. It takes 0.8832662343978882 min
2026-01-20 00:34:28 Training loss: 3.0140
2026-01-20 00:34:28 Training Epoch 11/30 results:
2026-01-20 00:34:28 Recall@1: 0.9967
2026-01-20 00:34:28 NDCG@1: 0.9967
2026-01-20 00:34:28 Recall@5: 1.0000
2026-01-20 00:34:28 NDCG@5: 0.9987
2026-01-20 00:34:28 Recall@10: 1.0000
2026-01-20 00:34:28 NDCG@10: 0.9987
2026-01-20 00:34:28 Recall@20: 1.0000
2026-01-20 00:34:28 NDCG@20: 0.9987
2026-01-20 00:34:28 

2026-01-20 00:34:28 Testing
2026-01-20 00:34:28 Test. Batch 0/11
2026-01-20 00:34:30 Test. main_loss: 3.2208 (F: 4.2528, R: 0.8128); contrastive_loss: 9.6591; total_loss: 3.7038
2026-01-20 00:34:30 Test. Batch 1/11
2026-01-20 00:34:31 Test. main_loss: 3.2263 (F: 4.2562, R: 0.8233); contrastive_loss: 9.6834; total_loss: 3.7105
2026-01-20 00:34:31 Test. Batch 2/11
2026-01-20 00:34:32 Test. main_loss: 3.2456 (F: 4.2726, R: 0.8492); contrastive_loss: 10.2263; total_loss: 3.7569
2026-01-20 00:34:32 Test. Batch 3/11
2026-01-20 00:34:33 Test. main_loss: 3.2565 (F: 4.2815, R: 0.8650); contrastive_loss: 10.4414; total_loss: 3.7786
2026-01-20 00:34:34 Test. Batch 4/11
2026-01-20 00:34:35 Test. main_loss: 3.2538 (F: 4.2784, R: 0.8631); contrastive_loss: 10.3238; total_loss: 3.7700
2026-01-20 00:34:35 Test. Batch 5/11
2026-01-20 00:34:36 Test. main_loss: 3.2277 (F: 4.2578, R: 0.8242); contrastive_loss: 9.7747; total_loss: 3.7164
2026-01-20 00:34:36 Test. Batch 6/11
2026-01-20 00:34:37 Test. main_loss: 3.2360 (F: 4.2640, R: 0.8372); contrastive_loss: 9.9428; total_loss: 3.7331
2026-01-20 00:34:38 Test. Batch 7/11
2026-01-20 00:34:39 Test. main_loss: 3.2181 (F: 4.2512, R: 0.8074); contrastive_loss: 9.3806; total_loss: 3.6871
2026-01-20 00:34:39 Test. Batch 8/11
2026-01-20 00:34:40 Test. main_loss: 3.2196 (F: 4.2515, R: 0.8118); contrastive_loss: 9.5966; total_loss: 3.6994
2026-01-20 00:34:40 Test. Batch 9/11
2026-01-20 00:34:41 Test. main_loss: 3.2203 (F: 4.2538, R: 0.8087); contrastive_loss: 9.3333; total_loss: 3.6869
2026-01-20 00:34:42 Test. Batch 10/11
2026-01-20 00:34:43 Test. main_loss: 3.2404 (F: 4.2674, R: 0.8443); contrastive_loss: 10.0942; total_loss: 3.7451
2026-01-20 00:34:43 Testing finishes
2026-01-20 00:34:43 Testing loss: 3.726167743856257
2026-01-20 00:34:43 Testing results:
2026-01-20 00:34:43 Recall@1: 0.1930
2026-01-20 00:34:43 NDCG@1: 0.1930
2026-01-20 00:34:43 Recall@5: 0.3412
2026-01-20 00:34:43 NDCG@5: 0.2717
2026-01-20 00:34:43 Recall@10: 0.3829
2026-01-20 00:34:43 NDCG@10: 0.2852
2026-01-20 00:34:43 Recall@20: 0.4164
2026-01-20 00:34:43 NDCG@20: 0.2937
2026-01-20 00:34:43 ==================================


2026-01-20 00:34:43 ================= Epoch 12/30 =================
2026-01-20 00:34:43 Train. Batch 0/11
2026-01-20 00:34:47 Train. Clean: 2.8733 (F: 3.9868, R: 0.2751, CL: 0.9458) | Adv: 2.9641 (F: 4.0582, R: 0.4114, CL: 2.4238)
2026-01-20 00:34:48 Train. Batch 1/11
2026-01-20 00:34:52 Train. Clean: 2.8738 (F: 3.9869, R: 0.2768, CL: 0.9106) | Adv: 2.9594 (F: 4.0558, R: 0.4013, CL: 2.2582)
2026-01-20 00:34:52 Train. Batch 2/11
2026-01-20 00:34:57 Train. Clean: 2.8735 (F: 3.9867, R: 0.2758, CL: 0.9361) | Adv: 2.9612 (F: 4.0568, R: 0.4047, CL: 2.2144)
2026-01-20 00:34:57 Train. Batch 3/11
2026-01-20 00:35:02 Train. Clean: 2.8706 (F: 3.9836, R: 0.2734, CL: 0.8816) | Adv: 2.9590 (F: 4.0565, R: 0.3982, CL: 2.4330)
2026-01-20 00:35:02 Train. Batch 4/11
2026-01-20 00:35:07 Train. Clean: 2.8712 (F: 3.9852, R: 0.2719, CL: 0.8954) | Adv: 2.9596 (F: 4.0529, R: 0.4086, CL: 2.4380)
2026-01-20 00:35:07 Train. Batch 5/11
2026-01-20 00:35:12 Train. Clean: 2.8731 (F: 3.9861, R: 0.2759, CL: 0.8663) | Adv: 2.9640 (F: 4.0593, R: 0.4083, CL: 2.2281)
2026-01-20 00:35:12 Train. Batch 6/11
2026-01-20 00:35:17 Train. Clean: 2.8770 (F: 3.9892, R: 0.2819, CL: 0.9223) | Adv: 2.9671 (F: 4.0625, R: 0.4114, CL: 2.3231)
2026-01-20 00:35:17 Train. Batch 7/11
2026-01-20 00:35:22 Train. Clean: 2.8719 (F: 3.9859, R: 0.2725, CL: 0.8713) | Adv: 2.9603 (F: 4.0566, R: 0.4021, CL: 2.1562)
2026-01-20 00:35:22 Train. Batch 8/11
2026-01-20 00:35:27 Train. Clean: 2.8717 (F: 3.9842, R: 0.2760, CL: 1.0045) | Adv: 2.9539 (F: 4.0485, R: 0.3998, CL: 2.8077)
2026-01-20 00:35:27 Train. Batch 9/11
2026-01-20 00:35:32 Train. Clean: 2.8750 (F: 3.9875, R: 0.2791, CL: 1.0720) | Adv: 2.9636 (F: 4.0582, R: 0.4095, CL: 2.6817)
2026-01-20 00:35:32 Train. Batch 10/11
2026-01-20 00:35:36 Train. Clean: 2.8711 (F: 3.9833, R: 0.2760, CL: 0.9119) | Adv: 2.9667 (F: 4.0562, R: 0.4245, CL: 2.7856)
2026-01-20 00:35:36 Training finishes at this epoch. It takes 0.8960616230964661 min
2026-01-20 00:35:36 Training loss: 3.0013
2026-01-20 00:35:36 Training Epoch 12/30 results:
2026-01-20 00:35:36 Recall@1: 0.9973
2026-01-20 00:35:36 NDCG@1: 0.9973
2026-01-20 00:35:36 Recall@5: 1.0000
2026-01-20 00:35:36 NDCG@5: 0.9989
2026-01-20 00:35:36 Recall@10: 1.0000
2026-01-20 00:35:36 NDCG@10: 0.9989
2026-01-20 00:35:36 Recall@20: 1.0000
2026-01-20 00:35:36 NDCG@20: 0.9989
2026-01-20 00:35:36 

2026-01-20 00:35:36 Testing
2026-01-20 00:35:36 Test. Batch 0/11
2026-01-20 00:35:38 Test. main_loss: 3.2302 (F: 4.2594, R: 0.8289); contrastive_loss: 10.1141; total_loss: 3.7359
2026-01-20 00:35:38 Test. Batch 1/11
2026-01-20 00:35:39 Test. main_loss: 3.2267 (F: 4.2553, R: 0.8266); contrastive_loss: 9.9549; total_loss: 3.7244
2026-01-20 00:35:39 Test. Batch 2/11
2026-01-20 00:35:40 Test. main_loss: 3.2138 (F: 4.2478, R: 0.8013); contrastive_loss: 9.4913; total_loss: 3.6884
2026-01-20 00:35:41 Test. Batch 3/11
2026-01-20 00:35:42 Test. main_loss: 3.2195 (F: 4.2515, R: 0.8116); contrastive_loss: 9.3984; total_loss: 3.6895
2026-01-20 00:35:42 Test. Batch 4/11
2026-01-20 00:35:43 Test. main_loss: 3.2406 (F: 4.2669, R: 0.8457); contrastive_loss: 10.1463; total_loss: 3.7479
2026-01-20 00:35:43 Test. Batch 5/11
2026-01-20 00:35:44 Test. main_loss: 3.2452 (F: 4.2721, R: 0.8491); contrastive_loss: 10.1676; total_loss: 3.7536
2026-01-20 00:35:45 Test. Batch 6/11
2026-01-20 00:35:46 Test. main_loss: 3.2496 (F: 4.2740, R: 0.8591); contrastive_loss: 10.5973; total_loss: 3.7794
2026-01-20 00:35:46 Test. Batch 7/11
2026-01-20 00:35:47 Test. main_loss: 3.2233 (F: 4.2547, R: 0.8166); contrastive_loss: 9.6093; total_loss: 3.7038
2026-01-20 00:35:47 Test. Batch 8/11
2026-01-20 00:35:49 Test. main_loss: 3.2432 (F: 4.2706, R: 0.8461); contrastive_loss: 10.0851; total_loss: 3.7475
2026-01-20 00:35:49 Test. Batch 9/11
2026-01-20 00:35:50 Test. main_loss: 3.2172 (F: 4.2504, R: 0.8064); contrastive_loss: 9.4151; total_loss: 3.6880
2026-01-20 00:35:50 Test. Batch 10/11
2026-01-20 00:35:51 Test. main_loss: 3.2278 (F: 4.2588, R: 0.8222); contrastive_loss: 9.5531; total_loss: 3.7055
2026-01-20 00:35:51 Testing finishes
2026-01-20 00:35:51 Testing loss: 3.7239796031605112
2026-01-20 00:35:51 Testing results:
2026-01-20 00:35:51 Recall@1: 0.1917
2026-01-20 00:35:51 NDCG@1: 0.1917
2026-01-20 00:35:51 Recall@5: 0.3354
2026-01-20 00:35:51 NDCG@5: 0.2689
2026-01-20 00:35:51 Recall@10: 0.3749
2026-01-20 00:35:51 NDCG@10: 0.2817
2026-01-20 00:35:51 Recall@20: 0.4150
2026-01-20 00:35:51 NDCG@20: 0.2918
2026-01-20 00:35:51 ==================================


2026-01-20 00:35:51 ================= Epoch 13/30 =================
2026-01-20 00:35:51 Train. Batch 0/11
2026-01-20 00:35:56 Train. Clean: 2.8663 (F: 3.9800, R: 0.2676, CL: 0.7658) | Adv: 2.9531 (F: 4.0484, R: 0.3976, CL: 2.1224)
2026-01-20 00:35:56 Train. Batch 1/11
2026-01-20 00:36:01 Train. Clean: 2.8663 (F: 3.9788, R: 0.2705, CL: 0.8756) | Adv: 2.9517 (F: 4.0475, R: 0.3949, CL: 2.4168)
2026-01-20 00:36:01 Train. Batch 2/11
2026-01-20 00:36:06 Train. Clean: 2.8662 (F: 3.9807, R: 0.2656, CL: 0.8851) | Adv: 2.9582 (F: 4.0559, R: 0.3970, CL: 2.2076)
2026-01-20 00:36:06 Train. Batch 3/11
2026-01-20 00:36:11 Train. Clean: 2.8656 (F: 3.9789, R: 0.2678, CL: 0.9301) | Adv: 2.9533 (F: 4.0508, R: 0.3924, CL: 2.3831)
2026-01-20 00:36:11 Train. Batch 4/11
2026-01-20 00:36:16 Train. Clean: 2.8655 (F: 3.9797, R: 0.2655, CL: 0.8089) | Adv: 2.9519 (F: 4.0505, R: 0.3883, CL: 2.1310)
2026-01-20 00:36:16 Train. Batch 5/11
2026-01-20 00:36:22 Train. Clean: 2.8692 (F: 3.9816, R: 0.2738, CL: 0.9715) | Adv: 2.9559 (F: 4.0518, R: 0.3987, CL: 2.2403)
2026-01-20 00:36:22 Train. Batch 6/11
2026-01-20 00:36:27 Train. Clean: 2.8657 (F: 3.9786, R: 0.2691, CL: 0.8201) | Adv: 2.9504 (F: 4.0478, R: 0.3896, CL: 2.1825)
2026-01-20 00:36:27 Train. Batch 7/11
2026-01-20 00:36:31 Train. Clean: 2.8654 (F: 3.9786, R: 0.2680, CL: 0.7836) | Adv: 2.9542 (F: 4.0510, R: 0.3951, CL: 2.0541)
2026-01-20 00:36:32 Train. Batch 8/11
2026-01-20 00:36:36 Train. Clean: 2.8697 (F: 3.9821, R: 0.2742, CL: 0.9209) | Adv: 2.9610 (F: 4.0566, R: 0.4045, CL: 2.2491)
2026-01-20 00:36:36 Train. Batch 9/11
2026-01-20 00:36:41 Train. Clean: 2.8672 (F: 3.9803, R: 0.2698, CL: 0.9689) | Adv: 2.9545 (F: 4.0502, R: 0.3976, CL: 2.4109)
2026-01-20 00:36:41 Train. Batch 10/11
2026-01-20 00:36:45 Train. Clean: 2.8726 (F: 3.9832, R: 0.2812, CL: 1.0306) | Adv: 2.9658 (F: 4.0578, R: 0.4178, CL: 2.8225)
2026-01-20 00:36:46 Training finishes at this epoch. It takes 0.9056017796198527 min
2026-01-20 00:36:46 Training loss: 2.9908
2026-01-20 00:36:46 Training Epoch 13/30 results:
2026-01-20 00:36:46 Recall@1: 0.9971
2026-01-20 00:36:46 NDCG@1: 0.9971
2026-01-20 00:36:46 Recall@5: 1.0000
2026-01-20 00:36:46 NDCG@5: 0.9989
2026-01-20 00:36:46 Recall@10: 1.0000
2026-01-20 00:36:46 NDCG@10: 0.9989
2026-01-20 00:36:46 Recall@20: 1.0000
2026-01-20 00:36:46 NDCG@20: 0.9989
2026-01-20 00:36:46 

2026-01-20 00:36:46 Testing
2026-01-20 00:36:46 Test. Batch 0/11
2026-01-20 00:36:47 Test. main_loss: 3.2583 (F: 4.2796, R: 0.8754); contrastive_loss: 10.7961; total_loss: 3.7981
2026-01-20 00:36:47 Test. Batch 1/11
2026-01-20 00:36:48 Test. main_loss: 3.2305 (F: 4.2594, R: 0.8298); contrastive_loss: 9.9619; total_loss: 3.7286
2026-01-20 00:36:48 Test. Batch 2/11
2026-01-20 00:36:49 Test. main_loss: 3.2314 (F: 4.2603, R: 0.8306); contrastive_loss: 9.9805; total_loss: 3.7304
2026-01-20 00:36:50 Test. Batch 3/11
2026-01-20 00:36:51 Test. main_loss: 3.2217 (F: 4.2534, R: 0.8142); contrastive_loss: 9.5214; total_loss: 3.6977
2026-01-20 00:36:51 Test. Batch 4/11
2026-01-20 00:36:52 Test. main_loss: 3.2321 (F: 4.2608, R: 0.8318); contrastive_loss: 9.9404; total_loss: 3.7291
2026-01-20 00:36:52 Test. Batch 5/11
2026-01-20 00:36:54 Test. main_loss: 3.2315 (F: 4.2610, R: 0.8293); contrastive_loss: 10.0781; total_loss: 3.7354
2026-01-20 00:36:54 Test. Batch 6/11
2026-01-20 00:36:55 Test. main_loss: 3.2343 (F: 4.2614, R: 0.8379); contrastive_loss: 10.0711; total_loss: 3.7379
2026-01-20 00:36:55 Test. Batch 7/11
2026-01-20 00:36:56 Test. main_loss: 3.2197 (F: 4.2527, R: 0.8093); contrastive_loss: 9.5169; total_loss: 3.6956
2026-01-20 00:36:56 Test. Batch 8/11
2026-01-20 00:36:58 Test. main_loss: 3.2091 (F: 4.2438, R: 0.7948); contrastive_loss: 9.2496; total_loss: 3.6716
2026-01-20 00:36:58 Test. Batch 9/11
2026-01-20 00:36:59 Test. main_loss: 3.2186 (F: 4.2505, R: 0.8109); contrastive_loss: 9.7971; total_loss: 3.7085
2026-01-20 00:36:59 Test. Batch 10/11
2026-01-20 00:37:00 Test. main_loss: 3.2141 (F: 4.2466, R: 0.8052); contrastive_loss: 9.6380; total_loss: 3.6960
2026-01-20 00:37:00 Testing finishes
2026-01-20 00:37:00 Testing loss: 3.7208185412667016
2026-01-20 00:37:00 Testing results:
2026-01-20 00:37:00 Recall@1: 0.1906
2026-01-20 00:37:00 NDCG@1: 0.1906
2026-01-20 00:37:00 Recall@5: 0.3336
2026-01-20 00:37:00 NDCG@5: 0.2680
2026-01-20 00:37:00 Recall@10: 0.3776
2026-01-20 00:37:00 NDCG@10: 0.2823
2026-01-20 00:37:00 Recall@20: 0.4146
2026-01-20 00:37:00 NDCG@20: 0.2917
2026-01-20 00:37:00 ==================================


2026-01-20 00:37:00 ================= Epoch 14/30 =================
2026-01-20 00:37:00 Train. Batch 0/11
2026-01-20 00:37:05 Train. Clean: 2.8614 (F: 3.9751, R: 0.2628, CL: 0.8012) | Adv: 2.9467 (F: 4.0445, R: 0.3851, CL: 1.9442)
2026-01-20 00:37:06 Train. Batch 1/11
2026-01-20 00:37:10 Train. Clean: 2.8621 (F: 3.9760, R: 0.2630, CL: 0.8721) | Adv: 2.9464 (F: 4.0416, R: 0.3911, CL: 2.3098)
2026-01-20 00:37:10 Train. Batch 2/11
2026-01-20 00:37:15 Train. Clean: 2.8591 (F: 3.9730, R: 0.2601, CL: 0.7914) | Adv: 2.9423 (F: 4.0408, R: 0.3791, CL: 2.0225)
2026-01-20 00:37:15 Train. Batch 3/11
2026-01-20 00:37:20 Train. Clean: 2.8623 (F: 3.9759, R: 0.2639, CL: 0.7960) | Adv: 2.9561 (F: 4.0527, R: 0.3974, CL: 2.2723)
2026-01-20 00:37:20 Train. Batch 4/11
2026-01-20 00:37:25 Train. Clean: 2.8598 (F: 3.9736, R: 0.2609, CL: 0.8774) | Adv: 2.9410 (F: 4.0388, R: 0.3795, CL: 2.2284)
2026-01-20 00:37:25 Train. Batch 5/11
2026-01-20 00:37:30 Train. Clean: 2.8579 (F: 3.9720, R: 0.2584, CL: 0.9552) | Adv: 2.9386 (F: 4.0341, R: 0.3825, CL: 2.6627)
2026-01-20 00:37:30 Train. Batch 6/11
2026-01-20 00:37:35 Train. Clean: 2.8623 (F: 3.9747, R: 0.2666, CL: 0.8551) | Adv: 2.9447 (F: 4.0416, R: 0.3854, CL: 2.1903)
2026-01-20 00:37:35 Train. Batch 7/11
2026-01-20 00:37:41 Train. Clean: 2.8598 (F: 3.9736, R: 0.2609, CL: 0.9564) | Adv: 2.9460 (F: 4.0418, R: 0.3892, CL: 2.4687)
2026-01-20 00:37:41 Train. Batch 8/11
2026-01-20 00:37:46 Train. Clean: 2.8606 (F: 3.9758, R: 0.2583, CL: 0.8685) | Adv: 2.9493 (F: 4.0468, R: 0.3886, CL: 2.0694)
2026-01-20 00:37:46 Train. Batch 9/11
2026-01-20 00:37:50 Train. Clean: 2.8631 (F: 3.9765, R: 0.2653, CL: 0.9320) | Adv: 2.9526 (F: 4.0501, R: 0.3915, CL: 2.3650)
2026-01-20 00:37:51 Train. Batch 10/11
2026-01-20 00:37:55 Train. Clean: 2.8638 (F: 3.9765, R: 0.2673, CL: 0.8551) | Adv: 2.9629 (F: 4.0574, R: 0.4090, CL: 2.4895)
2026-01-20 00:37:55 Training finishes at this epoch. It takes 0.9118247429529825 min
2026-01-20 00:37:55 Training loss: 2.9831
2026-01-20 00:37:55 Training Epoch 14/30 results:
2026-01-20 00:37:55 Recall@1: 0.9991
2026-01-20 00:37:55 NDCG@1: 0.9991
2026-01-20 00:37:55 Recall@5: 1.0000
2026-01-20 00:37:55 NDCG@5: 0.9996
2026-01-20 00:37:55 Recall@10: 1.0000
2026-01-20 00:37:55 NDCG@10: 0.9996
2026-01-20 00:37:55 Recall@20: 1.0000
2026-01-20 00:37:55 NDCG@20: 0.9996
2026-01-20 00:37:55 

2026-01-20 00:37:55 Testing
2026-01-20 00:37:55 Test. Batch 0/11
2026-01-20 00:37:56 Test. main_loss: 3.2301 (F: 4.2601, R: 0.8268); contrastive_loss: 9.9064; total_loss: 3.7254
2026-01-20 00:37:56 Test. Batch 1/11
2026-01-20 00:37:58 Test. main_loss: 3.2469 (F: 4.2723, R: 0.8543); contrastive_loss: 10.4162; total_loss: 3.7677
2026-01-20 00:37:58 Test. Batch 2/11
2026-01-20 00:37:59 Test. main_loss: 3.2208 (F: 4.2517, R: 0.8154); contrastive_loss: 9.7786; total_loss: 3.7098
2026-01-20 00:37:59 Test. Batch 3/11
2026-01-20 00:38:00 Test. main_loss: 3.2091 (F: 4.2433, R: 0.7958); contrastive_loss: 9.6832; total_loss: 3.6932
2026-01-20 00:38:01 Test. Batch 4/11
2026-01-20 00:38:02 Test. main_loss: 3.2136 (F: 4.2455, R: 0.8061); contrastive_loss: 9.5179; total_loss: 3.6895
2026-01-20 00:38:02 Test. Batch 5/11
2026-01-20 00:38:03 Test. main_loss: 3.2089 (F: 4.2422, R: 0.7978); contrastive_loss: 9.4196; total_loss: 3.6799
2026-01-20 00:38:03 Test. Batch 6/11
2026-01-20 00:38:04 Test. main_loss: 3.2412 (F: 4.2657, R: 0.8506); contrastive_loss: 10.0877; total_loss: 3.7455
2026-01-20 00:38:05 Test. Batch 7/11
2026-01-20 00:38:06 Test. main_loss: 3.2225 (F: 4.2513, R: 0.8219); contrastive_loss: 9.8798; total_loss: 3.7165
2026-01-20 00:38:06 Test. Batch 8/11
2026-01-20 00:38:07 Test. main_loss: 3.2201 (F: 4.2524, R: 0.8113); contrastive_loss: 9.7515; total_loss: 3.7076
2026-01-20 00:38:07 Test. Batch 9/11
2026-01-20 00:38:09 Test. main_loss: 3.2454 (F: 4.2711, R: 0.8520); contrastive_loss: 10.5202; total_loss: 3.7714
2026-01-20 00:38:09 Test. Batch 10/11
2026-01-20 00:38:10 Test. main_loss: 3.2362 (F: 4.2641, R: 0.8377); contrastive_loss: 10.2275; total_loss: 3.7476
2026-01-20 00:38:10 Testing finishes
2026-01-20 00:38:10 Testing loss: 3.723100120371038
2026-01-20 00:38:10 Testing results:
2026-01-20 00:38:10 Recall@1: 0.1898
2026-01-20 00:38:10 NDCG@1: 0.1898
2026-01-20 00:38:10 Recall@5: 0.3316
2026-01-20 00:38:10 NDCG@5: 0.2660
2026-01-20 00:38:10 Recall@10: 0.3706
2026-01-20 00:38:10 NDCG@10: 0.2786
2026-01-20 00:38:10 Recall@20: 0.4085
2026-01-20 00:38:10 NDCG@20: 0.2882
2026-01-20 00:38:10 ==================================


2026-01-20 00:38:10 ================= Epoch 15/30 =================
2026-01-20 00:38:10 Train. Batch 0/11
2026-01-20 00:38:15 Train. Clean: 2.8577 (F: 3.9710, R: 0.2598, CL: 0.8995) | Adv: 2.9457 (F: 4.0451, R: 0.3804, CL: 2.1743)
2026-01-20 00:38:15 Train. Batch 1/11
2026-01-20 00:38:20 Train. Clean: 2.8562 (F: 3.9702, R: 0.2568, CL: 0.7857) | Adv: 2.9474 (F: 4.0461, R: 0.3840, CL: 2.0733)
2026-01-20 00:38:20 Train. Batch 2/11
2026-01-20 00:38:25 Train. Clean: 2.8571 (F: 3.9703, R: 0.2597, CL: 0.9786) | Adv: 2.9386 (F: 4.0376, R: 0.3743, CL: 2.3372)
2026-01-20 00:38:25 Train. Batch 3/11
2026-01-20 00:38:30 Train. Clean: 2.8564 (F: 3.9690, R: 0.2601, CL: 0.7862) | Adv: 2.9328 (F: 4.0308, R: 0.3708, CL: 2.0717)
2026-01-20 00:38:30 Train. Batch 4/11
2026-01-20 00:38:35 Train. Clean: 2.8553 (F: 3.9704, R: 0.2535, CL: 0.7658) | Adv: 2.9367 (F: 4.0352, R: 0.3733, CL: 2.0757)
2026-01-20 00:38:35 Train. Batch 5/11
2026-01-20 00:38:39 Train. Clean: 2.8588 (F: 3.9720, R: 0.2615, CL: 0.8477) | Adv: 2.9491 (F: 4.0468, R: 0.3877, CL: 2.1929)
2026-01-20 00:38:40 Train. Batch 6/11
2026-01-20 00:38:45 Train. Clean: 2.8552 (F: 3.9695, R: 0.2552, CL: 0.7903) | Adv: 2.9383 (F: 4.0373, R: 0.3739, CL: 2.1708)
2026-01-20 00:38:45 Train. Batch 7/11
2026-01-20 00:38:50 Train. Clean: 2.8560 (F: 3.9703, R: 0.2560, CL: 0.8044) | Adv: 2.9455 (F: 4.0443, R: 0.3815, CL: 1.9620)
2026-01-20 00:38:50 Train. Batch 8/11
2026-01-20 00:38:55 Train. Clean: 2.8564 (F: 3.9683, R: 0.2619, CL: 0.9697) | Adv: 2.9387 (F: 4.0345, R: 0.3819, CL: 2.4341)
2026-01-20 00:38:55 Train. Batch 9/11
2026-01-20 00:39:00 Train. Clean: 2.8592 (F: 3.9718, R: 0.2630, CL: 0.9977) | Adv: 2.9428 (F: 4.0384, R: 0.3864, CL: 2.4901)
2026-01-20 00:39:00 Train. Batch 10/11
2026-01-20 00:39:04 Train. Clean: 2.8545 (F: 3.9689, R: 0.2543, CL: 0.7469) | Adv: 2.9446 (F: 4.0417, R: 0.3846, CL: 2.1095)
2026-01-20 00:39:04 Training finishes at this epoch. It takes 0.9069709181785583 min
2026-01-20 00:39:04 Training loss: 2.9753
2026-01-20 00:39:04 Training Epoch 15/30 results:
2026-01-20 00:39:04 Recall@1: 0.9986
2026-01-20 00:39:04 NDCG@1: 0.9986
2026-01-20 00:39:04 Recall@5: 1.0000
2026-01-20 00:39:04 NDCG@5: 0.9995
2026-01-20 00:39:04 Recall@10: 1.0000
2026-01-20 00:39:04 NDCG@10: 0.9995
2026-01-20 00:39:04 Recall@20: 1.0000
2026-01-20 00:39:04 NDCG@20: 0.9995
2026-01-20 00:39:04 

2026-01-20 00:39:04 Testing
2026-01-20 00:39:04 Test. Batch 0/11
2026-01-20 00:39:06 Test. main_loss: 3.1922 (F: 4.2278, R: 0.7756); contrastive_loss: 9.3657; total_loss: 3.6604
2026-01-20 00:39:06 Test. Batch 1/11
2026-01-20 00:39:07 Test. main_loss: 3.2233 (F: 4.2533, R: 0.8200); contrastive_loss: 9.9492; total_loss: 3.7207
2026-01-20 00:39:07 Test. Batch 2/11
2026-01-20 00:39:08 Test. main_loss: 3.2270 (F: 4.2563, R: 0.8253); contrastive_loss: 9.8888; total_loss: 3.7215
2026-01-20 00:39:08 Test. Batch 3/11
2026-01-20 00:39:10 Test. main_loss: 3.2319 (F: 4.2586, R: 0.8362); contrastive_loss: 10.6007; total_loss: 3.7620
2026-01-20 00:39:10 Test. Batch 4/11
2026-01-20 00:39:11 Test. main_loss: 3.2133 (F: 4.2454, R: 0.8049); contrastive_loss: 9.6027; total_loss: 3.6934
2026-01-20 00:39:11 Test. Batch 5/11
2026-01-20 00:39:12 Test. main_loss: 3.2077 (F: 4.2407, R: 0.7975); contrastive_loss: 9.5574; total_loss: 3.6856
2026-01-20 00:39:12 Test. Batch 6/11
2026-01-20 00:39:14 Test. main_loss: 3.2389 (F: 4.2651, R: 0.8444); contrastive_loss: 10.0428; total_loss: 3.7410
2026-01-20 00:39:14 Test. Batch 7/11
2026-01-20 00:39:15 Test. main_loss: 3.2478 (F: 4.2711, R: 0.8602); contrastive_loss: 10.2163; total_loss: 3.7586
2026-01-20 00:39:15 Test. Batch 8/11
2026-01-20 00:39:16 Test. main_loss: 3.2255 (F: 4.2544, R: 0.8248); contrastive_loss: 9.9129; total_loss: 3.7212
2026-01-20 00:39:17 Test. Batch 9/11
2026-01-20 00:39:18 Test. main_loss: 3.2331 (F: 4.2610, R: 0.8346); contrastive_loss: 9.8340; total_loss: 3.7248
2026-01-20 00:39:18 Test. Batch 10/11
2026-01-20 00:39:19 Test. main_loss: 3.2359 (F: 4.2625, R: 0.8405); contrastive_loss: 10.1766; total_loss: 3.7447
2026-01-20 00:39:19 Testing finishes
2026-01-20 00:39:19 Testing loss: 3.7212622382424096
2026-01-20 00:39:19 Testing results:
2026-01-20 00:39:19 Recall@1: 0.1887
2026-01-20 00:39:19 NDCG@1: 0.1887
2026-01-20 00:39:19 Recall@5: 0.3329
2026-01-20 00:39:19 NDCG@5: 0.2658
2026-01-20 00:39:19 Recall@10: 0.3729
2026-01-20 00:39:19 NDCG@10: 0.2789
2026-01-20 00:39:19 Recall@20: 0.4087
2026-01-20 00:39:19 NDCG@20: 0.2878
2026-01-20 00:39:19 ==================================


2026-01-20 00:39:19 ================= Epoch 16/30 =================
2026-01-20 00:39:19 Train. Batch 0/11
2026-01-20 00:39:24 Train. Clean: 2.8523 (F: 3.9652, R: 0.2555, CL: 0.8616) | Adv: 2.9304 (F: 4.0274, R: 0.3706, CL: 2.2542)
2026-01-20 00:39:24 Train. Batch 1/11
2026-01-20 00:39:29 Train. Clean: 2.8509 (F: 3.9658, R: 0.2494, CL: 0.8054) | Adv: 2.9292 (F: 4.0294, R: 0.3621, CL: 1.9879)
2026-01-20 00:39:30 Train. Batch 2/11
2026-01-20 00:39:34 Train. Clean: 2.8503 (F: 3.9645, R: 0.2505, CL: 0.8090) | Adv: 2.9318 (F: 4.0304, R: 0.3683, CL: 2.0466)
2026-01-20 00:39:35 Train. Batch 3/11
2026-01-20 00:39:39 Train. Clean: 2.8530 (F: 3.9684, R: 0.2504, CL: 0.7982) | Adv: 2.9477 (F: 4.0480, R: 0.3805, CL: 1.9898)
2026-01-20 00:39:39 Train. Batch 4/11
2026-01-20 00:39:45 Train. Clean: 2.8522 (F: 3.9661, R: 0.2531, CL: 0.9244) | Adv: 2.9436 (F: 4.0411, R: 0.3826, CL: 2.4867)
2026-01-20 00:39:45 Train. Batch 5/11
2026-01-20 00:39:50 Train. Clean: 2.8540 (F: 3.9670, R: 0.2571, CL: 0.9121) | Adv: 2.9330 (F: 4.0314, R: 0.3699, CL: 2.2169)
2026-01-20 00:39:50 Train. Batch 6/11
2026-01-20 00:39:55 Train. Clean: 2.8513 (F: 3.9644, R: 0.2541, CL: 0.7674) | Adv: 2.9269 (F: 4.0259, R: 0.3624, CL: 2.0082)
2026-01-20 00:39:55 Train. Batch 7/11
2026-01-20 00:40:00 Train. Clean: 2.8532 (F: 3.9658, R: 0.2570, CL: 0.9169) | Adv: 2.9352 (F: 4.0310, R: 0.3786, CL: 2.5514)
2026-01-20 00:40:00 Train. Batch 8/11
2026-01-20 00:40:05 Train. Clean: 2.8532 (F: 3.9677, R: 0.2526, CL: 0.7718) | Adv: 2.9365 (F: 4.0360, R: 0.3709, CL: 1.9306)
2026-01-20 00:40:05 Train. Batch 9/11
2026-01-20 00:40:09 Train. Clean: 2.8557 (F: 3.9685, R: 0.2593, CL: 0.9149) | Adv: 2.9447 (F: 4.0427, R: 0.3826, CL: 2.4382)
2026-01-20 00:40:09 Train. Batch 10/11
2026-01-20 00:40:14 Train. Clean: 2.8504 (F: 3.9635, R: 0.2532, CL: 0.7508) | Adv: 2.9426 (F: 4.0384, R: 0.3859, CL: 2.3340)
2026-01-20 00:40:14 Training finishes at this epoch. It takes 0.9162992556889852 min
2026-01-20 00:40:14 Training loss: 2.9705
2026-01-20 00:40:14 Training Epoch 16/30 results:
2026-01-20 00:40:14 Recall@1: 0.9982
2026-01-20 00:40:14 NDCG@1: 0.9982
2026-01-20 00:40:14 Recall@5: 1.0000
2026-01-20 00:40:14 NDCG@5: 0.9993
2026-01-20 00:40:14 Recall@10: 1.0000
2026-01-20 00:40:14 NDCG@10: 0.9993
2026-01-20 00:40:14 Recall@20: 1.0000
2026-01-20 00:40:14 NDCG@20: 0.9993
2026-01-20 00:40:14 

2026-01-20 00:40:14 Testing
2026-01-20 00:40:14 Test. Batch 0/11
2026-01-20 00:40:15 Test. main_loss: 3.2421 (F: 4.2678, R: 0.8487); contrastive_loss: 10.5390; total_loss: 3.7690
2026-01-20 00:40:16 Test. Batch 1/11
2026-01-20 00:40:17 Test. main_loss: 3.2325 (F: 4.2603, R: 0.8343); contrastive_loss: 9.8927; total_loss: 3.7271
2026-01-20 00:40:17 Test. Batch 2/11
2026-01-20 00:40:18 Test. main_loss: 3.2378 (F: 4.2654, R: 0.8399); contrastive_loss: 10.2241; total_loss: 3.7490
2026-01-20 00:40:18 Test. Batch 3/11
2026-01-20 00:40:19 Test. main_loss: 3.2213 (F: 4.2499, R: 0.8212); contrastive_loss: 9.8394; total_loss: 3.7132
2026-01-20 00:40:20 Test. Batch 4/11
2026-01-20 00:40:21 Test. main_loss: 3.1925 (F: 4.2301, R: 0.7714); contrastive_loss: 9.3459; total_loss: 3.6598
2026-01-20 00:40:21 Test. Batch 5/11
2026-01-20 00:40:22 Test. main_loss: 3.2404 (F: 4.2660, R: 0.8475); contrastive_loss: 10.1637; total_loss: 3.7486
2026-01-20 00:40:22 Test. Batch 6/11
2026-01-20 00:40:24 Test. main_loss: 3.2139 (F: 4.2469, R: 0.8035); contrastive_loss: 9.5651; total_loss: 3.6921
2026-01-20 00:40:24 Test. Batch 7/11
2026-01-20 00:40:25 Test. main_loss: 3.2139 (F: 4.2445, R: 0.8091); contrastive_loss: 9.9705; total_loss: 3.7124
2026-01-20 00:40:25 Test. Batch 8/11
2026-01-20 00:40:26 Test. main_loss: 3.2396 (F: 4.2656, R: 0.8457); contrastive_loss: 10.1316; total_loss: 3.7462
2026-01-20 00:40:27 Test. Batch 9/11
2026-01-20 00:40:28 Test. main_loss: 3.2034 (F: 4.2385, R: 0.7880); contrastive_loss: 9.5062; total_loss: 3.6787
2026-01-20 00:40:28 Test. Batch 10/11
2026-01-20 00:40:29 Test. main_loss: 3.2095 (F: 4.2431, R: 0.7979); contrastive_loss: 9.6432; total_loss: 3.6917
2026-01-20 00:40:29 Testing finishes
2026-01-20 00:40:29 Testing loss: 3.7170877023176714
2026-01-20 00:40:29 Testing results:
2026-01-20 00:40:29 Recall@1: 0.1928
2026-01-20 00:40:29 NDCG@1: 0.1928
2026-01-20 00:40:29 Recall@5: 0.3275
2026-01-20 00:40:29 NDCG@5: 0.2652
2026-01-20 00:40:29 Recall@10: 0.3728
2026-01-20 00:40:29 NDCG@10: 0.2799
2026-01-20 00:40:29 Recall@20: 0.4090
2026-01-20 00:40:29 NDCG@20: 0.2892
2026-01-20 00:40:29 ==================================


2026-01-20 00:40:29 ================= Epoch 17/30 =================
2026-01-20 00:40:29 Train. Batch 0/11
2026-01-20 00:40:34 Train. Clean: 2.8485 (F: 3.9622, R: 0.2500, CL: 0.7729) | Adv: 2.9274 (F: 4.0265, R: 0.3628, CL: 1.8968)
2026-01-20 00:40:34 Train. Batch 1/11
2026-01-20 00:40:39 Train. Clean: 2.8495 (F: 3.9634, R: 0.2505, CL: 0.6994) | Adv: 2.9344 (F: 4.0344, R: 0.3678, CL: 1.7955)
2026-01-20 00:40:39 Train. Batch 2/11
2026-01-20 00:40:44 Train. Clean: 2.8477 (F: 3.9619, R: 0.2479, CL: 0.8221) | Adv: 2.9251 (F: 4.0254, R: 0.3578, CL: 1.9413)
2026-01-20 00:40:44 Train. Batch 3/11
2026-01-20 00:40:49 Train. Clean: 2.8479 (F: 3.9610, R: 0.2508, CL: 0.7730) | Adv: 2.9280 (F: 4.0279, R: 0.3615, CL: 1.9512)
2026-01-20 00:40:49 Train. Batch 4/11
2026-01-20 00:40:54 Train. Clean: 2.8522 (F: 3.9654, R: 0.2545, CL: 0.8412) | Adv: 2.9340 (F: 4.0337, R: 0.3678, CL: 2.0195)
2026-01-20 00:40:54 Train. Batch 5/11
2026-01-20 00:40:59 Train. Clean: 2.8470 (F: 3.9610, R: 0.2475, CL: 0.8359) | Adv: 2.9269 (F: 4.0266, R: 0.3609, CL: 2.0402)
2026-01-20 00:40:59 Train. Batch 6/11
2026-01-20 00:41:04 Train. Clean: 2.8493 (F: 3.9627, R: 0.2512, CL: 0.8518) | Adv: 2.9291 (F: 4.0290, R: 0.3627, CL: 2.1627)
2026-01-20 00:41:05 Train. Batch 7/11
2026-01-20 00:41:09 Train. Clean: 2.8506 (F: 3.9640, R: 0.2526, CL: 0.8128) | Adv: 2.9336 (F: 4.0335, R: 0.3669, CL: 1.9689)
2026-01-20 00:41:09 Train. Batch 8/11
2026-01-20 00:41:14 Train. Clean: 2.8470 (F: 3.9607, R: 0.2484, CL: 0.8213) | Adv: 2.9251 (F: 4.0259, R: 0.3567, CL: 2.0350)
2026-01-20 00:41:14 Train. Batch 9/11
2026-01-20 00:41:19 Train. Clean: 2.8486 (F: 3.9624, R: 0.2499, CL: 0.7719) | Adv: 2.9239 (F: 4.0236, R: 0.3577, CL: 1.8585)
2026-01-20 00:41:19 Train. Batch 10/11
2026-01-20 00:41:23 Train. Clean: 2.8475 (F: 3.9619, R: 0.2472, CL: 0.7519) | Adv: 2.9324 (F: 4.0311, R: 0.3687, CL: 1.9598)
2026-01-20 00:41:23 Training finishes at this epoch. It takes 0.8963512937227885 min
2026-01-20 00:41:23 Training loss: 2.9579
2026-01-20 00:41:23 Training Epoch 17/30 results:
2026-01-20 00:41:23 Recall@1: 0.9977
2026-01-20 00:41:23 NDCG@1: 0.9977
2026-01-20 00:41:23 Recall@5: 1.0000
2026-01-20 00:41:23 NDCG@5: 0.9991
2026-01-20 00:41:23 Recall@10: 1.0000
2026-01-20 00:41:23 NDCG@10: 0.9991
2026-01-20 00:41:23 Recall@20: 1.0000
2026-01-20 00:41:23 NDCG@20: 0.9991
2026-01-20 00:41:23 

2026-01-20 00:41:23 Testing
2026-01-20 00:41:23 Test. Batch 0/11
2026-01-20 00:41:24 Test. main_loss: 3.2107 (F: 4.2436, R: 0.8008); contrastive_loss: 9.7381; total_loss: 3.6976
2026-01-20 00:41:24 Test. Batch 1/11
2026-01-20 00:41:26 Test. main_loss: 3.2293 (F: 4.2566, R: 0.8321); contrastive_loss: 10.1694; total_loss: 3.7378
2026-01-20 00:41:26 Test. Batch 2/11
2026-01-20 00:41:27 Test. main_loss: 3.2141 (F: 4.2455, R: 0.8073); contrastive_loss: 9.6027; total_loss: 3.6942
2026-01-20 00:41:27 Test. Batch 3/11
2026-01-20 00:41:28 Test. main_loss: 3.2292 (F: 4.2570, R: 0.8310); contrastive_loss: 10.0718; total_loss: 3.7328
2026-01-20 00:41:29 Test. Batch 4/11
2026-01-20 00:41:30 Test. main_loss: 3.2195 (F: 4.2505, R: 0.8140); contrastive_loss: 9.8117; total_loss: 3.7101
2026-01-20 00:41:30 Test. Batch 5/11
2026-01-20 00:41:31 Test. main_loss: 3.1935 (F: 4.2296, R: 0.7759); contrastive_loss: 9.5213; total_loss: 3.6696
2026-01-20 00:41:31 Test. Batch 6/11
2026-01-20 00:41:33 Test. main_loss: 3.2481 (F: 4.2729, R: 0.8569); contrastive_loss: 10.1160; total_loss: 3.7539
2026-01-20 00:41:33 Test. Batch 7/11
2026-01-20 00:41:34 Test. main_loss: 3.2212 (F: 4.2515, R: 0.8174); contrastive_loss: 9.7214; total_loss: 3.7073
2026-01-20 00:41:34 Test. Batch 8/11
2026-01-20 00:41:35 Test. main_loss: 3.2106 (F: 4.2431, R: 0.8015); contrastive_loss: 9.7776; total_loss: 3.6995
2026-01-20 00:41:35 Test. Batch 9/11
2026-01-20 00:41:37 Test. main_loss: 3.2396 (F: 4.2665, R: 0.8435); contrastive_loss: 10.0278; total_loss: 3.7410
2026-01-20 00:41:37 Test. Batch 10/11
2026-01-20 00:41:38 Test. main_loss: 3.2413 (F: 4.2650, R: 0.8526); contrastive_loss: 10.4024; total_loss: 3.7614
2026-01-20 00:41:38 Testing finishes
2026-01-20 00:41:38 Testing loss: 3.718658859079534
2026-01-20 00:41:38 Testing results:
2026-01-20 00:41:38 Recall@1: 0.1956
2026-01-20 00:41:38 NDCG@1: 0.1956
2026-01-20 00:41:38 Recall@5: 0.3246
2026-01-20 00:41:38 NDCG@5: 0.2645
2026-01-20 00:41:38 Recall@10: 0.3724
2026-01-20 00:41:38 NDCG@10: 0.2802
2026-01-20 00:41:38 Recall@20: 0.4073
2026-01-20 00:41:38 NDCG@20: 0.2890
2026-01-20 00:41:38 ==================================


2026-01-20 00:41:38 ================= Epoch 18/30 =================
2026-01-20 00:41:38 Train. Batch 0/11
2026-01-20 00:41:43 Train. Clean: 2.8472 (F: 3.9613, R: 0.2477, CL: 0.7105) | Adv: 2.9224 (F: 4.0239, R: 0.3524, CL: 1.7467)
2026-01-20 00:41:44 Train. Batch 1/11
2026-01-20 00:41:49 Train. Clean: 2.8477 (F: 3.9621, R: 0.2476, CL: 0.7923) | Adv: 2.9222 (F: 4.0227, R: 0.3543, CL: 1.7327)
2026-01-20 00:41:49 Train. Batch 2/11
2026-01-20 00:41:54 Train. Clean: 2.8478 (F: 3.9626, R: 0.2464, CL: 0.7319) | Adv: 2.9229 (F: 4.0269, R: 0.3470, CL: 1.6700)
2026-01-20 00:41:54 Train. Batch 3/11
2026-01-20 00:41:58 Train. Clean: 2.8492 (F: 3.9623, R: 0.2520, CL: 0.7763) | Adv: 2.9262 (F: 4.0277, R: 0.3562, CL: 1.7819)
2026-01-20 00:41:58 Train. Batch 4/11
2026-01-20 00:42:03 Train. Clean: 2.8469 (F: 3.9599, R: 0.2498, CL: 0.8884) | Adv: 2.9145 (F: 4.0154, R: 0.3458, CL: 2.0867)
2026-01-20 00:42:04 Train. Batch 5/11
2026-01-20 00:42:08 Train. Clean: 2.8486 (F: 3.9631, R: 0.2481, CL: 0.9254) | Adv: 2.9217 (F: 4.0237, R: 0.3503, CL: 2.0668)
2026-01-20 00:42:08 Train. Batch 6/11
2026-01-20 00:42:13 Train. Clean: 2.8497 (F: 3.9620, R: 0.2546, CL: 0.7641) | Adv: 2.9259 (F: 4.0258, R: 0.3595, CL: 1.9508)
2026-01-20 00:42:14 Train. Batch 7/11
2026-01-20 00:42:18 Train. Clean: 2.8466 (F: 3.9609, R: 0.2466, CL: 0.7340) | Adv: 2.9241 (F: 4.0248, R: 0.3557, CL: 1.7963)
2026-01-20 00:42:18 Train. Batch 8/11
2026-01-20 00:42:23 Train. Clean: 2.8467 (F: 3.9606, R: 0.2476, CL: 0.7778) | Adv: 2.9180 (F: 4.0183, R: 0.3506, CL: 1.9839)
2026-01-20 00:42:23 Train. Batch 9/11
2026-01-20 00:42:28 Train. Clean: 2.8499 (F: 3.9619, R: 0.2552, CL: 0.8889) | Adv: 2.9206 (F: 4.0201, R: 0.3551, CL: 2.1775)
2026-01-20 00:42:28 Train. Batch 10/11
2026-01-20 00:42:32 Train. Clean: 2.8446 (F: 3.9580, R: 0.2466, CL: 0.7133) | Adv: 2.9250 (F: 4.0252, R: 0.3577, CL: 1.9010)
2026-01-20 00:42:32 Training finishes at this epoch. It takes 0.9059093991915385 min
2026-01-20 00:42:32 Training loss: 2.9522
2026-01-20 00:42:32 Training Epoch 18/30 results:
2026-01-20 00:42:32 Recall@1: 0.9986
2026-01-20 00:42:32 NDCG@1: 0.9986
2026-01-20 00:42:32 Recall@5: 1.0000
2026-01-20 00:42:32 NDCG@5: 0.9995
2026-01-20 00:42:32 Recall@10: 1.0000
2026-01-20 00:42:32 NDCG@10: 0.9995
2026-01-20 00:42:32 Recall@20: 1.0000
2026-01-20 00:42:32 NDCG@20: 0.9995
2026-01-20 00:42:32 

2026-01-20 00:42:32 Testing
2026-01-20 00:42:32 Test. Batch 0/11
2026-01-20 00:42:34 Test. main_loss: 3.2207 (F: 4.2514, R: 0.8156); contrastive_loss: 9.6880; total_loss: 3.7051
2026-01-20 00:42:34 Test. Batch 1/11
2026-01-20 00:42:35 Test. main_loss: 3.2263 (F: 4.2561, R: 0.8234); contrastive_loss: 9.8630; total_loss: 3.7194
2026-01-20 00:42:35 Test. Batch 2/11
2026-01-20 00:42:36 Test. main_loss: 3.2257 (F: 4.2550, R: 0.8239); contrastive_loss: 10.0031; total_loss: 3.7258
2026-01-20 00:42:36 Test. Batch 3/11
2026-01-20 00:42:38 Test. main_loss: 3.2418 (F: 4.2672, R: 0.8491); contrastive_loss: 10.3745; total_loss: 3.7605
2026-01-20 00:42:38 Test. Batch 4/11
2026-01-20 00:42:39 Test. main_loss: 3.2034 (F: 4.2370, R: 0.7915); contrastive_loss: 9.5732; total_loss: 3.6820
2026-01-20 00:42:39 Test. Batch 5/11
2026-01-20 00:42:40 Test. main_loss: 3.2324 (F: 4.2593, R: 0.8361); contrastive_loss: 10.2811; total_loss: 3.7464
2026-01-20 00:42:41 Test. Batch 6/11
2026-01-20 00:42:42 Test. main_loss: 3.2209 (F: 4.2505, R: 0.8185); contrastive_loss: 9.9528; total_loss: 3.7185
2026-01-20 00:42:42 Test. Batch 7/11
2026-01-20 00:42:43 Test. main_loss: 3.2246 (F: 4.2532, R: 0.8245); contrastive_loss: 9.7554; total_loss: 3.7123
2026-01-20 00:42:43 Test. Batch 8/11
2026-01-20 00:42:44 Test. main_loss: 3.2295 (F: 4.2556, R: 0.8351); contrastive_loss: 9.9982; total_loss: 3.7294
2026-01-20 00:42:45 Test. Batch 9/11
2026-01-20 00:42:46 Test. main_loss: 3.2134 (F: 4.2450, R: 0.8066); contrastive_loss: 9.6298; total_loss: 3.6949
2026-01-20 00:42:46 Test. Batch 10/11
2026-01-20 00:42:47 Test. main_loss: 3.2112 (F: 4.2442, R: 0.8006); contrastive_loss: 9.6400; total_loss: 3.6931
2026-01-20 00:42:47 Testing finishes
2026-01-20 00:42:47 Testing loss: 3.7170516794378106
2026-01-20 00:42:47 Testing results:
2026-01-20 00:42:47 Recall@1: 0.1910
2026-01-20 00:42:47 NDCG@1: 0.1910
2026-01-20 00:42:47 Recall@5: 0.3266
2026-01-20 00:42:47 NDCG@5: 0.2643
2026-01-20 00:42:47 Recall@10: 0.3732
2026-01-20 00:42:47 NDCG@10: 0.2795
2026-01-20 00:42:47 Recall@20: 0.4098
2026-01-20 00:42:47 NDCG@20: 0.2887
2026-01-20 00:42:47 ==================================


2026-01-20 00:42:47 ================= Epoch 19/30 =================
2026-01-20 00:42:47 Train. Batch 0/11
2026-01-20 00:42:52 Train. Clean: 2.8471 (F: 3.9614, R: 0.2470, CL: 0.7915) | Adv: 2.9253 (F: 4.0269, R: 0.3548, CL: 1.8657)
2026-01-20 00:42:52 Train. Batch 1/11
2026-01-20 00:42:58 Train. Clean: 2.8465 (F: 3.9612, R: 0.2455, CL: 0.6893) | Adv: 2.9214 (F: 4.0236, R: 0.3495, CL: 1.6467)
2026-01-20 00:42:58 Train. Batch 2/11
2026-01-20 00:43:03 Train. Clean: 2.8460 (F: 3.9608, R: 0.2448, CL: 0.7698) | Adv: 2.9209 (F: 4.0198, R: 0.3566, CL: 1.8795)
2026-01-20 00:43:03 Train. Batch 3/11
2026-01-20 00:43:08 Train. Clean: 2.8490 (F: 3.9616, R: 0.2529, CL: 0.8497) | Adv: 2.9165 (F: 4.0198, R: 0.3421, CL: 1.8618)
2026-01-20 00:43:08 Train. Batch 4/11
2026-01-20 00:43:12 Train. Clean: 2.8480 (F: 3.9604, R: 0.2525, CL: 0.8470) | Adv: 2.9150 (F: 4.0159, R: 0.3461, CL: 1.9770)
2026-01-20 00:43:12 Train. Batch 5/11
2026-01-20 00:43:17 Train. Clean: 2.8461 (F: 3.9601, R: 0.2468, CL: 0.7385) | Adv: 2.9174 (F: 4.0194, R: 0.3461, CL: 1.7322)
2026-01-20 00:43:17 Train. Batch 6/11
2026-01-20 00:43:22 Train. Clean: 2.8460 (F: 3.9617, R: 0.2426, CL: 0.6891) | Adv: 2.9203 (F: 4.0220, R: 0.3495, CL: 1.6634)
2026-01-20 00:43:22 Train. Batch 7/11
2026-01-20 00:43:27 Train. Clean: 2.8457 (F: 3.9605, R: 0.2444, CL: 0.8025) | Adv: 2.9193 (F: 4.0208, R: 0.3491, CL: 1.9252)
2026-01-20 00:43:27 Train. Batch 8/11
2026-01-20 00:43:32 Train. Clean: 2.8454 (F: 3.9595, R: 0.2460, CL: 0.8473) | Adv: 2.9197 (F: 4.0194, R: 0.3538, CL: 2.0263)
2026-01-20 00:43:32 Train. Batch 9/11
2026-01-20 00:43:37 Train. Clean: 2.8491 (F: 3.9636, R: 0.2486, CL: 0.7577) | Adv: 2.9304 (F: 4.0320, R: 0.3599, CL: 1.7237)
2026-01-20 00:43:37 Train. Batch 10/11
2026-01-20 00:43:42 Train. Clean: 2.8437 (F: 3.9565, R: 0.2471, CL: 0.8046) | Adv: 2.9246 (F: 4.0219, R: 0.3643, CL: 2.1808)
2026-01-20 00:43:42 Training finishes at this epoch. It takes 0.9076799194018046 min
2026-01-20 00:43:42 Training loss: 2.9499
2026-01-20 00:43:42 Training Epoch 19/30 results:
2026-01-20 00:43:42 Recall@1: 0.9982
2026-01-20 00:43:42 NDCG@1: 0.9982
2026-01-20 00:43:42 Recall@5: 1.0000
2026-01-20 00:43:42 NDCG@5: 0.9993
2026-01-20 00:43:42 Recall@10: 1.0000
2026-01-20 00:43:42 NDCG@10: 0.9993
2026-01-20 00:43:42 Recall@20: 1.0000
2026-01-20 00:43:42 NDCG@20: 0.9993
2026-01-20 00:43:42 

2026-01-20 00:43:42 Testing
2026-01-20 00:43:42 Test. Batch 0/11
2026-01-20 00:43:43 Test. main_loss: 3.2150 (F: 4.2464, R: 0.8085); contrastive_loss: 9.5650; total_loss: 3.6933
2026-01-20 00:43:43 Test. Batch 1/11
2026-01-20 00:43:44 Test. main_loss: 3.2488 (F: 4.2712, R: 0.8632); contrastive_loss: 10.7274; total_loss: 3.7852
2026-01-20 00:43:44 Test. Batch 2/11
2026-01-20 00:43:45 Test. main_loss: 3.2095 (F: 4.2421, R: 0.8002); contrastive_loss: 9.3675; total_loss: 3.6779
2026-01-20 00:43:46 Test. Batch 3/11
2026-01-20 00:43:47 Test. main_loss: 3.2473 (F: 4.2708, R: 0.8589); contrastive_loss: 10.6330; total_loss: 3.7789
2026-01-20 00:43:47 Test. Batch 4/11
2026-01-20 00:43:48 Test. main_loss: 3.2312 (F: 4.2596, R: 0.8315); contrastive_loss: 10.0691; total_loss: 3.7346
2026-01-20 00:43:48 Test. Batch 5/11
2026-01-20 00:43:50 Test. main_loss: 3.2140 (F: 4.2460, R: 0.8059); contrastive_loss: 9.8354; total_loss: 3.7058
2026-01-20 00:43:50 Test. Batch 6/11
2026-01-20 00:43:51 Test. main_loss: 3.2189 (F: 4.2506, R: 0.8114); contrastive_loss: 9.6967; total_loss: 3.7037
2026-01-20 00:43:51 Test. Batch 7/11
2026-01-20 00:43:52 Test. main_loss: 3.2033 (F: 4.2376, R: 0.7897); contrastive_loss: 9.3072; total_loss: 3.6686
2026-01-20 00:43:52 Test. Batch 8/11
2026-01-20 00:43:54 Test. main_loss: 3.2107 (F: 4.2424, R: 0.8034); contrastive_loss: 9.8734; total_loss: 3.7044
2026-01-20 00:43:54 Test. Batch 9/11
2026-01-20 00:43:55 Test. main_loss: 3.2369 (F: 4.2641, R: 0.8400); contrastive_loss: 10.3648; total_loss: 3.7551
2026-01-20 00:43:55 Test. Batch 10/11
2026-01-20 00:43:56 Test. main_loss: 3.2127 (F: 4.2444, R: 0.8054); contrastive_loss: 9.6346; total_loss: 3.6944
2026-01-20 00:43:56 Testing finishes
2026-01-20 00:43:56 Testing loss: 3.7183635234832764
2026-01-20 00:43:56 Testing results:
2026-01-20 00:43:56 Recall@1: 0.1920
2026-01-20 00:43:56 NDCG@1: 0.1920
2026-01-20 00:43:56 Recall@5: 0.3283
2026-01-20 00:43:56 NDCG@5: 0.2652
2026-01-20 00:43:56 Recall@10: 0.3701
2026-01-20 00:43:56 NDCG@10: 0.2787
2026-01-20 00:43:56 Recall@20: 0.4070
2026-01-20 00:43:56 NDCG@20: 0.2881
2026-01-20 00:43:56 ==================================


2026-01-20 00:43:56 ================= Epoch 20/30 =================
2026-01-20 00:43:56 Train. Batch 0/11
2026-01-20 00:44:01 Train. Clean: 2.8463 (F: 3.9597, R: 0.2483, CL: 0.7115) | Adv: 2.9184 (F: 4.0209, R: 0.3458, CL: 1.7265)
2026-01-20 00:44:02 Train. Batch 1/11
2026-01-20 00:44:06 Train. Clean: 2.8470 (F: 3.9607, R: 0.2484, CL: 0.8367) | Adv: 2.9248 (F: 4.0248, R: 0.3582, CL: 2.0710)
2026-01-20 00:44:06 Train. Batch 2/11
2026-01-20 00:44:11 Train. Clean: 2.8443 (F: 3.9592, R: 0.2428, CL: 0.7598) | Adv: 2.9160 (F: 4.0168, R: 0.3473, CL: 1.7877)
2026-01-20 00:44:11 Train. Batch 3/11
2026-01-20 00:44:16 Train. Clean: 2.8452 (F: 3.9574, R: 0.2502, CL: 0.8541) | Adv: 2.9124 (F: 4.0136, R: 0.3431, CL: 2.0813)
2026-01-20 00:44:16 Train. Batch 4/11
2026-01-20 00:44:21 Train. Clean: 2.8476 (F: 3.9617, R: 0.2481, CL: 0.8418) | Adv: 2.9220 (F: 4.0221, R: 0.3551, CL: 1.9068)
2026-01-20 00:44:21 Train. Batch 5/11
2026-01-20 00:44:26 Train. Clean: 2.8450 (F: 3.9583, R: 0.2474, CL: 0.8310) | Adv: 2.9165 (F: 4.0162, R: 0.3506, CL: 2.0283)
2026-01-20 00:44:27 Train. Batch 6/11
2026-01-20 00:44:31 Train. Clean: 2.8476 (F: 3.9613, R: 0.2488, CL: 0.7547) | Adv: 2.9183 (F: 4.0206, R: 0.3462, CL: 1.7440)
2026-01-20 00:44:32 Train. Batch 7/11
2026-01-20 00:44:36 Train. Clean: 2.8451 (F: 3.9606, R: 0.2423, CL: 0.6958) | Adv: 2.9224 (F: 4.0251, R: 0.3494, CL: 1.6182)
2026-01-20 00:44:36 Train. Batch 8/11
2026-01-20 00:44:41 Train. Clean: 2.8453 (F: 3.9591, R: 0.2463, CL: 0.7745) | Adv: 2.9187 (F: 4.0193, R: 0.3507, CL: 1.9158)
2026-01-20 00:44:41 Train. Batch 9/11
2026-01-20 00:44:46 Train. Clean: 2.8466 (F: 3.9613, R: 0.2456, CL: 0.8676) | Adv: 2.9275 (F: 4.0300, R: 0.3550, CL: 1.9663)
2026-01-20 00:44:47 Train. Batch 10/11
2026-01-20 00:44:51 Train. Clean: 2.8460 (F: 3.9598, R: 0.2472, CL: 0.7360) | Adv: 2.9283 (F: 4.0285, R: 0.3613, CL: 1.8191)
2026-01-20 00:44:51 Training finishes at this epoch. It takes 0.9083569924036662 min
2026-01-20 00:44:51 Training loss: 2.9499
2026-01-20 00:44:51 Training Epoch 20/30 results:
2026-01-20 00:44:51 Recall@1: 0.9982
2026-01-20 00:44:51 NDCG@1: 0.9982
2026-01-20 00:44:51 Recall@5: 1.0000
2026-01-20 00:44:51 NDCG@5: 0.9993
2026-01-20 00:44:51 Recall@10: 1.0000
2026-01-20 00:44:51 NDCG@10: 0.9993
2026-01-20 00:44:51 Recall@20: 1.0000
2026-01-20 00:44:51 NDCG@20: 0.9993
2026-01-20 00:44:51 

2026-01-20 00:44:51 Testing
2026-01-20 00:44:51 Test. Batch 0/11
2026-01-20 00:44:52 Test. main_loss: 3.2405 (F: 4.2670, R: 0.8452); contrastive_loss: 10.4254; total_loss: 3.7617
2026-01-20 00:44:52 Test. Batch 1/11
2026-01-20 00:44:53 Test. main_loss: 3.2174 (F: 4.2486, R: 0.8112); contrastive_loss: 9.7292; total_loss: 3.7039
2026-01-20 00:44:53 Test. Batch 2/11
2026-01-20 00:44:55 Test. main_loss: 3.2273 (F: 4.2558, R: 0.8276); contrastive_loss: 10.1749; total_loss: 3.7361
2026-01-20 00:44:55 Test. Batch 3/11
2026-01-20 00:44:56 Test. main_loss: 3.2304 (F: 4.2585, R: 0.8314); contrastive_loss: 9.9939; total_loss: 3.7301
2026-01-20 00:44:56 Test. Batch 4/11
2026-01-20 00:44:57 Test. main_loss: 3.2184 (F: 4.2497, R: 0.8121); contrastive_loss: 9.7792; total_loss: 3.7074
2026-01-20 00:44:58 Test. Batch 5/11
2026-01-20 00:44:59 Test. main_loss: 3.2230 (F: 4.2517, R: 0.8225); contrastive_loss: 10.0187; total_loss: 3.7239
2026-01-20 00:44:59 Test. Batch 6/11
2026-01-20 00:45:00 Test. main_loss: 3.2069 (F: 4.2396, R: 0.7972); contrastive_loss: 9.5652; total_loss: 3.6851
2026-01-20 00:45:00 Test. Batch 7/11
2026-01-20 00:45:02 Test. main_loss: 3.2311 (F: 4.2598, R: 0.8309); contrastive_loss: 9.8172; total_loss: 3.7220
2026-01-20 00:45:02 Test. Batch 8/11
2026-01-20 00:45:03 Test. main_loss: 3.1998 (F: 4.2326, R: 0.7900); contrastive_loss: 9.3076; total_loss: 3.6652
2026-01-20 00:45:03 Test. Batch 9/11
2026-01-20 00:45:04 Test. main_loss: 3.2302 (F: 4.2574, R: 0.8334); contrastive_loss: 9.9791; total_loss: 3.7292
2026-01-20 00:45:05 Test. Batch 10/11
2026-01-20 00:45:06 Test. main_loss: 3.2297 (F: 4.2569, R: 0.8329); contrastive_loss: 10.1084; total_loss: 3.7351
2026-01-20 00:45:06 Testing finishes
2026-01-20 00:45:06 Testing loss: 3.718144416809082
2026-01-20 00:45:06 Testing results:
2026-01-20 00:45:06 Recall@1: 0.1908
2026-01-20 00:45:06 NDCG@1: 0.1908
2026-01-20 00:45:06 Recall@5: 0.3308
2026-01-20 00:45:06 NDCG@5: 0.2655
2026-01-20 00:45:06 Recall@10: 0.3711
2026-01-20 00:45:06 NDCG@10: 0.2786
2026-01-20 00:45:06 Recall@20: 0.4057
2026-01-20 00:45:06 NDCG@20: 0.2873
2026-01-20 00:45:06 ==================================


2026-01-20 00:45:06 ================= Epoch 21/30 =================
2026-01-20 00:45:06 Train. Batch 0/11
2026-01-20 00:45:11 Train. Clean: 2.8468 (F: 3.9601, R: 0.2492, CL: 0.7380) | Adv: 2.9196 (F: 4.0225, R: 0.3461, CL: 1.6449)
2026-01-20 00:45:11 Train. Batch 1/11
2026-01-20 00:45:15 Train. Clean: 2.8448 (F: 3.9596, R: 0.2437, CL: 0.7493) | Adv: 2.9182 (F: 4.0199, R: 0.3475, CL: 1.7931)
2026-01-20 00:45:15 Train. Batch 2/11
2026-01-20 00:45:20 Train. Clean: 2.8444 (F: 3.9593, R: 0.2429, CL: 0.7565) | Adv: 2.9155 (F: 4.0185, R: 0.3419, CL: 1.6902)
2026-01-20 00:45:20 Train. Batch 3/11
2026-01-20 00:45:25 Train. Clean: 2.8431 (F: 3.9583, R: 0.2411, CL: 0.7405) | Adv: 2.9146 (F: 4.0163, R: 0.3437, CL: 1.7688)
2026-01-20 00:45:25 Train. Batch 4/11
2026-01-20 00:45:30 Train. Clean: 2.8461 (F: 3.9587, R: 0.2499, CL: 0.8574) | Adv: 2.9189 (F: 4.0190, R: 0.3519, CL: 2.0699)
2026-01-20 00:45:31 Train. Batch 5/11
2026-01-20 00:45:36 Train. Clean: 2.8465 (F: 3.9594, R: 0.2496, CL: 0.8664) | Adv: 2.9205 (F: 4.0220, R: 0.3503, CL: 1.9098)
2026-01-20 00:45:36 Train. Batch 6/11
2026-01-20 00:45:41 Train. Clean: 2.8435 (F: 3.9569, R: 0.2454, CL: 0.7454) | Adv: 2.9141 (F: 4.0161, R: 0.3426, CL: 1.7047)
2026-01-20 00:45:41 Train. Batch 7/11
2026-01-20 00:45:46 Train. Clean: 2.8474 (F: 3.9599, R: 0.2515, CL: 0.7520) | Adv: 2.9199 (F: 4.0203, R: 0.3522, CL: 1.9282)
2026-01-20 00:45:47 Train. Batch 8/11
2026-01-20 00:45:51 Train. Clean: 2.8480 (F: 3.9615, R: 0.2499, CL: 0.8517) | Adv: 2.9199 (F: 4.0206, R: 0.3515, CL: 2.0581)
2026-01-20 00:45:51 Train. Batch 9/11
2026-01-20 00:45:56 Train. Clean: 2.8486 (F: 3.9619, R: 0.2510, CL: 0.8113) | Adv: 2.9330 (F: 4.0338, R: 0.3645, CL: 1.8394)
2026-01-20 00:45:56 Train. Batch 10/11
2026-01-20 00:46:00 Train. Clean: 2.8453 (F: 3.9602, R: 0.2437, CL: 0.7062) | Adv: 2.9269 (F: 4.0258, R: 0.3630, CL: 1.7653)
2026-01-20 00:46:00 Training finishes at this epoch. It takes 0.9005080898602803 min
2026-01-20 00:46:00 Training loss: 2.9483
2026-01-20 00:46:00 Training Epoch 21/30 results:
2026-01-20 00:46:00 Recall@1: 0.9982
2026-01-20 00:46:00 NDCG@1: 0.9982
2026-01-20 00:46:00 Recall@5: 1.0000
2026-01-20 00:46:00 NDCG@5: 0.9993
2026-01-20 00:46:00 Recall@10: 1.0000
2026-01-20 00:46:00 NDCG@10: 0.9993
2026-01-20 00:46:00 Recall@20: 1.0000
2026-01-20 00:46:00 NDCG@20: 0.9993
2026-01-20 00:46:00 

2026-01-20 00:46:00 Testing
2026-01-20 00:46:00 Test. Batch 0/11
2026-01-20 00:46:01 Test. main_loss: 3.2139 (F: 4.2455, R: 0.8067); contrastive_loss: 9.7674; total_loss: 3.7023
2026-01-20 00:46:02 Test. Batch 1/11
2026-01-20 00:46:03 Test. main_loss: 3.2132 (F: 4.2449, R: 0.8058); contrastive_loss: 9.7064; total_loss: 3.6985
2026-01-20 00:46:03 Test. Batch 2/11
2026-01-20 00:46:04 Test. main_loss: 3.2308 (F: 4.2575, R: 0.8353); contrastive_loss: 10.0941; total_loss: 3.7355
2026-01-20 00:46:04 Test. Batch 3/11
2026-01-20 00:46:06 Test. main_loss: 3.2203 (F: 4.2502, R: 0.8173); contrastive_loss: 10.0832; total_loss: 3.7245
2026-01-20 00:46:06 Test. Batch 4/11
2026-01-20 00:46:07 Test. main_loss: 3.2281 (F: 4.2568, R: 0.8278); contrastive_loss: 9.8561; total_loss: 3.7209
2026-01-20 00:46:07 Test. Batch 5/11
2026-01-20 00:46:08 Test. main_loss: 3.2339 (F: 4.2606, R: 0.8384); contrastive_loss: 10.2404; total_loss: 3.7460
2026-01-20 00:46:09 Test. Batch 6/11
2026-01-20 00:46:10 Test. main_loss: 3.2283 (F: 4.2587, R: 0.8242); contrastive_loss: 9.8410; total_loss: 3.7204
2026-01-20 00:46:10 Test. Batch 7/11
2026-01-20 00:46:11 Test. main_loss: 3.2137 (F: 4.2455, R: 0.8061); contrastive_loss: 9.7247; total_loss: 3.6999
2026-01-20 00:46:11 Test. Batch 8/11
2026-01-20 00:46:13 Test. main_loss: 3.2346 (F: 4.2624, R: 0.8364); contrastive_loss: 10.2547; total_loss: 3.7473
2026-01-20 00:46:13 Test. Batch 9/11
2026-01-20 00:46:14 Test. main_loss: 3.2297 (F: 4.2578, R: 0.8310); contrastive_loss: 9.8712; total_loss: 3.7233
2026-01-20 00:46:14 Test. Batch 10/11
2026-01-20 00:46:15 Test. main_loss: 3.1976 (F: 4.2316, R: 0.7850); contrastive_loss: 9.1726; total_loss: 3.6563
2026-01-20 00:46:15 Testing finishes
2026-01-20 00:46:15 Testing loss: 3.7158981670032847
2026-01-20 00:46:15 Testing results:
2026-01-20 00:46:15 Recall@1: 0.1905
2026-01-20 00:46:15 NDCG@1: 0.1905
2026-01-20 00:46:15 Recall@5: 0.3280
2026-01-20 00:46:15 NDCG@5: 0.2648
2026-01-20 00:46:15 Recall@10: 0.3768
2026-01-20 00:46:15 NDCG@10: 0.2805
2026-01-20 00:46:15 Recall@20: 0.4093
2026-01-20 00:46:15 NDCG@20: 0.2886
2026-01-20 00:46:15 ==================================


2026-01-20 00:46:15 ================= Epoch 22/30 =================
2026-01-20 00:46:15 Train. Batch 0/11
2026-01-20 00:46:20 Train. Clean: 2.8462 (F: 3.9603, R: 0.2466, CL: 0.7517) | Adv: 2.9239 (F: 4.0248, R: 0.3551, CL: 1.7496)
2026-01-20 00:46:20 Train. Batch 1/11
2026-01-20 00:46:25 Train. Clean: 2.8440 (F: 3.9581, R: 0.2446, CL: 0.8308) | Adv: 2.9174 (F: 4.0195, R: 0.3456, CL: 1.9265)
2026-01-20 00:46:25 Train. Batch 2/11
2026-01-20 00:46:30 Train. Clean: 2.8481 (F: 3.9608, R: 0.2519, CL: 0.8830) | Adv: 2.9241 (F: 4.0240, R: 0.3576, CL: 1.9864)
2026-01-20 00:46:30 Train. Batch 3/11
2026-01-20 00:46:35 Train. Clean: 2.8431 (F: 3.9574, R: 0.2433, CL: 0.7474) | Adv: 2.9138 (F: 4.0152, R: 0.3441, CL: 1.9709)
2026-01-20 00:46:35 Train. Batch 4/11
2026-01-20 00:46:41 Train. Clean: 2.8450 (F: 3.9581, R: 0.2477, CL: 0.8025) | Adv: 2.9208 (F: 4.0201, R: 0.3557, CL: 1.8886)
2026-01-20 00:46:41 Train. Batch 5/11
2026-01-20 00:46:45 Train. Clean: 2.8411 (F: 3.9566, R: 0.2381, CL: 0.7011) | Adv: 2.9153 (F: 4.0181, R: 0.3423, CL: 1.6491)
2026-01-20 00:46:46 Train. Batch 6/11
2026-01-20 00:46:51 Train. Clean: 2.8441 (F: 3.9586, R: 0.2436, CL: 0.6874) | Adv: 2.9167 (F: 4.0190, R: 0.3446, CL: 1.7575)
2026-01-20 00:46:51 Train. Batch 7/11
2026-01-20 00:46:55 Train. Clean: 2.8478 (F: 3.9608, R: 0.2508, CL: 0.8431) | Adv: 2.9181 (F: 4.0200, R: 0.3472, CL: 1.9405)
2026-01-20 00:46:56 Train. Batch 8/11
2026-01-20 00:47:00 Train. Clean: 2.8486 (F: 3.9607, R: 0.2535, CL: 0.8510) | Adv: 2.9325 (F: 4.0321, R: 0.3666, CL: 1.8751)
2026-01-20 00:47:00 Train. Batch 9/11
2026-01-20 00:47:05 Train. Clean: 2.8445 (F: 3.9592, R: 0.2435, CL: 0.7644) | Adv: 2.9146 (F: 4.0171, R: 0.3422, CL: 1.7959)
2026-01-20 00:47:05 Train. Batch 10/11
2026-01-20 00:47:09 Train. Clean: 2.8468 (F: 3.9590, R: 0.2516, CL: 0.7194) | Adv: 2.9230 (F: 4.0243, R: 0.3533, CL: 1.8326)
2026-01-20 00:47:09 Training finishes at this epoch. It takes 0.9054163972536723 min
2026-01-20 00:47:09 Training loss: 2.9485
2026-01-20 00:47:09 Training Epoch 22/30 results:
2026-01-20 00:47:09 Recall@1: 0.9986
2026-01-20 00:47:09 NDCG@1: 0.9986
2026-01-20 00:47:09 Recall@5: 1.0000
2026-01-20 00:47:09 NDCG@5: 0.9995
2026-01-20 00:47:09 Recall@10: 1.0000
2026-01-20 00:47:09 NDCG@10: 0.9995
2026-01-20 00:47:09 Recall@20: 1.0000
2026-01-20 00:47:09 NDCG@20: 0.9995
2026-01-20 00:47:09 

2026-01-20 00:47:09 Testing
2026-01-20 00:47:09 Test. Batch 0/11
2026-01-20 00:47:11 Test. main_loss: 3.2167 (F: 4.2493, R: 0.8074); contrastive_loss: 9.7083; total_loss: 3.7021
2026-01-20 00:47:11 Test. Batch 1/11
2026-01-20 00:47:12 Test. main_loss: 3.2260 (F: 4.2552, R: 0.8246); contrastive_loss: 9.8703; total_loss: 3.7196
2026-01-20 00:47:12 Test. Batch 2/11
2026-01-20 00:47:14 Test. main_loss: 3.2531 (F: 4.2759, R: 0.8665); contrastive_loss: 10.6077; total_loss: 3.7835
2026-01-20 00:47:14 Test. Batch 3/11
2026-01-20 00:47:15 Test. main_loss: 3.2208 (F: 4.2499, R: 0.8194); contrastive_loss: 9.7454; total_loss: 3.7080
2026-01-20 00:47:15 Test. Batch 4/11
2026-01-20 00:47:16 Test. main_loss: 3.2112 (F: 4.2423, R: 0.8053); contrastive_loss: 9.6138; total_loss: 3.6919
2026-01-20 00:47:17 Test. Batch 5/11
2026-01-20 00:47:18 Test. main_loss: 3.2419 (F: 4.2670, R: 0.8500); contrastive_loss: 10.4610; total_loss: 3.7649
2026-01-20 00:47:18 Test. Batch 6/11
2026-01-20 00:47:19 Test. main_loss: 3.2315 (F: 4.2590, R: 0.8338); contrastive_loss: 10.2068; total_loss: 3.7418
2026-01-20 00:47:19 Test. Batch 7/11
2026-01-20 00:47:21 Test. main_loss: 3.2003 (F: 4.2361, R: 0.7837); contrastive_loss: 9.5677; total_loss: 3.6787
2026-01-20 00:47:21 Test. Batch 8/11
2026-01-20 00:47:22 Test. main_loss: 3.2184 (F: 4.2487, R: 0.8143); contrastive_loss: 9.6790; total_loss: 3.7023
2026-01-20 00:47:22 Test. Batch 9/11
2026-01-20 00:47:23 Test. main_loss: 3.2194 (F: 4.2483, R: 0.8186); contrastive_loss: 9.8381; total_loss: 3.7113
2026-01-20 00:47:23 Test. Batch 10/11
2026-01-20 00:47:24 Test. main_loss: 3.2090 (F: 4.2410, R: 0.8008); contrastive_loss: 9.3820; total_loss: 3.6781
2026-01-20 00:47:25 Testing finishes
2026-01-20 00:47:25 Testing loss: 3.716573650186712
2026-01-20 00:47:25 Testing results:
2026-01-20 00:47:25 Recall@1: 0.1937
2026-01-20 00:47:25 NDCG@1: 0.1937
2026-01-20 00:47:25 Recall@5: 0.3250
2026-01-20 00:47:25 NDCG@5: 0.2644
2026-01-20 00:47:25 Recall@10: 0.3699
2026-01-20 00:47:25 NDCG@10: 0.2791
2026-01-20 00:47:25 Recall@20: 0.4071
2026-01-20 00:47:25 NDCG@20: 0.2885
2026-01-20 00:47:25 ==================================


2026-01-20 00:47:25 ================= Epoch 23/30 =================
2026-01-20 00:47:25 Train. Batch 0/11
2026-01-20 00:47:30 Train. Clean: 2.8435 (F: 3.9585, R: 0.2418, CL: 0.6965) | Adv: 2.9158 (F: 4.0206, R: 0.3377, CL: 1.6756)
2026-01-20 00:47:30 Train. Batch 1/11
2026-01-20 00:47:35 Train. Clean: 2.8438 (F: 3.9571, R: 0.2460, CL: 0.8140) | Adv: 2.9135 (F: 4.0135, R: 0.3469, CL: 2.1240)
2026-01-20 00:47:35 Train. Batch 2/11
2026-01-20 00:47:40 Train. Clean: 2.8438 (F: 3.9566, R: 0.2472, CL: 0.7761) | Adv: 2.9104 (F: 4.0127, R: 0.3383, CL: 1.8564)
2026-01-20 00:47:40 Train. Batch 3/11
2026-01-20 00:47:45 Train. Clean: 2.8452 (F: 3.9594, R: 0.2455, CL: 0.8059) | Adv: 2.9285 (F: 4.0290, R: 0.3609, CL: 1.8600)
2026-01-20 00:47:45 Train. Batch 4/11
2026-01-20 00:47:50 Train. Clean: 2.8461 (F: 3.9587, R: 0.2501, CL: 0.8491) | Adv: 2.9198 (F: 4.0206, R: 0.3512, CL: 2.0087)
2026-01-20 00:47:50 Train. Batch 5/11
2026-01-20 00:47:56 Train. Clean: 2.8449 (F: 3.9577, R: 0.2482, CL: 0.8247) | Adv: 2.9140 (F: 4.0143, R: 0.3467, CL: 1.9137)
2026-01-20 00:47:56 Train. Batch 6/11
2026-01-20 00:48:01 Train. Clean: 2.8466 (F: 3.9605, R: 0.2474, CL: 0.7435) | Adv: 2.9303 (F: 4.0321, R: 0.3595, CL: 1.6580)
2026-01-20 00:48:01 Train. Batch 7/11
2026-01-20 00:48:06 Train. Clean: 2.8430 (F: 3.9562, R: 0.2456, CL: 0.8133) | Adv: 2.9139 (F: 4.0138, R: 0.3477, CL: 2.1962)
2026-01-20 00:48:06 Train. Batch 8/11
2026-01-20 00:48:11 Train. Clean: 2.8422 (F: 3.9577, R: 0.2393, CL: 0.6862) | Adv: 2.9176 (F: 4.0198, R: 0.3457, CL: 1.6198)
2026-01-20 00:48:11 Train. Batch 9/11
2026-01-20 00:48:15 Train. Clean: 2.8461 (F: 3.9594, R: 0.2483, CL: 0.8689) | Adv: 2.9162 (F: 4.0187, R: 0.3438, CL: 1.9126)
2026-01-20 00:48:15 Train. Batch 10/11
2026-01-20 00:48:19 Train. Clean: 2.8443 (F: 3.9607, R: 0.2394, CL: 0.6877) | Adv: 2.9295 (F: 4.0316, R: 0.3582, CL: 1.7156)
2026-01-20 00:48:19 Training finishes at this epoch. It takes 0.9155224402745564 min
2026-01-20 00:48:19 Training loss: 2.9479
2026-01-20 00:48:19 Training Epoch 23/30 results:
2026-01-20 00:48:19 Recall@1: 0.9986
2026-01-20 00:48:19 NDCG@1: 0.9986
2026-01-20 00:48:19 Recall@5: 1.0000
2026-01-20 00:48:19 NDCG@5: 0.9995
2026-01-20 00:48:19 Recall@10: 1.0000
2026-01-20 00:48:19 NDCG@10: 0.9995
2026-01-20 00:48:19 Recall@20: 1.0000
2026-01-20 00:48:19 NDCG@20: 0.9995
2026-01-20 00:48:19 

2026-01-20 00:48:19 Testing
2026-01-20 00:48:20 Test. Batch 0/11
2026-01-20 00:48:21 Test. main_loss: 3.2032 (F: 4.2390, R: 0.7862); contrastive_loss: 9.6634; total_loss: 3.6863
2026-01-20 00:48:21 Test. Batch 1/11
2026-01-20 00:48:22 Test. main_loss: 3.2203 (F: 4.2501, R: 0.8177); contrastive_loss: 9.8446; total_loss: 3.7126
2026-01-20 00:48:22 Test. Batch 2/11
2026-01-20 00:48:23 Test. main_loss: 3.2152 (F: 4.2454, R: 0.8115); contrastive_loss: 9.5376; total_loss: 3.6921
2026-01-20 00:48:24 Test. Batch 3/11
2026-01-20 00:48:25 Test. main_loss: 3.2131 (F: 4.2456, R: 0.8040); contrastive_loss: 9.5865; total_loss: 3.6924
2026-01-20 00:48:25 Test. Batch 4/11
2026-01-20 00:48:26 Test. main_loss: 3.2376 (F: 4.2632, R: 0.8443); contrastive_loss: 10.2775; total_loss: 3.7514
2026-01-20 00:48:26 Test. Batch 5/11
2026-01-20 00:48:28 Test. main_loss: 3.2338 (F: 4.2612, R: 0.8365); contrastive_loss: 10.1408; total_loss: 3.7408
2026-01-20 00:48:28 Test. Batch 6/11
2026-01-20 00:48:29 Test. main_loss: 3.2110 (F: 4.2441, R: 0.8004); contrastive_loss: 9.8564; total_loss: 3.7038
2026-01-20 00:48:29 Test. Batch 7/11
2026-01-20 00:48:30 Test. main_loss: 3.2236 (F: 4.2532, R: 0.8212); contrastive_loss: 9.9152; total_loss: 3.7194
2026-01-20 00:48:31 Test. Batch 8/11
2026-01-20 00:48:32 Test. main_loss: 3.2129 (F: 4.2464, R: 0.8014); contrastive_loss: 9.4980; total_loss: 3.6878
2026-01-20 00:48:32 Test. Batch 9/11
2026-01-20 00:48:33 Test. main_loss: 3.2288 (F: 4.2555, R: 0.8332); contrastive_loss: 10.2049; total_loss: 3.7390
2026-01-20 00:48:33 Test. Batch 10/11
2026-01-20 00:48:34 Test. main_loss: 3.2457 (F: 4.2698, R: 0.8561); contrastive_loss: 10.2350; total_loss: 3.7574
2026-01-20 00:48:34 Testing finishes
2026-01-20 00:48:34 Testing loss: 3.716647885062478
2026-01-20 00:48:34 Testing results:
2026-01-20 00:48:34 Recall@1: 0.1881
2026-01-20 00:48:34 NDCG@1: 0.1881
2026-01-20 00:48:34 Recall@5: 0.3282
2026-01-20 00:48:34 NDCG@5: 0.2633
2026-01-20 00:48:34 Recall@10: 0.3715
2026-01-20 00:48:34 NDCG@10: 0.2774
2026-01-20 00:48:34 Recall@20: 0.4029
2026-01-20 00:48:34 NDCG@20: 0.2853
2026-01-20 00:48:34 ==================================


2026-01-20 00:48:34 ================= Epoch 24/30 =================
2026-01-20 00:48:34 Train. Batch 0/11
2026-01-20 00:48:40 Train. Clean: 2.8434 (F: 3.9586, R: 0.2414, CL: 0.8082) | Adv: 2.9188 (F: 4.0223, R: 0.3438, CL: 1.7941)
2026-01-20 00:48:40 Train. Batch 1/11
2026-01-20 00:48:44 Train. Clean: 2.8463 (F: 3.9583, R: 0.2516, CL: 0.7888) | Adv: 2.9156 (F: 4.0165, R: 0.3469, CL: 1.8775)
2026-01-20 00:48:45 Train. Batch 2/11
2026-01-20 00:48:49 Train. Clean: 2.8420 (F: 3.9571, R: 0.2402, CL: 0.7311) | Adv: 2.9137 (F: 4.0166, R: 0.3402, CL: 1.6893)
2026-01-20 00:48:49 Train. Batch 3/11
2026-01-20 00:48:54 Train. Clean: 2.8429 (F: 3.9566, R: 0.2442, CL: 0.7105) | Adv: 2.9102 (F: 4.0102, R: 0.3437, CL: 1.8891)
2026-01-20 00:48:54 Train. Batch 4/11
2026-01-20 00:48:59 Train. Clean: 2.8434 (F: 3.9584, R: 0.2416, CL: 0.7372) | Adv: 2.9152 (F: 4.0184, R: 0.3412, CL: 1.7417)
2026-01-20 00:48:59 Train. Batch 5/11
2026-01-20 00:49:04 Train. Clean: 2.8446 (F: 3.9592, R: 0.2438, CL: 0.8006) | Adv: 2.9224 (F: 4.0234, R: 0.3536, CL: 1.7915)
2026-01-20 00:49:04 Train. Batch 6/11
2026-01-20 00:49:09 Train. Clean: 2.8436 (F: 3.9573, R: 0.2451, CL: 0.7011) | Adv: 2.9129 (F: 4.0159, R: 0.3392, CL: 1.6792)
2026-01-20 00:49:09 Train. Batch 7/11
2026-01-20 00:49:14 Train. Clean: 2.8461 (F: 3.9596, R: 0.2481, CL: 0.7916) | Adv: 2.9292 (F: 4.0320, R: 0.3561, CL: 1.7746)
2026-01-20 00:49:14 Train. Batch 8/11
2026-01-20 00:49:19 Train. Clean: 2.8429 (F: 3.9571, R: 0.2432, CL: 0.7585) | Adv: 2.9134 (F: 4.0157, R: 0.3414, CL: 1.7484)
2026-01-20 00:49:19 Train. Batch 9/11
2026-01-20 00:49:24 Train. Clean: 2.8422 (F: 3.9557, R: 0.2441, CL: 0.8388) | Adv: 2.9137 (F: 4.0147, R: 0.3449, CL: 2.1181)
2026-01-20 00:49:24 Train. Batch 10/11
2026-01-20 00:49:29 Train. Clean: 2.8448 (F: 3.9583, R: 0.2467, CL: 0.7963) | Adv: 2.9247 (F: 4.0249, R: 0.3576, CL: 2.0533)
2026-01-20 00:49:29 Training finishes at this epoch. It takes 0.9092389941215515 min
2026-01-20 00:49:29 Training loss: 2.9456
2026-01-20 00:49:29 Training Epoch 24/30 results:
2026-01-20 00:49:29 Recall@1: 0.9986
2026-01-20 00:49:29 NDCG@1: 0.9986
2026-01-20 00:49:29 Recall@5: 1.0000
2026-01-20 00:49:29 NDCG@5: 0.9995
2026-01-20 00:49:29 Recall@10: 1.0000
2026-01-20 00:49:29 NDCG@10: 0.9995
2026-01-20 00:49:29 Recall@20: 1.0000
2026-01-20 00:49:29 NDCG@20: 0.9995
2026-01-20 00:49:29 

2026-01-20 00:49:29 Testing
2026-01-20 00:49:29 Test. Batch 0/11
2026-01-20 00:49:30 Test. main_loss: 3.2274 (F: 4.2542, R: 0.8314); contrastive_loss: 10.3070; total_loss: 3.7427
2026-01-20 00:49:30 Test. Batch 1/11
2026-01-20 00:49:32 Test. main_loss: 3.2196 (F: 4.2509, R: 0.8131); contrastive_loss: 10.0344; total_loss: 3.7213
2026-01-20 00:49:32 Test. Batch 2/11
2026-01-20 00:49:33 Test. main_loss: 3.2429 (F: 4.2675, R: 0.8521); contrastive_loss: 10.2515; total_loss: 3.7555
2026-01-20 00:49:33 Test. Batch 3/11
2026-01-20 00:49:34 Test. main_loss: 3.2225 (F: 4.2526, R: 0.8187); contrastive_loss: 10.0002; total_loss: 3.7225
2026-01-20 00:49:35 Test. Batch 4/11
2026-01-20 00:49:36 Test. main_loss: 3.2139 (F: 4.2456, R: 0.8064); contrastive_loss: 9.6664; total_loss: 3.6972
2026-01-20 00:49:36 Test. Batch 5/11
2026-01-20 00:49:37 Test. main_loss: 3.1996 (F: 4.2327, R: 0.7892); contrastive_loss: 9.3924; total_loss: 3.6693
2026-01-20 00:49:37 Test. Batch 6/11
2026-01-20 00:49:39 Test. main_loss: 3.2302 (F: 4.2590, R: 0.8296); contrastive_loss: 10.2031; total_loss: 3.7404
2026-01-20 00:49:39 Test. Batch 7/11
2026-01-20 00:49:40 Test. main_loss: 3.2429 (F: 4.2673, R: 0.8526); contrastive_loss: 10.4058; total_loss: 3.7632
2026-01-20 00:49:40 Test. Batch 8/11
2026-01-20 00:49:41 Test. main_loss: 3.2127 (F: 4.2448, R: 0.8045); contrastive_loss: 9.5317; total_loss: 3.6893
2026-01-20 00:49:41 Test. Batch 9/11
2026-01-20 00:49:43 Test. main_loss: 3.2116 (F: 4.2452, R: 0.7999); contrastive_loss: 9.3714; total_loss: 3.6802
2026-01-20 00:49:43 Test. Batch 10/11
2026-01-20 00:49:44 Test. main_loss: 3.2129 (F: 4.2453, R: 0.8040); contrastive_loss: 9.5653; total_loss: 3.6912
2026-01-20 00:49:44 Testing finishes
2026-01-20 00:49:44 Testing loss: 3.715691393071955
2026-01-20 00:49:44 Testing results:
2026-01-20 00:49:44 Recall@1: 0.1892
2026-01-20 00:49:44 NDCG@1: 0.1892
2026-01-20 00:49:44 Recall@5: 0.3292
2026-01-20 00:49:44 NDCG@5: 0.2644
2026-01-20 00:49:44 Recall@10: 0.3675
2026-01-20 00:49:44 NDCG@10: 0.2768
2026-01-20 00:49:44 Recall@20: 0.4068
2026-01-20 00:49:44 NDCG@20: 0.2868
2026-01-20 00:49:44 ==================================


2026-01-20 00:49:44 ================= Epoch 25/30 =================
2026-01-20 00:49:44 Train. Batch 0/11
2026-01-20 00:49:49 Train. Clean: 2.8407 (F: 3.9549, R: 0.2409, CL: 0.7675) | Adv: 2.9125 (F: 4.0122, R: 0.3464, CL: 1.9139)
2026-01-20 00:49:49 Train. Batch 1/11
2026-01-20 00:49:54 Train. Clean: 2.8432 (F: 3.9563, R: 0.2460, CL: 0.7964) | Adv: 2.9107 (F: 4.0134, R: 0.3376, CL: 1.9117)
2026-01-20 00:49:54 Train. Batch 2/11
2026-01-20 00:49:59 Train. Clean: 2.8442 (F: 3.9579, R: 0.2456, CL: 0.7271) | Adv: 2.9145 (F: 4.0180, R: 0.3399, CL: 1.6903)
2026-01-20 00:49:59 Train. Batch 3/11
2026-01-20 00:50:04 Train. Clean: 2.8428 (F: 3.9563, R: 0.2445, CL: 0.7840) | Adv: 2.9142 (F: 4.0154, R: 0.3447, CL: 1.8348)
2026-01-20 00:50:04 Train. Batch 4/11
2026-01-20 00:50:09 Train. Clean: 2.8431 (F: 3.9570, R: 0.2439, CL: 0.8059) | Adv: 2.9120 (F: 4.0147, R: 0.3392, CL: 1.8092)
2026-01-20 00:50:09 Train. Batch 5/11
2026-01-20 00:50:14 Train. Clean: 2.8418 (F: 3.9563, R: 0.2411, CL: 0.7813) | Adv: 2.9089 (F: 4.0113, R: 0.3366, CL: 1.8582)
2026-01-20 00:50:15 Train. Batch 6/11
2026-01-20 00:50:19 Train. Clean: 2.8461 (F: 3.9599, R: 0.2473, CL: 0.7422) | Adv: 2.9148 (F: 4.0172, R: 0.3425, CL: 1.7617)
2026-01-20 00:50:19 Train. Batch 7/11
2026-01-20 00:50:24 Train. Clean: 2.8438 (F: 3.9584, R: 0.2431, CL: 0.7011) | Adv: 2.9171 (F: 4.0191, R: 0.3457, CL: 1.5932)
2026-01-20 00:50:24 Train. Batch 8/11
2026-01-20 00:50:29 Train. Clean: 2.8460 (F: 3.9603, R: 0.2458, CL: 0.8079) | Adv: 2.9235 (F: 4.0246, R: 0.3545, CL: 1.8339)
2026-01-20 00:50:29 Train. Batch 9/11
2026-01-20 00:50:34 Train. Clean: 2.8444 (F: 3.9576, R: 0.2468, CL: 0.9265) | Adv: 2.9158 (F: 4.0154, R: 0.3500, CL: 2.3113)
2026-01-20 00:50:34 Train. Batch 10/11
2026-01-20 00:50:38 Train. Clean: 2.8407 (F: 3.9551, R: 0.2405, CL: 0.6834) | Adv: 2.9192 (F: 4.0203, R: 0.3499, CL: 1.7030)
2026-01-20 00:50:38 Training finishes at this epoch. It takes 0.9014182051022848 min
2026-01-20 00:50:38 Training loss: 2.9444
2026-01-20 00:50:38 Training Epoch 25/30 results:
2026-01-20 00:50:38 Recall@1: 0.9986
2026-01-20 00:50:38 NDCG@1: 0.9986
2026-01-20 00:50:38 Recall@5: 1.0000
2026-01-20 00:50:38 NDCG@5: 0.9995
2026-01-20 00:50:38 Recall@10: 1.0000
2026-01-20 00:50:38 NDCG@10: 0.9995
2026-01-20 00:50:38 Recall@20: 1.0000
2026-01-20 00:50:38 NDCG@20: 0.9995
2026-01-20 00:50:38 

2026-01-20 00:50:38 Testing
2026-01-20 00:50:38 Test. Batch 0/11
2026-01-20 00:50:39 Test. main_loss: 3.2275 (F: 4.2546, R: 0.8309); contrastive_loss: 9.7929; total_loss: 3.7171
2026-01-20 00:50:39 Test. Batch 1/11
2026-01-20 00:50:41 Test. main_loss: 3.1955 (F: 4.2322, R: 0.7764); contrastive_loss: 9.3129; total_loss: 3.6611
2026-01-20 00:50:41 Test. Batch 2/11
2026-01-20 00:50:42 Test. main_loss: 3.2353 (F: 4.2623, R: 0.8389); contrastive_loss: 10.2244; total_loss: 3.7465
2026-01-20 00:50:42 Test. Batch 3/11
2026-01-20 00:50:43 Test. main_loss: 3.2033 (F: 4.2370, R: 0.7915); contrastive_loss: 9.4558; total_loss: 3.6761
2026-01-20 00:50:44 Test. Batch 4/11
2026-01-20 00:50:45 Test. main_loss: 3.2206 (F: 4.2506, R: 0.8172); contrastive_loss: 9.8442; total_loss: 3.7128
2026-01-20 00:50:45 Test. Batch 5/11
2026-01-20 00:50:46 Test. main_loss: 3.2225 (F: 4.2517, R: 0.8209); contrastive_loss: 9.9835; total_loss: 3.7216
2026-01-20 00:50:46 Test. Batch 6/11
2026-01-20 00:50:48 Test. main_loss: 3.2265 (F: 4.2544, R: 0.8281); contrastive_loss: 10.0390; total_loss: 3.7285
2026-01-20 00:50:48 Test. Batch 7/11
2026-01-20 00:50:49 Test. main_loss: 3.2050 (F: 4.2385, R: 0.7936); contrastive_loss: 9.3302; total_loss: 3.6715
2026-01-20 00:50:49 Test. Batch 8/11
2026-01-20 00:50:50 Test. main_loss: 3.2268 (F: 4.2548, R: 0.8281); contrastive_loss: 9.9816; total_loss: 3.7259
2026-01-20 00:50:50 Test. Batch 9/11
2026-01-20 00:50:52 Test. main_loss: 3.2394 (F: 4.2645, R: 0.8476); contrastive_loss: 10.3145; total_loss: 3.7551
2026-01-20 00:50:52 Test. Batch 10/11
2026-01-20 00:50:53 Test. main_loss: 3.2433 (F: 4.2675, R: 0.8536); contrastive_loss: 10.3565; total_loss: 3.7611
2026-01-20 00:50:53 Testing finishes
2026-01-20 00:50:53 Testing loss: 3.7161307334899902
2026-01-20 00:50:53 Testing results:
2026-01-20 00:50:53 Recall@1: 0.1902
2026-01-20 00:50:53 NDCG@1: 0.1902
2026-01-20 00:50:53 Recall@5: 0.3296
2026-01-20 00:50:53 NDCG@5: 0.2652
2026-01-20 00:50:53 Recall@10: 0.3719
2026-01-20 00:50:53 NDCG@10: 0.2790
2026-01-20 00:50:53 Recall@20: 0.4067
2026-01-20 00:50:53 NDCG@20: 0.2878
2026-01-20 00:50:53 ==================================


2026-01-20 00:50:53 ================= Epoch 26/30 =================
2026-01-20 00:50:53 Train. Batch 0/11
2026-01-20 00:50:58 Train. Clean: 2.8426 (F: 3.9571, R: 0.2422, CL: 0.7120) | Adv: 2.9185 (F: 4.0186, R: 0.3516, CL: 1.7458)
2026-01-20 00:50:58 Train. Batch 1/11
2026-01-20 00:51:03 Train. Clean: 2.8446 (F: 3.9584, R: 0.2457, CL: 0.7834) | Adv: 2.9223 (F: 4.0231, R: 0.3538, CL: 1.7883)
2026-01-20 00:51:03 Train. Batch 2/11
2026-01-20 00:51:08 Train. Clean: 2.8403 (F: 3.9546, R: 0.2405, CL: 0.7140) | Adv: 2.9137 (F: 4.0155, R: 0.3430, CL: 1.7445)
2026-01-20 00:51:08 Train. Batch 3/11
2026-01-20 00:51:12 Train. Clean: 2.8422 (F: 3.9567, R: 0.2420, CL: 0.8185) | Adv: 2.9134 (F: 4.0145, R: 0.3442, CL: 1.9728)
2026-01-20 00:51:12 Train. Batch 4/11
2026-01-20 00:51:17 Train. Clean: 2.8396 (F: 3.9560, R: 0.2347, CL: 0.6938) | Adv: 2.9107 (F: 4.0137, R: 0.3370, CL: 1.6840)
2026-01-20 00:51:18 Train. Batch 5/11
2026-01-20 00:51:22 Train. Clean: 2.8417 (F: 3.9551, R: 0.2438, CL: 0.8767) | Adv: 2.9093 (F: 4.0107, R: 0.3394, CL: 2.1669)
2026-01-20 00:51:22 Train. Batch 6/11
2026-01-20 00:51:28 Train. Clean: 2.8439 (F: 3.9580, R: 0.2445, CL: 0.7290) | Adv: 2.9209 (F: 4.0229, R: 0.3496, CL: 1.6517)
2026-01-20 00:51:28 Train. Batch 7/11
2026-01-20 00:51:33 Train. Clean: 2.8418 (F: 3.9582, R: 0.2369, CL: 0.7850) | Adv: 2.9184 (F: 4.0197, R: 0.3485, CL: 1.7425)
2026-01-20 00:51:33 Train. Batch 8/11
2026-01-20 00:51:38 Train. Clean: 2.8455 (F: 3.9580, R: 0.2496, CL: 0.8228) | Adv: 2.9160 (F: 4.0179, R: 0.3448, CL: 1.8488)
2026-01-20 00:51:38 Train. Batch 9/11
2026-01-20 00:51:43 Train. Clean: 2.8422 (F: 3.9557, R: 0.2441, CL: 0.7513) | Adv: 2.9119 (F: 4.0130, R: 0.3426, CL: 1.9224)
2026-01-20 00:51:43 Train. Batch 10/11
2026-01-20 00:51:47 Train. Clean: 2.8443 (F: 3.9586, R: 0.2441, CL: 0.7319) | Adv: 2.9269 (F: 4.0279, R: 0.3579, CL: 1.9241)
2026-01-20 00:51:47 Training finishes at this epoch. It takes 0.9029757738113403 min
2026-01-20 00:51:47 Training loss: 2.9446
2026-01-20 00:51:47 Training Epoch 26/30 results:
2026-01-20 00:51:47 Recall@1: 0.9995
2026-01-20 00:51:47 NDCG@1: 0.9995
2026-01-20 00:51:47 Recall@5: 1.0000
2026-01-20 00:51:47 NDCG@5: 0.9998
2026-01-20 00:51:47 Recall@10: 1.0000
2026-01-20 00:51:47 NDCG@10: 0.9998
2026-01-20 00:51:47 Recall@20: 1.0000
2026-01-20 00:51:47 NDCG@20: 0.9998
2026-01-20 00:51:47 

2026-01-20 00:51:47 Testing
2026-01-20 00:51:47 Test. Batch 0/11
2026-01-20 00:51:48 Test. main_loss: 3.2344 (F: 4.2612, R: 0.8385); contrastive_loss: 10.2455; total_loss: 3.7467
2026-01-20 00:51:49 Test. Batch 1/11
2026-01-20 00:51:50 Test. main_loss: 3.1935 (F: 4.2267, R: 0.7829); contrastive_loss: 9.3101; total_loss: 3.6590
2026-01-20 00:51:50 Test. Batch 2/11
2026-01-20 00:51:51 Test. main_loss: 3.2137 (F: 4.2449, R: 0.8074); contrastive_loss: 9.6496; total_loss: 3.6961
2026-01-20 00:51:51 Test. Batch 3/11
2026-01-20 00:51:53 Test. main_loss: 3.2175 (F: 4.2484, R: 0.8121); contrastive_loss: 9.6650; total_loss: 3.7007
2026-01-20 00:51:53 Test. Batch 4/11
2026-01-20 00:51:54 Test. main_loss: 3.2372 (F: 4.2643, R: 0.8406); contrastive_loss: 10.0429; total_loss: 3.7393
2026-01-20 00:51:54 Test. Batch 5/11
2026-01-20 00:51:55 Test. main_loss: 3.2261 (F: 4.2530, R: 0.8301); contrastive_loss: 10.1122; total_loss: 3.7317
2026-01-20 00:51:55 Test. Batch 6/11
2026-01-20 00:51:57 Test. main_loss: 3.2166 (F: 4.2481, R: 0.8098); contrastive_loss: 9.8386; total_loss: 3.7085
2026-01-20 00:51:57 Test. Batch 7/11
2026-01-20 00:51:58 Test. main_loss: 3.2248 (F: 4.2532, R: 0.8252); contrastive_loss: 9.8718; total_loss: 3.7184
2026-01-20 00:51:58 Test. Batch 8/11
2026-01-20 00:51:59 Test. main_loss: 3.2111 (F: 4.2428, R: 0.8038); contrastive_loss: 9.5126; total_loss: 3.6868
2026-01-20 00:52:00 Test. Batch 9/11
2026-01-20 00:52:01 Test. main_loss: 3.2112 (F: 4.2430, R: 0.8037); contrastive_loss: 9.6776; total_loss: 3.6951
2026-01-20 00:52:01 Test. Batch 10/11
2026-01-20 00:52:02 Test. main_loss: 3.2619 (F: 4.2834, R: 0.8783); contrastive_loss: 10.6493; total_loss: 3.7943
2026-01-20 00:52:02 Testing finishes
2026-01-20 00:52:02 Testing loss: 3.716069286519831
2026-01-20 00:52:02 Testing results:
2026-01-20 00:52:02 Recall@1: 0.1893
2026-01-20 00:52:02 NDCG@1: 0.1893
2026-01-20 00:52:02 Recall@5: 0.3296
2026-01-20 00:52:02 NDCG@5: 0.2646
2026-01-20 00:52:02 Recall@10: 0.3722
2026-01-20 00:52:02 NDCG@10: 0.2784
2026-01-20 00:52:02 Recall@20: 0.4067
2026-01-20 00:52:02 NDCG@20: 0.2872
2026-01-20 00:52:02 ==================================


2026-01-20 00:52:02 ================= Epoch 27/30 =================
2026-01-20 00:52:02 Train. Batch 0/11
2026-01-20 00:52:07 Train. Clean: 2.8420 (F: 3.9563, R: 0.2418, CL: 0.7719) | Adv: 2.9166 (F: 4.0205, R: 0.3410, CL: 1.6718)
2026-01-20 00:52:07 Train. Batch 1/11
2026-01-20 00:52:12 Train. Clean: 2.8449 (F: 3.9577, R: 0.2482, CL: 0.7624) | Adv: 2.9181 (F: 4.0191, R: 0.3491, CL: 1.7763)
2026-01-20 00:52:12 Train. Batch 2/11
2026-01-20 00:52:17 Train. Clean: 2.8454 (F: 3.9579, R: 0.2494, CL: 0.7558) | Adv: 2.9081 (F: 4.0105, R: 0.3359, CL: 1.8010)
2026-01-20 00:52:17 Train. Batch 3/11
2026-01-20 00:52:21 Train. Clean: 2.8436 (F: 3.9564, R: 0.2470, CL: 0.7691) | Adv: 2.9161 (F: 4.0165, R: 0.3483, CL: 1.8866)
2026-01-20 00:52:21 Train. Batch 4/11
2026-01-20 00:52:26 Train. Clean: 2.8434 (F: 3.9566, R: 0.2459, CL: 0.7965) | Adv: 2.9198 (F: 4.0210, R: 0.3503, CL: 1.9244)
2026-01-20 00:52:26 Train. Batch 5/11
2026-01-20 00:52:31 Train. Clean: 2.8428 (F: 3.9565, R: 0.2441, CL: 0.8077) | Adv: 2.9151 (F: 4.0170, R: 0.3440, CL: 1.8371)
2026-01-20 00:52:31 Train. Batch 6/11
2026-01-20 00:52:36 Train. Clean: 2.8416 (F: 3.9545, R: 0.2447, CL: 0.7855) | Adv: 2.9088 (F: 4.0112, R: 0.3366, CL: 1.8923)
2026-01-20 00:52:36 Train. Batch 7/11
2026-01-20 00:52:41 Train. Clean: 2.8431 (F: 3.9564, R: 0.2455, CL: 0.8724) | Adv: 2.9172 (F: 4.0194, R: 0.3455, CL: 2.0200)
2026-01-20 00:52:41 Train. Batch 8/11
2026-01-20 00:52:46 Train. Clean: 2.8408 (F: 3.9546, R: 0.2418, CL: 0.7116) | Adv: 2.9083 (F: 4.0113, R: 0.3346, CL: 1.8439)
2026-01-20 00:52:46 Train. Batch 9/11
2026-01-20 00:52:52 Train. Clean: 2.8431 (F: 3.9559, R: 0.2468, CL: 0.6952) | Adv: 2.9080 (F: 4.0107, R: 0.3350, CL: 1.6581)
2026-01-20 00:52:52 Train. Batch 10/11
2026-01-20 00:52:56 Train. Clean: 2.8439 (F: 3.9573, R: 0.2460, CL: 0.7608) | Adv: 2.9277 (F: 4.0257, R: 0.3658, CL: 1.9309)
2026-01-20 00:52:56 Training finishes at this epoch. It takes 0.9039302428563436 min
2026-01-20 00:52:56 Training loss: 2.9443
2026-01-20 00:52:56 Training Epoch 27/30 results:
2026-01-20 00:52:56 Recall@1: 0.9995
2026-01-20 00:52:56 NDCG@1: 0.9995
2026-01-20 00:52:56 Recall@5: 1.0000
2026-01-20 00:52:56 NDCG@5: 0.9998
2026-01-20 00:52:56 Recall@10: 1.0000
2026-01-20 00:52:56 NDCG@10: 0.9998
2026-01-20 00:52:56 Recall@20: 1.0000
2026-01-20 00:52:56 NDCG@20: 0.9998
2026-01-20 00:52:56 

2026-01-20 00:52:56 Testing
2026-01-20 00:52:56 Test. Batch 0/11
2026-01-20 00:52:58 Test. main_loss: 3.1967 (F: 4.2306, R: 0.7844); contrastive_loss: 9.1690; total_loss: 3.6552
2026-01-20 00:52:58 Test. Batch 1/11
2026-01-20 00:52:59 Test. main_loss: 3.2030 (F: 4.2369, R: 0.7907); contrastive_loss: 9.5755; total_loss: 3.6818
2026-01-20 00:52:59 Test. Batch 2/11
2026-01-20 00:53:00 Test. main_loss: 3.2117 (F: 4.2446, R: 0.8017); contrastive_loss: 9.3249; total_loss: 3.6780
2026-01-20 00:53:00 Test. Batch 3/11
2026-01-20 00:53:02 Test. main_loss: 3.2641 (F: 4.2838, R: 0.8849); contrastive_loss: 10.5849; total_loss: 3.7933
2026-01-20 00:53:02 Test. Batch 4/11
2026-01-20 00:53:03 Test. main_loss: 3.2137 (F: 4.2438, R: 0.8101); contrastive_loss: 9.6482; total_loss: 3.6961
2026-01-20 00:53:03 Test. Batch 5/11
2026-01-20 00:53:04 Test. main_loss: 3.2360 (F: 4.2622, R: 0.8417); contrastive_loss: 10.2362; total_loss: 3.7478
2026-01-20 00:53:04 Test. Batch 6/11
2026-01-20 00:53:06 Test. main_loss: 3.2335 (F: 4.2609, R: 0.8362); contrastive_loss: 10.2326; total_loss: 3.7451
2026-01-20 00:53:06 Test. Batch 7/11
2026-01-20 00:53:07 Test. main_loss: 3.2140 (F: 4.2454, R: 0.8076); contrastive_loss: 9.8152; total_loss: 3.7048
2026-01-20 00:53:07 Test. Batch 8/11
2026-01-20 00:53:08 Test. main_loss: 3.1973 (F: 4.2322, R: 0.7826); contrastive_loss: 9.5130; total_loss: 3.6729
2026-01-20 00:53:09 Test. Batch 9/11
2026-01-20 00:53:10 Test. main_loss: 3.2238 (F: 4.2535, R: 0.8211); contrastive_loss: 9.7561; total_loss: 3.7116
2026-01-20 00:53:10 Test. Batch 10/11
2026-01-20 00:53:11 Test. main_loss: 3.2526 (F: 4.2755, R: 0.8658); contrastive_loss: 10.6238; total_loss: 3.7838
2026-01-20 00:53:11 Testing finishes
2026-01-20 00:53:11 Testing loss: 3.715492703697898
2026-01-20 00:53:11 Testing results:
2026-01-20 00:53:11 Recall@1: 0.1896
2026-01-20 00:53:11 NDCG@1: 0.1896
2026-01-20 00:53:11 Recall@5: 0.3255
2026-01-20 00:53:11 NDCG@5: 0.2624
2026-01-20 00:53:11 Recall@10: 0.3685
2026-01-20 00:53:11 NDCG@10: 0.2764
2026-01-20 00:53:11 Recall@20: 0.4047
2026-01-20 00:53:11 NDCG@20: 0.2856
2026-01-20 00:53:11 ==================================


2026-01-20 00:53:11 ================= Epoch 28/30 =================
2026-01-20 00:53:11 Train. Batch 0/11
2026-01-20 00:53:16 Train. Clean: 2.8429 (F: 3.9568, R: 0.2438, CL: 0.7923) | Adv: 2.9206 (F: 4.0234, R: 0.3475, CL: 1.7774)
2026-01-20 00:53:16 Train. Batch 1/11
2026-01-20 00:53:21 Train. Clean: 2.8419 (F: 3.9568, R: 0.2406, CL: 0.7115) | Adv: 2.9176 (F: 4.0231, R: 0.3382, CL: 1.5832)
2026-01-20 00:53:21 Train. Batch 2/11
2026-01-20 00:53:26 Train. Clean: 2.8403 (F: 3.9554, R: 0.2384, CL: 0.6881) | Adv: 2.9131 (F: 4.0162, R: 0.3395, CL: 1.6327)
2026-01-20 00:53:26 Train. Batch 3/11
2026-01-20 00:53:31 Train. Clean: 2.8404 (F: 3.9542, R: 0.2415, CL: 0.7111) | Adv: 2.9100 (F: 4.0121, R: 0.3382, CL: 1.6431)
2026-01-20 00:53:31 Train. Batch 4/11
2026-01-20 00:53:36 Train. Clean: 2.8427 (F: 3.9553, R: 0.2468, CL: 0.7988) | Adv: 2.9099 (F: 4.0110, R: 0.3408, CL: 1.9404)
2026-01-20 00:53:36 Train. Batch 5/11
2026-01-20 00:53:41 Train. Clean: 2.8424 (F: 3.9558, R: 0.2446, CL: 0.8146) | Adv: 2.9125 (F: 4.0149, R: 0.3405, CL: 1.8589)
2026-01-20 00:53:41 Train. Batch 6/11
2026-01-20 00:53:46 Train. Clean: 2.8459 (F: 3.9566, R: 0.2542, CL: 0.8113) | Adv: 2.9143 (F: 4.0154, R: 0.3451, CL: 1.9248)
2026-01-20 00:53:46 Train. Batch 7/11
2026-01-20 00:53:51 Train. Clean: 2.8406 (F: 3.9529, R: 0.2450, CL: 0.8573) | Adv: 2.9081 (F: 4.0082, R: 0.3410, CL: 2.1485)
2026-01-20 00:53:51 Train. Batch 8/11
2026-01-20 00:53:56 Train. Clean: 2.8436 (F: 3.9563, R: 0.2472, CL: 0.7813) | Adv: 2.9154 (F: 4.0163, R: 0.3465, CL: 1.9288)
2026-01-20 00:53:56 Train. Batch 9/11
2026-01-20 00:54:02 Train. Clean: 2.8432 (F: 3.9583, R: 0.2413, CL: 0.7398) | Adv: 2.9251 (F: 4.0280, R: 0.3519, CL: 1.6831)
2026-01-20 00:54:02 Train. Batch 10/11
2026-01-20 00:54:05 Train. Clean: 2.8444 (F: 3.9577, R: 0.2468, CL: 0.7021) | Adv: 2.9243 (F: 4.0244, R: 0.3574, CL: 1.8190)
2026-01-20 00:54:05 Training finishes at this epoch. It takes 0.907383918762207 min
2026-01-20 00:54:05 Training loss: 2.9435
2026-01-20 00:54:05 Training Epoch 28/30 results:
2026-01-20 00:54:05 Recall@1: 0.9995
2026-01-20 00:54:05 NDCG@1: 0.9995
2026-01-20 00:54:05 Recall@5: 1.0000
2026-01-20 00:54:05 NDCG@5: 0.9998
2026-01-20 00:54:05 Recall@10: 1.0000
2026-01-20 00:54:05 NDCG@10: 0.9998
2026-01-20 00:54:05 Recall@20: 1.0000
2026-01-20 00:54:05 NDCG@20: 0.9998
2026-01-20 00:54:05 

2026-01-20 00:54:05 Testing
2026-01-20 00:54:06 Test. Batch 0/11
2026-01-20 00:54:07 Test. main_loss: 3.2249 (F: 4.2535, R: 0.8249); contrastive_loss: 9.7806; total_loss: 3.7140
2026-01-20 00:54:07 Test. Batch 1/11
2026-01-20 00:54:08 Test. main_loss: 3.2239 (F: 4.2530, R: 0.8229); contrastive_loss: 10.0738; total_loss: 3.7276
2026-01-20 00:54:08 Test. Batch 2/11
2026-01-20 00:54:09 Test. main_loss: 3.2198 (F: 4.2498, R: 0.8164); contrastive_loss: 9.8973; total_loss: 3.7147
2026-01-20 00:54:10 Test. Batch 3/11
2026-01-20 00:54:11 Test. main_loss: 3.2279 (F: 4.2552, R: 0.8306); contrastive_loss: 10.0602; total_loss: 3.7309
2026-01-20 00:54:11 Test. Batch 4/11
2026-01-20 00:54:12 Test. main_loss: 3.2265 (F: 4.2547, R: 0.8274); contrastive_loss: 9.9220; total_loss: 3.7226
2026-01-20 00:54:12 Test. Batch 5/11
2026-01-20 00:54:14 Test. main_loss: 3.1823 (F: 4.2205, R: 0.7598); contrastive_loss: 8.7283; total_loss: 3.6187
2026-01-20 00:54:14 Test. Batch 6/11
2026-01-20 00:54:15 Test. main_loss: 3.2196 (F: 4.2492, R: 0.8174); contrastive_loss: 9.8395; total_loss: 3.7116
2026-01-20 00:54:15 Test. Batch 7/11
2026-01-20 00:54:16 Test. main_loss: 3.2436 (F: 4.2682, R: 0.8531); contrastive_loss: 10.3786; total_loss: 3.7626
2026-01-20 00:54:16 Test. Batch 8/11
2026-01-20 00:54:18 Test. main_loss: 3.2046 (F: 4.2383, R: 0.7927); contrastive_loss: 9.4491; total_loss: 3.6771
2026-01-20 00:54:18 Test. Batch 9/11
2026-01-20 00:54:19 Test. main_loss: 3.2312 (F: 4.2581, R: 0.8352); contrastive_loss: 10.1729; total_loss: 3.7399
2026-01-20 00:54:19 Test. Batch 10/11
2026-01-20 00:54:20 Test. main_loss: 3.2406 (F: 4.2650, R: 0.8504); contrastive_loss: 10.1304; total_loss: 3.7471
2026-01-20 00:54:20 Testing finishes
2026-01-20 00:54:20 Testing loss: 3.71515755219893
2026-01-20 00:54:20 Testing results:
2026-01-20 00:54:20 Recall@1: 0.1912
2026-01-20 00:54:20 NDCG@1: 0.1912
2026-01-20 00:54:20 Recall@5: 0.3285
2026-01-20 00:54:20 NDCG@5: 0.2643
2026-01-20 00:54:20 Recall@10: 0.3751
2026-01-20 00:54:20 NDCG@10: 0.2792
2026-01-20 00:54:20 Recall@20: 0.4061
2026-01-20 00:54:20 NDCG@20: 0.2870
2026-01-20 00:54:20 ==================================


2026-01-20 00:54:20 ================= Epoch 29/30 =================
2026-01-20 00:54:20 Train. Batch 0/11
2026-01-20 00:54:25 Train. Clean: 2.8450 (F: 3.9590, R: 0.2455, CL: 0.8358) | Adv: 2.9248 (F: 4.0283, R: 0.3498, CL: 1.7359)
2026-01-20 00:54:25 Train. Batch 1/11
2026-01-20 00:54:30 Train. Clean: 2.8401 (F: 3.9521, R: 0.2455, CL: 0.8762) | Adv: 2.9078 (F: 4.0066, R: 0.3438, CL: 2.3687)
2026-01-20 00:54:30 Train. Batch 2/11
2026-01-20 00:54:36 Train. Clean: 2.8416 (F: 3.9536, R: 0.2469, CL: 0.7051) | Adv: 2.9102 (F: 4.0127, R: 0.3375, CL: 1.6549)
2026-01-20 00:54:36 Train. Batch 3/11
2026-01-20 00:54:40 Train. Clean: 2.8418 (F: 3.9561, R: 0.2419, CL: 0.7280) | Adv: 2.9138 (F: 4.0157, R: 0.3428, CL: 1.8781)
2026-01-20 00:54:41 Train. Batch 4/11
2026-01-20 00:54:45 Train. Clean: 2.8413 (F: 3.9558, R: 0.2407, CL: 0.7034) | Adv: 2.9156 (F: 4.0198, R: 0.3392, CL: 1.5583)
2026-01-20 00:54:46 Train. Batch 5/11
2026-01-20 00:54:50 Train. Clean: 2.8415 (F: 3.9551, R: 0.2432, CL: 0.6921) | Adv: 2.9106 (F: 4.0119, R: 0.3410, CL: 1.7852)
2026-01-20 00:54:50 Train. Batch 6/11
2026-01-20 00:54:55 Train. Clean: 2.8394 (F: 3.9533, R: 0.2402, CL: 0.7441) | Adv: 2.9080 (F: 4.0090, R: 0.3391, CL: 1.8345)
2026-01-20 00:54:55 Train. Batch 7/11
2026-01-20 00:55:00 Train. Clean: 2.8424 (F: 3.9566, R: 0.2424, CL: 0.7703) | Adv: 2.9209 (F: 4.0198, R: 0.3567, CL: 1.8997)
2026-01-20 00:55:00 Train. Batch 8/11
2026-01-20 00:55:05 Train. Clean: 2.8429 (F: 3.9567, R: 0.2440, CL: 0.8166) | Adv: 2.9177 (F: 4.0182, R: 0.3497, CL: 1.8946)
2026-01-20 00:55:05 Train. Batch 9/11
2026-01-20 00:55:10 Train. Clean: 2.8418 (F: 3.9561, R: 0.2417, CL: 0.7447) | Adv: 2.9130 (F: 4.0148, R: 0.3421, CL: 1.7686)
2026-01-20 00:55:10 Train. Batch 10/11
2026-01-20 00:55:15 Train. Clean: 2.8434 (F: 3.9558, R: 0.2477, CL: 0.7691) | Adv: 2.9217 (F: 4.0203, R: 0.3581, CL: 1.9442)
2026-01-20 00:55:15 Training finishes at this epoch. It takes 0.9045044501622518 min
2026-01-20 00:55:15 Training loss: 2.9437
2026-01-20 00:55:15 Training Epoch 29/30 results:
2026-01-20 00:55:15 Recall@1: 0.9990
2026-01-20 00:55:15 NDCG@1: 0.9990
2026-01-20 00:55:15 Recall@5: 1.0000
2026-01-20 00:55:15 NDCG@5: 0.9996
2026-01-20 00:55:15 Recall@10: 1.0000
2026-01-20 00:55:15 NDCG@10: 0.9996
2026-01-20 00:55:15 Recall@20: 1.0000
2026-01-20 00:55:15 NDCG@20: 0.9996
2026-01-20 00:55:15 

2026-01-20 00:55:15 Testing
2026-01-20 00:55:15 Test. Batch 0/11
2026-01-20 00:55:16 Test. main_loss: 3.2003 (F: 4.2334, R: 0.7895); contrastive_loss: 9.3883; total_loss: 3.6697
2026-01-20 00:55:16 Test. Batch 1/11
2026-01-20 00:55:17 Test. main_loss: 3.2209 (F: 4.2507, R: 0.8181); contrastive_loss: 10.0410; total_loss: 3.7230
2026-01-20 00:55:17 Test. Batch 2/11
2026-01-20 00:55:19 Test. main_loss: 3.2051 (F: 4.2388, R: 0.7930); contrastive_loss: 9.6717; total_loss: 3.6887
2026-01-20 00:55:19 Test. Batch 3/11
2026-01-20 00:55:20 Test. main_loss: 3.2144 (F: 4.2457, R: 0.8079); contrastive_loss: 9.4709; total_loss: 3.6879
2026-01-20 00:55:20 Test. Batch 4/11
2026-01-20 00:55:21 Test. main_loss: 3.2315 (F: 4.2583, R: 0.8359); contrastive_loss: 10.1396; total_loss: 3.7385
2026-01-20 00:55:21 Test. Batch 5/11
2026-01-20 00:55:23 Test. main_loss: 3.2116 (F: 4.2438, R: 0.8031); contrastive_loss: 9.6287; total_loss: 3.6930
2026-01-20 00:55:23 Test. Batch 6/11
2026-01-20 00:55:24 Test. main_loss: 3.2063 (F: 4.2378, R: 0.7995); contrastive_loss: 9.2838; total_loss: 3.6705
2026-01-20 00:55:24 Test. Batch 7/11
2026-01-20 00:55:25 Test. main_loss: 3.2159 (F: 4.2481, R: 0.8075); contrastive_loss: 9.5777; total_loss: 3.6948
2026-01-20 00:55:26 Test. Batch 8/11
2026-01-20 00:55:27 Test. main_loss: 3.2479 (F: 4.2716, R: 0.8592); contrastive_loss: 10.5515; total_loss: 3.7755
2026-01-20 00:55:27 Test. Batch 9/11
2026-01-20 00:55:28 Test. main_loss: 3.2489 (F: 4.2710, R: 0.8641); contrastive_loss: 10.5134; total_loss: 3.7746
2026-01-20 00:55:28 Test. Batch 10/11
2026-01-20 00:55:29 Test. main_loss: 3.2491 (F: 4.2723, R: 0.8615); contrastive_loss: 10.3693; total_loss: 3.7676
2026-01-20 00:55:29 Testing finishes
2026-01-20 00:55:29 Testing loss: 3.7166972160339355
2026-01-20 00:55:29 Testing results:
2026-01-20 00:55:29 Recall@1: 0.1893
2026-01-20 00:55:29 NDCG@1: 0.1893
2026-01-20 00:55:29 Recall@5: 0.3265
2026-01-20 00:55:29 NDCG@5: 0.2631
2026-01-20 00:55:29 Recall@10: 0.3702
2026-01-20 00:55:29 NDCG@10: 0.2773
2026-01-20 00:55:29 Recall@20: 0.4040
2026-01-20 00:55:29 NDCG@20: 0.2857
2026-01-20 00:55:29 ==================================


2026-01-20 00:55:29 6. Final Results
2026-01-20 00:55:29 {'Rec1': '0.2037', 'Rec5': '0.3661', 'Rec10': '0.4096', 'Rec20': '0.4470', 'NDCG1': '0.2037', 'NDCG5': '0.2871', 'NDCG10': '0.3014', 'NDCG20': '0.3103'}
2026-01-20 00:55:29 

